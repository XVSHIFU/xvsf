<script>
document.addEventListener('DOMContentLoaded', function() {
    // 1. 处理折叠功能
    document.querySelectorAll('.code-header').forEach(header => {
        header.addEventListener('click', (e) => {
            // 如果点击的是复制按钮，不触发折叠
            if (e.target.closest('.copy-btn')) return;

            const container = header.parentElement;
            const isExpanded = container.getAttribute('data-expanded') === 'true';
            container.setAttribute('data-expanded', !isExpanded);
        });
    });

    // 2. 处理复制功能
    document.querySelectorAll('.copy-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const container = btn.closest('.code-block-container');
            const code = container.querySelector('code').innerText;
            
            navigator.clipboard.writeText(code).then(() => {
                // 复制成功的视觉反馈
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#50fa7b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy!', err);
            });
        });
    });
});
</script>